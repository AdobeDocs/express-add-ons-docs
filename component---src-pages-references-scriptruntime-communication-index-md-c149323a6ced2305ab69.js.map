{"version":3,"file":"component---src-pages-references-scriptruntime-communication-index-md-c149323a6ced2305ab69.js","mappings":"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","sources":["webpack://dev-site-documentation-template/./src/pages/references/scriptruntime/communication/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/express-add-ons-docs/express-add-ons-docs/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"communication-apis\"\n    }}>{`Communication APIs`}</h1>\n    <p>{`The communication APIs allow you to communicate between the script runtime and the iframe where your add-on is running. `}</p>\n    <InlineAlert slots=\"text\" variant=\"warning\" mdxType=\"InlineAlert\" />\n    <p>{`The script runtime is not currently available to developers. The documentation on this page for informational purposes only.`}</p>\n    <h2 {...{\n      \"id\": \"overview\"\n    }}>{`Overview`}</h2>\n    <p>{`The script runtime and iframe runtime are two different runtime execution environments which are present on different threads in the browser. The communication APIs are based on the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/GoogleChromeLabs/comlink\"\n      }}>{`Comlink library`}</a>{` and provide a mechanism to allow the JavaScript code executing in each to interact. Developers can call the apis exposed in one environment (ie: script runtime) from another environment (ie: iframe where their add-on is running) bidirectionally. `}</p>\n    <h2 {...{\n      \"id\": \"accessing-the-apis\"\n    }}>{`Accessing the APIs`}</h2>\n    <p>{`An exported module named `}<inlineCode parentName=\"p\">{`AddOnSdkApi`}</inlineCode>{` is provided to enable the communication between the iframe and the script runtime via its' `}<inlineCode parentName=\"p\">{`instance.runtime`}</inlineCode>{` object. You can simply import it into your script file code for use and create a reference to the `}<inlineCode parentName=\"p\">{`runtime`}</inlineCode>{` object. For example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { AddOnSdkApi } from \"AddOnSdkApi\"; // named import is AddOnSdkApi\n\nconst { runtime } = AddOnSdkApi.instance; // runtime object provides direct access to the comm methods\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"examples\"\n    }}>{`Examples`}</h2>\n    <p>{`The `}<inlineCode parentName=\"p\">{`runtime`}</inlineCode>{` object provides the methods to allow you to communicate between the two execution environments via `}<inlineCode parentName=\"p\">{`exposeApi()`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`apiProxy()`}</inlineCode>{`. The examples below show the methods in use from both the `}<inlineCode parentName=\"p\">{`index.html`}</inlineCode>{` where the iframe is running with your add-on code, and the script runtime environment running the contents of `}<inlineCode parentName=\"p\">{`code.js`}</inlineCode>{`.`}</p>\n    <h3 {...{\n      \"id\": \"expose-apis-from-the-script\"\n    }}>{`Expose APIs from the script`}</h3>\n    <p>{`This example shows how to expose APIs from the script runtime (via `}<inlineCode parentName=\"p\">{`code.js`}</inlineCode>{`) for use by the UI (via `}<inlineCode parentName=\"p\">{`index.html`}</inlineCode>{`). `}</p>\n    <h4 {...{\n      \"id\": \"codejs\"\n    }}><inlineCode parentName=\"h4\">{`code.js`}</inlineCode></h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { AddOnSdkApi } from \"AddOnSdkApi\";\nconst { runtime } = AddOnSdkApi.instance;\n\nconst scriptApis = {\n    performWorkOnDocument: function (data, someFlag) {\n        // call the Editor APIs\n    },\n    getDataFromDocument: function() {\n        // get some data from document\n    }\n}\n// expose these apis to be directly consumed in the UI (ie: index.html file).\nruntime.exposeApi(scriptApis);\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"indexhtml\"\n    }}>{`index.html`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n\nAddOnSdk.ready.then(async () => {\n    const { runtime } = AddOnSdk.instance;\n\n    // Wait for the promise to resolve (the script runtime may not have initialized yet) to get a proxy to call APIs defined in the script\n    const scriptApis = await runtime.apiProxy(\"script\");\n\n    await scriptApis.performWorkOnDocument({\n        pageNumber: 1,\n        op: \"change_background_color\",\n        data: {\n            toColor: \"blue\"\n        }\n    }, true);\n\n    console.log(await scriptApis.getDataFromDocument());\n});\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"expose-apis-from-the-ui\"\n    }}>{`Expose APIs from the UI`}</h3>\n    <p>{`This example shows how to expose APIs from the UI (via `}<inlineCode parentName=\"p\">{`index.html`}</inlineCode>{`) for use by the script runtime (via `}<inlineCode parentName=\"p\">{`code.js`}</inlineCode>{`). `}</p>\n    <h4 {...{\n      \"id\": \"indexhtml-1\"\n    }}><inlineCode parentName=\"h4\">{`index.html`}</inlineCode></h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`AddOnSdk.ready.then(async () => {\n    console.log(\"AddOnSdk is ready for use.\");\n\n    const { runtime } = AddOnSdk.instance;\n    const uiApi = {\n        performWorkOnUI: function(data, someFlag) {\n            // Do some ui operation\n        },\n        getDataFromUI: async function() {\n            let resolver = undefined;\n            const promise = new Promise(resolve => {\n                resolver = resolve;\n            });\n            setTimeout(() => {\n                resolver(\"button_color_blue\");\n            }, 10);\n            return await promise;\n        }\n    }\n    // Expose the UI Apis to be used in the script code (ie: code.js)\n    runtime.exposeApi(uiApi);\n}\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"codejs-1\"\n    }}><inlineCode parentName=\"h4\">{`code.js`}</inlineCode></h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { AddOnSdkApi } from \"AddOnSdkApi\";\nconst { runtime } = AddOnSdkApi.instance;\n\nasync function callUIApis() {\n    // Get a proxy to the APIs defined in the UI\n    const uiApis = await runtime.apiProxy(\"panel\");\n    await uiApis.performWorkOnUI({\n        buttonTextFont: 20,\n        buttonColor: \"Green\"\n    }, true);\n\n    const result = await uiApis.getDataFromUI();\n    console.log(\"Data from UI: \" + result);\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","mdx","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","_objectWithoutPropertiesLoose","_excluded","_extends","mdxType","slots","variant","parentName","isMDXComponent"],"sourceRoot":""}