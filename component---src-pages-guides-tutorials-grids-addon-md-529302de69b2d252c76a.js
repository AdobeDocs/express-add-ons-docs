"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[7706],{25965:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return i},default:function(){return g}});var a=t(87462),o=t(45987),s=(t(15007),t(64983)),r=t(91515);const d=["components"],i={},c=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.mdx)("div",n)},p=c("ListBlock"),l=c("InlineAlert"),m=c("CodeBlock"),u={_frontmatter:i},h=r.Z;function g(e){let{components:n}=e,t=(0,o.Z)(e,d);return(0,s.mdx)(h,(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,s.mdx)("h1",{id:"building-your-first-add-on-with-the-document-api"},"Building your first add-on with the Document API"),(0,s.mdx)("p",null,"This tutorial will guide you through the creation of your first Adobe Express add-on based on the Adobe Express Document API."),(0,s.mdx)("h2",{id:"introduction"},"Introduction"),(0,s.mdx)("p",null,"Hello, and welcome to this Adobe Express Document API tutorial, where we'll build together a ",(0,s.mdx)("strong",{parentName:"p"},"fully functional Grid System add-on")," from scratch. Grid systems are widely used in the design world to bring structure and consistency to all visual content, from flyers to web pages or social media posts."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"57.50000000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/5530d/grids-addon.webp 320w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/0c8fb/grids-addon.webp 640w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/94b1e/grids-addon.webp 1280w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/0b34d/grids-addon.webp 1920w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/d5269/grids-addon.webp 2560w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/49f40/grids-addon.webp 3456w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/dd4a7/grids-addon.png 320w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/0f09e/grids-addon.png 640w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/bbbf7/grids-addon.png 1280w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/ac7a9/grids-addon.png 1920w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/c7a69/grids-addon.png 2560w","/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/eaa1b/grids-addon.png 3456w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/01bf2caf738ed0d2adb841b9b2a5ba94/bbbf7/grids-addon.png",alt:"grids addon",title:"grids addon",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"Your add-on will allow users to create a variable number of rows and columns, control the spacing between them (known as the ",(0,s.mdx)("em",{parentName:"p"},"gutter"),"), and apply color overlays."),(0,s.mdx)("h3",{id:"timestamp"},"Timestamp"),(0,s.mdx)("p",null,"This tutorial has been written by Davide Barranca, software developer and author from Italy. It's been first published on November 6th, 2023."),(0,s.mdx)("h3",{id:"prerequisites"},"Prerequisites"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"Familiarity with HTML, CSS, JavaScript."),(0,s.mdx)("li",{parentName:"ul"},"Familiarity with the Adobe Express add-ons environment; if you need a refresher, follow the ",(0,s.mdx)("a",{parentName:"li",href:"/express-add-ons-docs/guides/getting_started/quickstart.md"},"quickstart")," guide."),(0,s.mdx)("li",{parentName:"ul"},"An Adobe Express account; use your existing Adobe ID or create one for free."),(0,s.mdx)("li",{parentName:"ul"},"Node.js version 16 or newer.")),(0,s.mdx)("h3",{id:"topics-covered"},"Topics Covered"),(0,s.mdx)(p,{slots:"text1, text2",repeat:"4",iconColor:"#2ac3a2",icon:"disc",variant:"fullWidth",mdxType:"ListBlock"}),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#the-communication-api"},"iframe and Authoring Sandbox communication")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#designing-the-ui-with-spectrum-web-components"},"Spectrum Web Components")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#the-document-api"},"Adobe Express Document API")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#designing-the-ui-with-spectrum-web-components"},"Color Pickers")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#creating-the-first-shape"},"Nodes insertion point")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#creating-the-first-shape"},"Creating and manipulating shapes")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#organizing-the-code"},"Grouping elements")),(0,s.mdx)("p",null,(0,s.mdx)("a",{parentName:"p",href:"#deleting-grids"},"Context permanence")),(0,s.mdx)("p",null,(0,s.mdx)("img",{parentName:"p",src:"/express-add-ons-docs/assets/172274af14d924833da630e850b1d314/grids-addon-animation.gif",alt:null})),(0,s.mdx)("h3",{id:"getting-started-with-the-document-api"},"Getting Started with the Document API"),(0,s.mdx)("p",null,"As part of the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/index.md"},"Authoring Sandbox"),", the Adobe Express Document API (from now on, Document API) is a powerful tool that extends the capabilities of Adobe Express add-ons, offering direct interaction with the open document. Let's take a moment to review the difference between the two core components of the architecture of an add-on."),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"The ",(0,s.mdx)("strong",{parentName:"li"},"iframe")," hosts the add-on User Interface and runs its internal logic. You can think about it as a web application operating in a sandboxed environment: it needs to be separate from the rest of the Adobe Express content for security reasons, which is precisely why the add-on is hosted within an ",(0,s.mdx)("inlineCode",{parentName:"li"},"<iframe>")," element (a detailed technical description is found ",(0,s.mdx)("a",{parentName:"li",href:"/express-add-ons-docs/guides/develop/context.md#iframe-sandbox"},"here"),"). If you come from a CEP/UXP background, it's akin to developing the panel of an extension or plugin."),(0,s.mdx)("li",{parentName:"ul"},"The ",(0,s.mdx)("strong",{parentName:"li"},"Authoring Sandbox"),": allows you to operate on the document. It's a sandboxed JavaScript environment that communicates with the iframe (thanks to the ",(0,s.mdx)("a",{parentName:"li",href:"/express-add-ons-docs/references/scriptruntime/communication/"},"Communication API"),"), providing access to the ",(0,s.mdx)("a",{parentName:"li",href:"/express-add-ons-docs/references/scriptruntime/editor/"},"Document API"),". Drawing the parallel with CEP and UXP again, it represents scripting; that is, the possibility to drive Adobe Express programmatically and, for example, add pages or artboards, create new shapes, rotate or group them, etc.")),(0,s.mdx)("p",null,"This is a high-level overview of the overall structure; while the implementation has more technical nuances, there's no need to dive deeper now."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"57.50000000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/5530d/grids-addon-communication.webp 320w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/0c8fb/grids-addon-communication.webp 640w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/94b1e/grids-addon-communication.webp 1280w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/0b34d/grids-addon-communication.webp 1920w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/f3963/grids-addon-communication.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/dd4a7/grids-addon-communication.png 320w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/0f09e/grids-addon-communication.png 640w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/bbbf7/grids-addon-communication.png 1280w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/ac7a9/grids-addon-communication.png 1920w","/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/6482f/grids-addon-communication.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/12e007aa43ae53da8eff5806db067e67/bbbf7/grids-addon-communication.png",alt:"grids addon communication",title:"grids addon communication",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)(l,{slots:"text",variant:"warning",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"IMPORTANT:")," The authoring sandbox references are currently ",(0,s.mdx)("strong",{parentName:"p"},"experimental only"),", so you will need to set ",(0,s.mdx)("inlineCode",{parentName:"p"},"experimentalApis")," flag to ",(0,s.mdx)("inlineCode",{parentName:"p"},"true")," in the ",(0,s.mdx)("a",{parentName:"p",href:"../manifest/index.md#requirements"},(0,s.mdx)("inlineCode",{parentName:"a"},"requirements"))," section of the ",(0,s.mdx)("inlineCode",{parentName:"p"},"manifest.json")," to use them. ",(0,s.mdx)("em",{parentName:"p"},"Please do not use these APIs in any add-ons you plan to distribute or submit with updates until they have been deemed stable."),"  Also, please be aware that you should only test these experimental APIs against non-essential documents, as they could be lost or corrupted."),(0,s.mdx)("h3",{id:"the-project-structure"},"The Project Structure"),(0,s.mdx)("p",null,"The complete code for the Grids System add-on can be found ",(0,s.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/express-add-on-samples/tree/main/contributed/express-grids-addon"},"here"),", although it would be best if you followed along, starting from this ",(0,s.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/express-add-on-samples/tree/main/contributed/express-addon-document-api-template"},"blank template"),": it sets up a JavaScript/Webpack environment with everything we need to complete the project. You can download the code, ",(0,s.mdx)("inlineCode",{parentName:"p"},"cd")," in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"grids-design")," folder and then:"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-bash"},"npm install\nnpm run build\nnpm run start\n")),(0,s.mdx)("p",null,"This will install the required dependencies, build the project, and then serve it locally on port 5241; if you need more clarification about how to load an add-on in Adobe Express, please refer to the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/guides/getting_started/quickstart.md"},"quickstart")," guide for a step-by-step walkthrough."),(0,s.mdx)("p",null,"Before jumping into the code, let's look at how the project is structured. At the time of this writing, the CLI provides a few templates, but Only ReactJS-based ones include the Authoring Sandbox while also having a Webpack configuration, which is preferable when using Spectrum Web Components (SWC). This project provides support for both of them."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"62.5%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/5530d/grids-addon-folder-structure.webp 320w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/0c8fb/grids-addon-folder-structure.webp 640w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/94b1e/grids-addon-folder-structure.webp 1280w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/0b34d/grids-addon-folder-structure.webp 1920w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/f3963/grids-addon-folder-structure.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/dd4a7/grids-addon-folder-structure.png 320w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/0f09e/grids-addon-folder-structure.png 640w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/bbbf7/grids-addon-folder-structure.png 1280w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/ac7a9/grids-addon-folder-structure.png 1920w","/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/6482f/grids-addon-folder-structure.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/c5f160067f5b65425236e6a395b07950/bbbf7/grids-addon-folder-structure.png",alt:"grids addon folder structure",title:"grids addon folder structure",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"As usual, we'll work in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"src")," folder while Webpack outputs the result in ",(0,s.mdx)("inlineCode",{parentName:"p"},"dist"),". The add-on entry point is ",(0,s.mdx)("inlineCode",{parentName:"p"},"index.html"),", which relies on ",(0,s.mdx)("inlineCode",{parentName:"p"},"ui/index.js")," for the iframe logic code (UI element handlers, etc.). The Document API entry point is instead ",(0,s.mdx)("inlineCode",{parentName:"p"},"script/code.js"),", as defined in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"manifest.json"),":"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    // ...\n    "entryPoints": [\n        {\n            "type": "panel",\n            "id": "panel1",\n            "main": "index.html",\n            "script": "code.js"    // 👈 here\n        }\n    ]\n}\n')),(0,s.mdx)("p",null,"If you're wondering about ",(0,s.mdx)("inlineCode",{parentName:"p"},"script/shapeUtils.js"),", it is an auxiliary file containing private code consumed by ",(0,s.mdx)("inlineCode",{parentName:"p"},"script.js")," that doesn't need to be exposed to the iframe in this specific project. The code of the blank template is as follows."),(0,s.mdx)(m,{slots:"heading, code",repeat:"4",languages:"index.html, index.js, code.js, shapeUtils.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"iframe"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n\n<head>\n    <meta charset="UTF-8" />\n    <meta name="description" content="Adobe Express Add-on tutorial using JavaScript and the Authoring Sandbox" />\n    <meta name="keywords" content="Adobe, Express, Add-On, JavaScript, Authoring Sandbox, Document API" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>Grids add-on</title>\n    <link rel="stylesheet" href="styles.css">\n</head>\n\n<body>\n    <sp-theme scale="medium" color="light" theme="express">\n        <sp-button id="createShape">Create shape</sp-button>\n    </sp-theme>\n</body>\n\n</html>\n')),(0,s.mdx)("h4",{id:"iframe-1"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'// Spectrum imports\nimport "@spectrum-web-components/styles/typography.css";\nimport "@spectrum-web-components/theme/src/themes.js";\nimport "@spectrum-web-components/theme/theme-light.js";\nimport "@spectrum-web-components/theme/express/theme-light.js";\nimport "@spectrum-web-components/theme/express/scale-medium.js";\nimport "@spectrum-web-components/theme/sp-theme.js";\nimport "@spectrum-web-components/button/sp-button.js";\n\nimport addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\naddOnUISdk.ready.then(async () => {\n  console.log("addOnUISdk is ready for use.");\n  const createShapeButton = document.getElementById("createShape");\n\n  // Get the UI runtime.\n  const { runtime } = addOnUISdk.instance;\n  const scriptApi = await runtime.apiProxy("script");\n  scriptApi.log("Authoring Sandbox up and running.");\n\n  // Enabling CTA elements only when the addOnUISdk is ready\n  createShapeButton.disabled = false;\n});\n')),(0,s.mdx)("h4",{id:"document-api"},"Document API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnScriptSdk from "AddOnScriptSdk";\nconst { runtime } = addOnScriptSdk.instance;\n\nfunction start() {\n  runtime.exposeApi({\n    log: (...args) => {\n      console.log(...args);\n    },\n    // other properties will go here...\n  });\n}\n\nstart();\n')),(0,s.mdx)("h4",{id:"document-api-1"},"Document API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// empty\n")),(0,s.mdx)(l,{variant:"info",slots:"text1",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"Please use the iframe and Document API tabs above to switch between the two domains and find a dropdown in the top-right corner to select which file to show."),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"index.html")," contains a ",(0,s.mdx)("inlineCode",{parentName:"p"},"<sp-theme>")," wrapper, whose role is explained ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/guides/design/user_interface.md#spectrum-web-components-with-express-theme"},"here"),", and just a button. There's already something going on in ",(0,s.mdx)("inlineCode",{parentName:"p"},"index.js")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"code.js")," instead, which we must understand."),(0,s.mdx)("h2",{id:"the-communication-api"},"The Communication API"),(0,s.mdx)("p",null,"A crucial component of any add-on that consumes the Document API is the communication bridge with the iframe. As we've seen earlier, it's precisely the role of the ",(0,s.mdx)("strong",{parentName:"p"},"Communication API"),"."),(0,s.mdx)("p",null,"The mechanism is straightforward: through the ",(0,s.mdx)("inlineCode",{parentName:"p"},"runtime")," object (",(0,s.mdx)("inlineCode",{parentName:"p"},"code.js"),", line 2), you can invoke the ",(0,s.mdx)("inlineCode",{parentName:"p"},"exposeApi()")," method, which grants the iframe access to the object literal that is passed as a parameter. The iframe must get to the ",(0,s.mdx)("inlineCode",{parentName:"p"},"runtime"),", too, and use its ",(0,s.mdx)("inlineCode",{parentName:"p"},"apiProxy()")," method passing ",(0,s.mdx)("inlineCode",{parentName:"p"},'"script"'),". This asynchronous call results in the same object whose ",(0,s.mdx)("inlineCode",{parentName:"p"},"log()")," can now be invoked."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"25.625000000000004%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/5530d/grids-addon-communicationapi.webp 320w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/0c8fb/grids-addon-communicationapi.webp 640w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/94b1e/grids-addon-communicationapi.webp 1280w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/0b34d/grids-addon-communicationapi.webp 1920w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/d5269/grids-addon-communicationapi.webp 2560w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/94822/grids-addon-communicationapi.webp 2902w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/dd4a7/grids-addon-communicationapi.png 320w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/0f09e/grids-addon-communicationapi.png 640w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/bbbf7/grids-addon-communicationapi.png 1280w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/ac7a9/grids-addon-communicationapi.png 1920w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/c7a69/grids-addon-communicationapi.png 2560w","/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/58299/grids-addon-communicationapi.png 2902w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/7a1e16b290aa74906764a5f9e492a6d5/bbbf7/grids-addon-communicationapi.png",alt:"Add-on Communication API",title:"Add-on Communication API",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"It would not be uncommon to define an object literal first and pass it to the ",(0,s.mdx)("inlineCode",{parentName:"p"},"exposeAPI")," later."),(0,s.mdx)(l,{variant:"warning",slots:"heading, text1, text2, text3, text4",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"Syntax")),(0,s.mdx)("p",null,"Mind the syntax if you need the functions to call each other: for instance, the following won't work, as arrow functions' ",(0,s.mdx)("inlineCode",{parentName:"p"},"this")," is inherited from the enclosing scope, and there's none provided."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'runtime.exposeApi({\n    log: (...args) => {\n        console.log(...args);\n    },\n    createShape: (shape) => {\n        // ...\n        this.log("Shape created."); // ❌\n    }\n});\n')),(0,s.mdx)("p",null,"The ",(0,s.mdx)("em",{parentName:"p"},"method shorthand syntax")," provides a proper ",(0,s.mdx)("inlineCode",{parentName:"p"},"this")," reference instead."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'runtime.exposeApi({\n    log(...args) {\n        console.log(...args);\n    },\n    createShape(shape) {\n        // ...\n        this.log("Shape created.");  // ✅\n    },\n});\n')),(0,s.mdx)("p",null,"It's also possible to expose iframe methods to the Authoring Sandbox, i.e., using ",(0,s.mdx)("inlineCode",{parentName:"p"},"apiProxy()")," passing ",(0,s.mdx)("inlineCode",{parentName:"p"},'"panel"'),", but it's outside the scope of this tutorial—please refer to ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/samples.md#communication-iframe-script-runtime-sample"},"this sample")," to see it in action."),(0,s.mdx)("h2",{id:"the-document-api"},"The Document API"),(0,s.mdx)("h3",{id:"using-the-reference-documentation"},"Using the Reference Documentation"),(0,s.mdx)("p",null,"The Document API is rapidly expanding: to keep track of its progress, you must get accustomed to consulting the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor.md"},"Reference Documentation"),"."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"55.625%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/5530d/grids-addon-reference.webp 320w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/0c8fb/grids-addon-reference.webp 640w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/94b1e/grids-addon-reference.webp 1280w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/0b34d/grids-addon-reference.webp 1920w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/f3963/grids-addon-reference.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/dd4a7/grids-addon-reference.png 320w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/0f09e/grids-addon-reference.png 640w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/bbbf7/grids-addon-reference.png 1280w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/ac7a9/grids-addon-reference.png 1920w","/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/6482f/grids-addon-reference.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/f0793731044bce5dacc9072c779fd819/bbbf7/grids-addon-reference.png",alt:"Add-on Communication API",title:"Add-on Communication API",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"In the left-navbar, you can browse through all the Classes (which Adobe Express elements are instantiated from), Interfaces and Constants. It's a hierarchical representation of the Document API data structures: for instance, you can see that a ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/RectangleNode/"},(0,s.mdx)("inlineCode",{parentName:"a"},"RectangleNode"))," is a subclass of the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/FillableNode/"},(0,s.mdx)("inlineCode",{parentName:"a"},"FillableNode")),", which in turn subclasses the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/StrokableNode/"},(0,s.mdx)("inlineCode",{parentName:"a"},"StrokableNode")),", which eventually is just a particular kind of ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/Node/"},(0,s.mdx)("inlineCode",{parentName:"a"},"Node")),"—the base class."),(0,s.mdx)("p",null,"Some properties are shared among the ",(0,s.mdx)("inlineCode",{parentName:"p"},"RectangleNode")," and, say, other ",(0,s.mdx)("inlineCode",{parentName:"p"},"StrokableNode")," subclasses such as the ",(0,s.mdx)("inlineCode",{parentName:"p"},"EllipseNode"),": for instance, the ",(0,s.mdx)("inlineCode",{parentName:"p"},"opacity"),", or ",(0,s.mdx)("inlineCode",{parentName:"p"},"blendMode"),". Other ones are unique, like the ",(0,s.mdx)("inlineCode",{parentName:"p"},"topLeftRadius"),", which, in the context of an ",(0,s.mdx)("inlineCode",{parentName:"p"},"EllipseNode"),", wouldn't make sense."),(0,s.mdx)("h3",{id:"creating-the-first-shape"},"Creating the first Shape"),(0,s.mdx)("p",null,"It's finally time to start laying down some elements. Let's hook the only iframe button currently available to a function exposed by the Document API. Type the following into the source files (",(0,s.mdx)("inlineCode",{parentName:"p"},"index.html"),", ",(0,s.mdx)("inlineCode",{parentName:"p"},"index.js"),", and ",(0,s.mdx)("inlineCode",{parentName:"p"},"code.js")," have been edited), then run the add-on."),(0,s.mdx)(m,{slots:"heading, code",repeat:"4",languages:"index.html, index.js, code.js, shapeUtils.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"iframe-2"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-html"},'<body>\n    <sp-theme scale="medium" color="light" theme="express">\n        <sp-button id="createShape" disabled>Create shape</sp-button>\n    </sp-theme>\n</body>\n')),(0,s.mdx)("h4",{id:"iframe-3"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'// ... usual imports\naddOnUISdk.ready.then(async () => {\n  console.log("addOnUISdk is ready for use.");\n  const createShapeButton = document.getElementById("createShape");\n\n  const { runtime } = addOnUISdk.instance;\n  const scriptApi = await runtime.apiProxy("script");\n\n  createShapeButton.addEventListener("click", async () => {\n    scriptApi.createShape({ width: 200, height: 100 }); // 👈\n  });\n\n  createShapeButton.disabled = false;\n});\n')),(0,s.mdx)("h4",{id:"document-api-2"},"Document API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnScriptSdk from "AddOnScriptSdk";\nconst { runtime } = addOnScriptSdk.instance;\nimport { editor, utils, Constants } from "express";\n\nfunction start() {\n  runtime.exposeApi({\n    createShape({ width, height }) {  // 👈\n      const rect = editor.createRectangle();\n      rect.width = width;\n      rect.height = height;\n      rect.translateX = 50;\n      rect.translateY = 50;\n\n      const col = utils.createColor(0.9, 0.5, 0.9);\n      const fillColor = editor.createColorFill(col);\n      rect.fills.append(fillColor);\n\n      editor.context.insertionParent.children.append(rect);\n    },\n  });\n}\n\nstart();\n')),(0,s.mdx)("h4",{id:"document-api-3"},"Document API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// empty\n")),(0,s.mdx)("p",null,"Please note that it's considered good practice to initially ",(0,s.mdx)("strong",{parentName:"p"},"disable all interactive elements")," that need to communicate with the Document API. In this case, there's only one CTA (Call To Action) ",(0,s.mdx)("inlineCode",{parentName:"p"},"<sp-button>"),", but generally any other elements that can make changes to the document should be treated similarly. You should enable them only when the ",(0,s.mdx)("inlineCode",{parentName:"p"},"addOnUISdk")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"addOnScriptSdk")," are initialized, and event listeners are properly set (see ",(0,s.mdx)("inlineCode",{parentName:"p"},"index.js")," line 13)."),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"createShapeButton")," invokes the ",(0,s.mdx)("inlineCode",{parentName:"p"},"createShape()")," method defined and exposed in ",(0,s.mdx)("inlineCode",{parentName:"p"},"code.js")," (lines 7-19), passing an option object with arbitrary ",(0,s.mdx)("inlineCode",{parentName:"p"},"width")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"height")," properties. The function reveals key insights about the Document API—let's have a deeper look at the code."),(0,s.mdx)("p",null,"According to the Reference, ",(0,s.mdx)("inlineCode",{parentName:"p"},"createRectangle()")," is a method of the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/Editor/"},(0,s.mdx)("inlineCode",{parentName:"a"},"Editor"))," class, which must be imported from ",(0,s.mdx)("inlineCode",{parentName:"p"},'"express"')," with the following statement."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, utils, Constants } from "express";\n')),(0,s.mdx)("p",null,"We'll also make use of ",(0,s.mdx)("inlineCode",{parentName:"p"},"utils")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"Constants"),"—they are named imports from ",(0,s.mdx)("inlineCode",{parentName:"p"},'"express"'),", too. The ",(0,s.mdx)("inlineCode",{parentName:"p"},"createRectangle()")," function doesn't need any parameter, either required or optional; hence, the properties of this new element must be set after its creation."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const rect = editor.createRectangle();\nrect.width = width;\nrect.height = height;\nrect.translateX = 50; \nrect.translateY = 50;\n")),(0,s.mdx)("p",null,"Dimensions and positions are straightforward while assigning a fill color is a multi-step process at the moment.",(0,s.mdx)("sup",{parentName:"p",id:"fnref-1"},(0,s.mdx)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const col = utils.createColor(0.9, 0.5, 0.9);\nconst fillColor = editor.createColorFill(col);\nrect.fills.append(fillColor);\n")),(0,s.mdx)("p",null,"First, you make use of the ",(0,s.mdx)("inlineCode",{parentName:"p"},"createColor()")," method from the ",(0,s.mdx)("inlineCode",{parentName:"p"},"utils")," class, which expects four parameters in the (0..1) range: R, G, B and an optional Alpha, and returns a ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/Color/"},"Color")," instance. Then, you use such color to create either a fill or stroke—here, we're using ",(0,s.mdx)("inlineCode",{parentName:"p"},"createColorFill()"),". Finally, you set it to the shape by appending it to the ",(0,s.mdx)("inlineCode",{parentName:"p"},"fills")," list."),(0,s.mdx)(l,{variant:"info",slots:"text1",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"Strokes are created with the ",(0,s.mdx)("inlineCode",{parentName:"p"},"editor.createStroke()")," method, which accepts more parameters (all optional). It's documented ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/Editor.md#createstroke"},"here"),"."),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"rect")," object now exists as a ",(0,s.mdx)("inlineCode",{parentName:"p"},"RectangleNode")," instance with a width of 200 pixels, a height of 100, the top-left corner at the coordinate (50, 50) and a pastel pink fill color. But ",(0,s.mdx)("strong",{parentName:"p"},"it still needs to be rendered on the page!")),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// appending the rect object to the scene\neditor.context.insertionParent.children.append(rect);\n")),(0,s.mdx)("p",null,"Let's unpack this line. As it usually happens with any DOM (Document Object Model), it's easier if read ",(0,s.mdx)("em",{parentName:"p"},"backwards"),"—from the end to the beginning. We are appending the ",(0,s.mdx)("inlineCode",{parentName:"p"},"rect")," object to the ",(0,s.mdx)("inlineCode",{parentName:"p"},"children")," list of the ",(0,s.mdx)("inlineCode",{parentName:"p"},"insertionParent"),' (which is "the ',(0,s.mdx)("em",{parentName:"p"},"preferred parent"),' to insert newly added content into") of the ',(0,s.mdx)("inlineCode",{parentName:"p"},"context"),' (the "User\'s current selection context"), a property of the ',(0,s.mdx)("inlineCode",{parentName:"p"},"editor")," class.",(0,s.mdx)("sup",{parentName:"p",id:"fnref-2"},(0,s.mdx)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))),(0,s.mdx)("p",null,"In other words, we're adding ",(0,s.mdx)("inlineCode",{parentName:"p"},"rect")," as a sibling of whatever happens to be active at the moment: this is what the ",(0,s.mdx)("inlineCode",{parentName:"p"},"context.insertionParent.children")," dance does. If you try to add ",(0,s.mdx)("inlineCode",{parentName:"p"},"rect")," while a shape nested inside a group is selected, then ",(0,s.mdx)("inlineCode",{parentName:"p"},"rect")," will also belong to that group. Please note that Adobe Express documents are based on data structures where instances are ",(0,s.mdx)("em",{parentName:"p"},"appended")," to collections: you ",(0,s.mdx)("inlineCode",{parentName:"p"},"append()")," a color to a ",(0,s.mdx)("inlineCode",{parentName:"p"},"fills")," list and a rectangle to a container's ",(0,s.mdx)("inlineCode",{parentName:"p"},"children")," collection.",(0,s.mdx)("sup",{parentName:"p",id:"fnref-3"},(0,s.mdx)("a",{parentName:"sup",href:"#fn-3",className:"footnote-ref"},"3"))),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"53.75%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/5530d/grids-addon-shape.webp 320w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/0c8fb/grids-addon-shape.webp 640w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/94b1e/grids-addon-shape.webp 1280w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/0b34d/grids-addon-shape.webp 1920w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/d5269/grids-addon-shape.webp 2560w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/2808e/grids-addon-shape.webp 2694w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/dd4a7/grids-addon-shape.png 320w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/0f09e/grids-addon-shape.png 640w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/bbbf7/grids-addon-shape.png 1280w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/ac7a9/grids-addon-shape.png 1920w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/c7a69/grids-addon-shape.png 2560w","/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/78ac0/grids-addon-shape.png 2694w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/4f8fbeabdcd5feaccb117c2d22fe0d93/bbbf7/grids-addon-shape.png",alt:"grids addon shape",title:"grids addon shape",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"Alternatively, you can target the insertion point specifically rather than relying on what happens to be selected at the time of execution. For instance, the following code uses the first ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/ArtboardNode/"},"Artboard")," of the first ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/PageNode/"},"Page"),"."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nconst doc = editor.documentRoot;                     // document\nconst currentPage = doc.pages.first;                 // page\nconst currentArtboard = currentPage.artboards.first; // artboard\ncurrentArtboard.children.append(rect);               // children\n// or\neditor.documentRoot.pages.first.artboards.first.children.append(rect);\n")),(0,s.mdx)("p",null,"Quoting a revealing bit of the Page reference:"),(0,s.mdx)("blockquote",null,(0,s.mdx)("p",{parentName:"blockquote"},'A PageNode represents a page in the document. A page contains one or more artboards, representing "scenes" in a linear timeline sequence. Those artboards, in turn, contain all the visual content of the document.')),(0,s.mdx)("p",null,"You now understand the fundamentals of the Adobe Express DOM and the hierarchical relations between nodes. You have all the necessary tools to begin coding the Grids add-on; you can always refer to the documentation when needed."),(0,s.mdx)("h2",{id:"coding-the-grids-add-on"},"Coding the Grids add-on"),(0,s.mdx)("h3",{id:"designing-the-ui-with-spectrum-web-components"},"Designing the UI with Spectrum Web Components"),(0,s.mdx)("p",null,"Although the main subject of this tutorial is the Document API, let's spend a moment discussing the Grid add-on's User Interface. It's built mainly with ",(0,s.mdx)("strong",{parentName:"p"},"Spectrum Web Components")," (see ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/guides/design/user_interface.md"},"this guide")," for a refresher on Adobe's UX Guidelines and the use of the Spectrum Design System), in particular:"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-number-field>")," for the Rows and Columns inputs;"),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-slider>")," for the Gutter;",(0,s.mdx)("sup",{parentName:"li",id:"fnref-4"},(0,s.mdx)("a",{parentName:"sup",href:"#fn-4",className:"footnote-ref"},"4"))),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-swatch>")," for the color picker;"),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-button-group>")," and ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-button>")," for the CTA buttons.")),(0,s.mdx)("p",null,"The layout is based on nested FlexBox CSS classes, such as ",(0,s.mdx)("inlineCode",{parentName:"p"},"row")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"column"),". Because of the fixed width, margins are tight; the design has also been compacted along the Y-axis for consistency."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"39.37500000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/5530d/grids-addon-swc.webp 320w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/0c8fb/grids-addon-swc.webp 640w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/94b1e/grids-addon-swc.webp 1280w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/0b34d/grids-addon-swc.webp 1920w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/0ab17/grids-addon-swc.webp 2556w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/dd4a7/grids-addon-swc.png 320w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/0f09e/grids-addon-swc.png 640w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/bbbf7/grids-addon-swc.png 1280w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/ac7a9/grids-addon-swc.png 1920w","/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/10cd9/grids-addon-swc.png 2556w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/957df96cbc6e34d92445be69d60d4590/bbbf7/grids-addon-swc.png",alt:"grids addon swc",title:"grids addon swc",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"Please remember that any Spectrum Web Component you use must be installed and imported into the project first—refer to the instructions on ",(0,s.mdx)("a",{parentName:"p",href:"https://opensource.adobe.com/spectrum-web-components/"},"their official site")," and ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/guides/design/user_interface.md#spectrum-web-components-with-express-theme"},"this guide"),". In a nutshell, find the package name in each component's documentation, and then ",(0,s.mdx)("inlineCode",{parentName:"p"},"npm install")," the ones you need."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-bash"},"npm install @spectrum-web-components/swatch\nnpm install @spectrum-web-components/button\n...\n")),(0,s.mdx)("p",null,"Finally, import them in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"ui/index.js")," file."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import "@spectrum-web-components/swatch/sp-swatch.js";\nimport "@spectrum-web-components/button/sp-button.js";\n// ...\n')),(0,s.mdx)("p",null,"The only tricky UI bit worth mentioning here is relative to the ",(0,s.mdx)("strong",{parentName:"p"},"color pickers"),". SWC features a variety of color-related components (Color Area, Color Handle, Color Loupe, Color Slider) but not an actual picker. This add-on implements it via a ",(0,s.mdx)("inlineCode",{parentName:"p"},"<sp-swatch>")," for the UI and a hidden native ",(0,s.mdx)("inlineCode",{parentName:"p"},"<input>")," element behind it."),(0,s.mdx)(m,{slots:"heading, code",repeat:"2",languages:"index.html, ui/index.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"indexhtml"},"index.html"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-html"},'<div class="row">\n    \x3c!-- ... --\x3e\n    <sp-swatch id="rowsColorSwatch" class="color-well"></sp-swatch>\n    <input type="color" id="rowsColorPicker" style="display: none;">\n</div>\n')),(0,s.mdx)("h4",{id:"uiindexjs"},"ui/index.js"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'// Ref to the <sp-input type="color">\nconst rowsColorPicker = document.getElementById("rowsColorPicker");\n// Ref to the <sp-swatch>\nconst rowsColorSwatch = document.getElementById("rowsColorSwatch");\n\n// Initializing the colors for both of them\nrowsColorPicker.value = "#ccccff";\nrowsColorSwatch.color = "#ccccff";\n\n// The <sp-swatch> click triggers the <input> click\nrowsColorSwatch.addEventListener("click", function () {\n    rowsColorPicker.click();\n});\n\n// The <input> click changes the <sp-swatch> fill with the picked color.\nrowsColorPicker.addEventListener("input", function (event) {\n    const selectedColor = event.target.value;\n    rowsColorSwatch.setAttribute("color", selectedColor);\n});\n')),(0,s.mdx)("p",null,"The ",(0,s.mdx)("inlineCode",{parentName:"p"},"<sp-swatch>")," click handler programmatically triggers the ",(0,s.mdx)("inlineCode",{parentName:"p"},"<input>")," click, which, although hidden, can still display the browser's native color picker. On ",(0,s.mdx)("inlineCode",{parentName:"p"},"input")," (i.e., when the user selects a different color within the picker), the ",(0,s.mdx)("inlineCode",{parentName:"p"},"color")," attribute of the ",(0,s.mdx)("inlineCode",{parentName:"p"},"<sp-swatch>")," controlling its fill is changed accordingly to keep both of them in sync. Please note that their values are initialized in ",(0,s.mdx)("inlineCode",{parentName:"p"},"ui/index.js")," for convenience—setting them in ",(0,s.mdx)("inlineCode",{parentName:"p"},"index.html")," would be equally fine."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"20.9375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/5530d/grids-addon-picker.webp 320w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/0c8fb/grids-addon-picker.webp 640w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/94b1e/grids-addon-picker.webp 1280w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/0b34d/grids-addon-picker.webp 1920w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/01f14/grids-addon-picker.webp 2548w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/dd4a7/grids-addon-picker.png 320w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/0f09e/grids-addon-picker.png 640w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/bbbf7/grids-addon-picker.png 1280w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/ac7a9/grids-addon-picker.png 1920w","/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/66205/grids-addon-picker.png 2548w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/5a6d67cb7b4704ec6e199d3eae8606da/bbbf7/grids-addon-picker.png",alt:"grids addon picker",title:"grids addon picker",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"Please refer to the source code for other details on the HTML structure, which are not discussed here for brevity's sake."),(0,s.mdx)("h3",{id:"collecting-values-from-the-ui"},"Collecting values from the UI"),(0,s.mdx)("p",null,"Let's finish the UI, completing the code for ",(0,s.mdx)("inlineCode",{parentName:"p"},"ui/index.js"),". As you can see, it is all standard JavaScript: besides the color pickers we've just discussed, Rows, Columns and Gutter values are initialized (lines 17-19); the Authoring Sandbox is retrieved, and everything the Document API exposes is stored in the ",(0,s.mdx)("inlineCode",{parentName:"p"},"scriptApi")," constant (lines 9-10)."),(0,s.mdx)(m,{slots:"heading, code",repeat:"2",languages:"index.html, ui/index.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"indexhtml-1"},"index.html"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-html"},'<body>\n  <sp-theme scale="medium" color="light" theme="express">\n    <h2>Design Grid creator</h2>\n    <div class="row gap-20">\n      <div class="row">\n        <div class="column">\n          <sp-field-label for="rows" size="m">Rows</sp-field-label>\n          <sp-number-field id="rows" min="1" max="20">\n          </sp-number-field>\n        </div>\n        <sp-swatch id="rowsColorSwatch" class="color-well"></sp-swatch>\n        <input type="color" id="rowsColorPicker" style="display: none;">\n      </div>\n      <div class="row">\n        <div class="column">\n          <sp-field-label for="cols" size="m">Columns</sp-field-label>\n          <sp-number-field id="cols" min="1" max="20">\n          </sp-number-field>\n        </div>\n        <sp-swatch id="colsColorSwatch" class="color-well"></sp-swatch>\n        <input type="color" id="colsColorPicker" style="display: none;">\n      </div>\n    </div>\n    <div class="row">\n      <sp-slider label="Gutter" id="gutter" variant="filled" editable hide-stepper min="1" max="50"\n        format-options=\'{"style": "unit", "unit": "px"}\' step="1"></sp-slider>\n    </div>\n    <sp-button-group horizontal>\n      <sp-button id="deleteGrid" variant="secondary" disabled>Delete</sp-button>\n      <sp-button id="createGrid" disabled>Create</sp-button>\n    </sp-button-group>\n  </sp-theme>\n</body>\n')),(0,s.mdx)("h4",{id:"uiindexjs-1"},"ui/index.js"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'// All the SWC imports...\n\nimport addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\naddOnUISdk.ready.then(async () => {\n  console.log("addOnUISdk is ready for use.");\n\n  // Get the Authoring Sandbox.\n  const { runtime } = addOnUISdk.instance;\n  const scriptApi = await runtime.apiProxy("script");\n\n  // Input fields -------------------------------------------\n\n  const rowsInput = document.getElementById("rows");\n  const colsInput = document.getElementById("cols");\n  const gutterInput = document.getElementById("gutter");\n\n  rowsInput.value = 4;\n  colsInput.value = 6;\n  gutterInput.value = 10;\n\n  // Color pickers ------------------------------------------\n\n  const colsColorPicker = document.getElementById("colsColorPicker");\n  const colsColorSwatch = document.getElementById("colsColorSwatch");\n  const rowsColorPicker = document.getElementById("rowsColorPicker");\n  const rowsColorSwatch = document.getElementById("rowsColorSwatch");\n\n  colsColorPicker.value = "#ffcccc";\n  colsColorSwatch.color = "#ffcccc";\n  rowsColorPicker.value = "#ccccff";\n  rowsColorSwatch.color = "#ccccff";\n\n  colsColorSwatch.addEventListener("click", function () {\n    colsColorPicker.click();\n  });\n  colsColorPicker.addEventListener("input", function (event) {\n    const selectedColor = event.target.value;\n    colsColorSwatch.setAttribute("color", selectedColor);\n  });\n\n  rowsColorSwatch.addEventListener("click", function () {\n    rowsColorPicker.click();\n  });\n  rowsColorPicker.addEventListener("input", function (event) {\n    const selectedColor = event.target.value;\n    rowsColorSwatch.setAttribute("color", selectedColor);\n  });\n\n  // CTA Buttons --------------------------------------------\n\n  const createGridBtn = document.getElementById("createGrid");\n  const deleteGridBtn = document.getElementById("deleteGrid");\n\n  deleteGridBtn.onclick = async (event) => {\n    const res = await scriptApi.deleteGrid();\n    if (res) {\n      // When there\'s been an error deleting the grid, you may want to handle it here\n    }\n    deleteGridBtn.disabled = true;\n  };\n\n  createGridBtn.onclick = async (event) => {\n    await scriptApi.addGrid({\n      columns: colsInput.value,\n      rows: rowsInput.value,\n      gutter: gutterInput.value,\n      columnColor: colsColorPicker.value,\n      rowColor: rowsColorPicker.value,\n    });\n    deleteGridBtn.disabled = false;\n  };\n\n  // Only now it is safe to enable the button\n  createGridBtn.disabled = false;\n});\n')),(0,s.mdx)("p",null,"Eventually, the two buttons (Delete and Create) invoke methods exposed by the Document API, respectively ",(0,s.mdx)("inlineCode",{parentName:"p"},"deleteGrid()")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"createGrid()"),". The latter expects an options object with ",(0,s.mdx)("inlineCode",{parentName:"p"},"rows"),", ",(0,s.mdx)("inlineCode",{parentName:"p"},"columns"),", ",(0,s.mdx)("inlineCode",{parentName:"p"},"gutter"),", ",(0,s.mdx)("inlineCode",{parentName:"p"},"columnColor"),",  and ",(0,s.mdx)("inlineCode",{parentName:"p"},"rowColor")," properties."),(0,s.mdx)("h3",{id:"validation-and-error-handling"},"Validation and Error Handling"),(0,s.mdx)("p",null,"It's worth taking a moment to discuss good validation and error-handling practices at this stage. Just as the QA engineer walking into a bar in the ",(0,s.mdx)("a",{parentName:"p",href:"https://twitter.com/brenankeller/status/1068615953989087232"},"famous joke"),", you must ensure that user input aligns with what the grid algorithm expects; for example, that it receives unsigned integers."),(0,s.mdx)("p",null,"For this tutorial, we'll limit ourselves to setting ",(0,s.mdx)("inlineCode",{parentName:"p"},"min")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"max")," values for the Rows, Columns, and Gutter ranges. This will prevent scenarios like creating a negative number of columns. In a typical implementation, you'd want to insert a validation routine before invoking the primary function. Depending on the algorithm's and the UI's complexity, this routine might belong to the iframe, the Authoring Sandbox, or both. Additionally, apart from validating value type and range, you may want to ensure that the Gutter size is compatible with the chosen number of Rows and Columns to prevent them from overflowing the page dimensions.",(0,s.mdx)("sup",{parentName:"p",id:"fnref-5"},(0,s.mdx)("a",{parentName:"sup",href:"#fn-5",className:"footnote-ref"},"5"))),(0,s.mdx)("p",null,"Another crucial notion is to avoid silent failures: every action should either succeed or provide the user with a notification if it doesn't. That's why, for instance, the Delete button is left disabled until a set of grids is created; instead of handling the removal of a non-existent grid, it's preferable to prevent it in the first place."),(0,s.mdx)("h3",{id:"creating-rows-and-columns"},"Creating Rows and Columns"),(0,s.mdx)("p",null,"It makes sense to approach this grid business with some caution, as we're just starting with the Document API. Let's set up ",(0,s.mdx)("inlineCode",{parentName:"p"},"script/code.js")," to expose this ",(0,s.mdx)("inlineCode",{parentName:"p"},"addGrid()")," method and manage the argument provided."),(0,s.mdx)(m,{slots:"heading, code",repeat:"1",languages:"script/code.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"scriptcodejs"},"script/code.js"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnScriptSdk from "AddOnScriptSdk";\nconst { runtime } = addOnScriptSdk.instance;\nimport { editor, utils, Constants } from "express";\n\nfunction start() {\n  runtime.exposeApi({\n    addGrid({ columns, rows, gutter, columnColor, rowColor }) {\n      console.log("addGrid", columns, rows, gutter, columnColor, rowColor);\n    },\n  });\n}\n\nstart();\n')),(0,s.mdx)("p",null,"When the user clicks the Create button, the parameters from the UI are properly collected, passed to ",(0,s.mdx)("inlineCode",{parentName:"p"},"addGrid()")," in the Authoring Sandbox, and logged. So far, so good, the Communication API does its job."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"37.18749999999999%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/5530d/grids-addon-console.webp 320w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/0c8fb/grids-addon-console.webp 640w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/94b1e/grids-addon-console.webp 1280w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/0b34d/grids-addon-console.webp 1920w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/84b9a/grids-addon-console.webp 2364w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/dd4a7/grids-addon-console.png 320w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/0f09e/grids-addon-console.png 640w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/bbbf7/grids-addon-console.png 1280w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/ac7a9/grids-addon-console.png 1920w","/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/37b68/grids-addon-console.png 2364w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/90773c2c4c707e4d7badae4e9c0739bf/bbbf7/grids-addon-console.png",alt:"grids addon console",title:"grids addon console",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"To begin with, we'll create rows: rectangles that must be as wide as the page. To calculate their height, first, subtract the total number of gutters (which is equal to the number of rows plus one) from the page height. Then, divide the resulting value by the number of rows."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-text"},"rowHeight = (pageHeight - (rowsNumber + 1) * gutter) / rowsNumber;\n")),(0,s.mdx)("p",null,"This is because we're using gutters as page margins, too, as the following illustration shows."),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"62.5%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/5530d/grids-addon-rowheight.webp 320w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/0c8fb/grids-addon-rowheight.webp 640w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/94b1e/grids-addon-rowheight.webp 1280w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/0b34d/grids-addon-rowheight.webp 1920w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/f3963/grids-addon-rowheight.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/dd4a7/grids-addon-rowheight.png 320w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/0f09e/grids-addon-rowheight.png 640w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/bbbf7/grids-addon-rowheight.png 1280w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/ac7a9/grids-addon-rowheight.png 1920w","/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/6482f/grids-addon-rowheight.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/aac12cd262819495fa857c994f712d9c/bbbf7/grids-addon-rowheight.png",alt:"grids addon rowheight",title:"grids addon rowheight",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)("p",null,"We must get hold of the ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/Editor.md#documentroot"},"Document")," (as ",(0,s.mdx)("inlineCode",{parentName:"p"},"documentRoot"),", from the Editor class) and ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/PageNode/"},"Page"),"—the first one from the ",(0,s.mdx)("inlineCode",{parentName:"p"},"pages")," list will be OK for our purposes. Page properties like ",(0,s.mdx)("inlineCode",{parentName:"p"},"width")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"height"),' will be used to compute the attributes of each "row" Rectangle.'),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nruntime.exposeApi({\n    addGrid({ columns, rows, gutter, columnColor, rowColor }) {\n        const doc = editor.documentRoot;\n        const page = doc.pages.first;\n        const rowWidth = page.width;\n      const rowHeight = (page.height - (rowsNumber + 1) * gutter) / rowsNumber;\n    },\n});\n")),(0,s.mdx)("p",null,"In case you want to use the currently active Page instead, you have to traverse back to it using the ",(0,s.mdx)("inlineCode",{parentName:"p"},"insertionParent")," property of the ",(0,s.mdx)("inlineCode",{parentName:"p"},"context")," we've seen earlier as a starting point, and its ",(0,s.mdx)("inlineCode",{parentName:"p"},"parent")," property until you reach a node whose ",(0,s.mdx)("inlineCode",{parentName:"p"},"type")," is equal to the string ",(0,s.mdx)("inlineCode",{parentName:"p"},'"Page"'),". Adobe Express documents must have at least one page, so this is a safe operation."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'// ...\n// Using the current page.\nlet currentNode = editor.context.insertionParent;\nlet page = null;\n\nwhile (currentNode) {\n    if (currentNode.type === "Page") {\n        page = currentNode;\n        break;\n    }\n    page = currentNode.parent;\n}\n// ... rest of the code\n')),(0,s.mdx)("p",null,"To draw all four (or any number coming from the UI) rectangles at once, a loop is in order."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"  // ...\n  var rowsRect = [];\n  for (let i = 0; i < rows; i++) {\n      let r = editor.createRectangle();\n      r.width = page.width;\n      r.height = rowHeight;\n        // moving the row in place\n    r.translateY = gutter + (gutter + rowHeight) * i;\n    rowsRect.push(r);\n  }\n  // adding the rows to the page\n  rowsRect.forEach((rect) => page.artboards.first.children.append(rect));\n")),(0,s.mdx)("p",null,"We've created all the needed rectangles, shifting them on the Y-axis according to their number and gutter, collecting them in a ",(0,s.mdx)("inlineCode",{parentName:"p"},"rowsRect")," array; which, in turn, we've looped through to append them all to the first ",(0,s.mdx)("inlineCode",{parentName:"p"},"artboard")," in the page."),(0,s.mdx)(l,{variant:"info",slots:"text1",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"Please remember that you must always ",(0,s.mdx)("inlineCode",{parentName:"p"},"append()")," elements to their container's ",(0,s.mdx)("inlineCode",{parentName:"p"},"children")," property."),(0,s.mdx)("p",null,"Using the same principles, we can create columns: rectangles as tall as the page and whose width we can compute."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const doc = editor.documentRoot;\nconst page = doc.pages.first;\nvar colsRect = [];\nconst colWidth = (page.width - (cols + 1) * gutter) / cols;\nfor (let i = 0; i < cols; i++) {\n    let r = editor.createRectangle();\n      r.width = colWidth;\n      r.height = page.height;\n        r.translateX = gutter + (gutter + colWidth) * i;\n    cols.push(r);\n}\ncols.forEach((rect) => page.artboards.first.children.append(rect));\n")),(0,s.mdx)("p",null,"We now have most of what is needed to complete the Grids add-on; we're in dire need of a better structure, though."),(0,s.mdx)("h3",{id:"organizing-the-code"},"Organizing the code"),(0,s.mdx)("p",null,"The Grid creation process can be split into ",(0,s.mdx)("strong",{parentName:"p"},"smaller, separate steps"),"—we can take this chance to think about how to structure the entire project."),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"Creating a rectangle is best handled using a dedicated ",(0,s.mdx)("inlineCode",{parentName:"li"},"createRect()")," function."),(0,s.mdx)("li",{parentName:"ul"},"Rows and Columns can be separate processes, too."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"code.js")," doesn't need to expose anything else but the ",(0,s.mdx)("inlineCode",{parentName:"li"},"addGrid()")," and  ",(0,s.mdx)("inlineCode",{parentName:"li"},"deleteGrid()")," methods."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"addRows()")," and ",(0,s.mdx)("inlineCode",{parentName:"li"},"addColumns()")," can belong to the ",(0,s.mdx)("inlineCode",{parentName:"li"},"shapeUtils.js")," module and imported in ",(0,s.mdx)("inlineCode",{parentName:"li"},"script/code.js"),", while ",(0,s.mdx)("inlineCode",{parentName:"li"},"createRect()")," will be kept as private."),(0,s.mdx)("li",{parentName:"ul"},"The Rows and Columns colors come from the UI as hex strings, like ",(0,s.mdx)("inlineCode",{parentName:"li"},'"#ffcccc"'),"; we must write a function that extracts R, G, and B values and maps them to the (0..1) range the Document API deals with.")),(0,s.mdx)(m,{slots:"heading, code",repeat:"2",languages:"script/code.js, script/shapeUtils.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"scriptcodejs-1"},"script/code.js"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnScriptSdk from "AddOnScriptSdk";\nimport { editor } from "express";\nimport { addColumns, addRows } from "./shapeUtils";\n\n// Get the Authoring Sandbox.\nconst { runtime } = addOnScriptSdk.instance;\n\nfunction start() {\n  const scriptApi = {\n    addGrid({ columns, rows, gutter, columnColor, rowColor }) {\n      addRows(rows, gutter, rowColor);\n      addColumns(columns, gutter, columnColor);\n            // ...\n    },\n    deleteGrid() {\n      // ...\n    },\n  };\n  runtime.exposeApi(scriptApi);\n}\nstart();\n')),(0,s.mdx)("h4",{id:"scriptshapeutilsjs"},"script/shapeUtils.js"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, utils, Constants } from "express";\n\nconst hexToColor = (hex) => {\n    // ...\n};\n\n// Utility to create a rectangle and fill it with a color.\nconst createRect = (width, height, color) => {\n  const rect = editor.createRectangle();\n  rect.width = width;\n  rect.height = height;\n  // Fill the rectangle with the color.\n  const rectangleFill = editor.createColorFill(hexToColor(color));\n  rect.fills.append(rectangleFill);\n  return rect;\n};\n\nconst addRows = (rowsNumber, gutter, color) => {\n  const page = editor.documentRoot.pages.first;\n  var rows = [];\n  const rowHeight = (page.height - (rowsNumber + 1) * gutter) / rowsNumber;\n  for (let i = 0; i < rowsNumber; i++) {\n    let r = createRect(page.width, rowHeight, color);\n    r.translateY = gutter + (gutter + rowHeight) * i;\n    rows.push(r);\n  }\n  rows.forEach((row) => page.artboards.first.children.append(row));\n};\n\nconst addColumns = (columNumber, gutter, color) => {\n  const page = editor.documentRoot.pages.first;\n  var cols = [];\n  const colWidth = (page.width - (columNumber + 1) * gutter) / columNumber;\n  for (let i = 0; i < columNumber; i++) {\n    let r = createRect(colWidth, page.height, color);\n    r.translateX = gutter + (gutter + colWidth) * i;\n    cols.push(r);\n  }\n  cols.forEach((col) => page.artboards.first.children.append(col));\n};\n\nexport { addColumns, addRows };\n')),(0,s.mdx)("p",null,"As planned, ",(0,s.mdx)("inlineCode",{parentName:"p"},"createRect()")," conveniently acts as a rectangles factory function, consumed by ",(0,s.mdx)("inlineCode",{parentName:"p"},"addRows()")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"addColumns()"),". Let's fill in the missing bits. The color conversion is performed by ",(0,s.mdx)("inlineCode",{parentName:"p"},"hexToColor()"),", which returns a proper Color object that can be used as a fill (see ",(0,s.mdx)("inlineCode",{parentName:"p"},"shapeUtils.js"),", line 13)."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'const hexToColor = (hex) => {\n  // Ensure the hex value doesn\'t have a "#" at the beginning\n  if (hex.startsWith("#")) { hex = hex.slice(1) }\n  // Extract red, green, and blue hex values\n  const redHex = hex.slice(0, 2);\n  const greenHex = hex.slice(2, 4);\n  const blueHex = hex.slice(4, 6);\n  // Convert hex values to decimal values\n  const red = parseInt(redHex, 16) / 255;\n  const green = parseInt(greenHex, 16) / 255;\n  const blue = parseInt(blueHex, 16) / 255;\n  return utils.createColor(red, green, blue);\n};\n')),(0,s.mdx)("p",null,"It'd be nice to group rows and columns. The Editor class provides a ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/Editor.md#creategroup"},(0,s.mdx)("inlineCode",{parentName:"a"},"createGroup()"))," method returning a ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/GroupNode/"},(0,s.mdx)("inlineCode",{parentName:"a"},"GroupNode")),". Like all ",(0,s.mdx)("inlineCode",{parentName:"p"},"ContainerNode")," classes, it has a ",(0,s.mdx)("inlineCode",{parentName:"p"},"children")," property, which we can append rectangles to."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const addRows = (rowsNumber, gutter, color) => {\n  // ...\n  var rows = [];\n  // ...\n\n  const rowsGroup = editor.createGroup();          // creating a group\n  page.artboards.first.children.append(rowsGroup); // appending to the page\n  rowsGroup.children.append(...rows);              // appending rectangles\n};\n// 👆 same in addColumns()\n")),(0,s.mdx)("p",null,(0,s.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,s.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"49.375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,s.mdx)("picture",{parentName:"span"},"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/5530d/grids-addon-groups.webp 320w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/0c8fb/grids-addon-groups.webp 640w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/94b1e/grids-addon-groups.webp 1280w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/0b34d/grids-addon-groups.webp 1920w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/d5269/grids-addon-groups.webp 2560w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/60878/grids-addon-groups.webp 2631w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,s.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/dd4a7/grids-addon-groups.png 320w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/0f09e/grids-addon-groups.png 640w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/bbbf7/grids-addon-groups.png 1280w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/ac7a9/grids-addon-groups.png 1920w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/c7a69/grids-addon-groups.png 2560w","/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/3c606/grids-addon-groups.png 2631w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,s.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/3f35b5f1867de40509f2b423d657079d/bbbf7/grids-addon-groups.png",alt:"grids addon groups",title:"grids addon groups",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,s.mdx)(l,{variant:"warning",slots:"heading, text1, text2",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"Grouping elements")),(0,s.mdx)("p",null,"Like every other node, groups are first created, and then put on the page. It's important to remember that ",(0,s.mdx)("strong",{parentName:"p"},"groups can only act as containers if they exist on the document")," first."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// DO\nconst rowsGroup = editor.createGroup();          // ✅  create\npage.artboards.first.children.append(rowsGroup); // ✅  append\nrowsGroup.children.append(...rows);              // ✅  fill\n\n// DON'T\nconst rowsGroup = editor.createGroup();          // ✅  create\nrowsGroup.children.append(...rows);              // ❌  fill \npage.artboards.first.children.append(rowsGroup); // ❌  append\n")),(0,s.mdx)("p",null,"To complete the project, we can add some finishing touches. Groups can be locked: preventing accidental shifts and transformations would be nice indeed. The Reference documentation comes in handy again with the boolean ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/GroupNode.md#locked"},(0,s.mdx)("inlineCode",{parentName:"a"},"locked"))," property, which we can easily set after populating the group."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nrowsGroup.children.append(...rows);\nrowsGroup.locked = true;\n")),(0,s.mdx)("p",null,"The Reference also shows an interesting ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/GroupNode.md#blendmode"},(0,s.mdx)("inlineCode",{parentName:"a"},"blendMode")),": setting it to ",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/enums/BlendModeValue/#multiply"},(0,s.mdx)("inlineCode",{parentName:"a"},"multiply"))," will produce a visually nicer overlay effect (",(0,s.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/scriptruntime/editor/classes/GroupNode.md#opacity"},"opacity")," can be an alternative)."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nrowsGroup.blendMode = Constants.BlendModeValue.multiply;\nrowsGroup.locked = true;\n")),(0,s.mdx)("p",null,"At present, the Reference includes only a few enumerations, such as ",(0,s.mdx)("inlineCode",{parentName:"p"},"BlendModeValue"),". As the Document API expands, more enumerations will be added. They provide sets of named constants, making the code more readable by replacing direct numeric values with descriptive names."),(0,s.mdx)(l,{variant:"warning",slots:"text1",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"For example, the Multiply blend mode corresponds to the number 3. Although, developers should avoid hard-coding enum's values, as they are for internal use and subject to change."),(0,s.mdx)("p",null,"It would be preferable if a single group contained Rows and Columns; we must edit both ",(0,s.mdx)("inlineCode",{parentName:"p"},"addRows()")," and ",(0,s.mdx)("inlineCode",{parentName:"p"},"addColumns()")," first to return their group in order to reference them in the parent one."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"const addRows = (rowsNumber, gutter, color) => {\n    // ...\n    rowsGroup.locked = true;\n    return rowsGroup;  // 👈 returning the group\n}\n\nconst addColumns = (columNumber, gutter, color) => {\n    // ...\n    columnsGroup.locked = true;\n    return columnsGroup;// 👈 \n}\n")),(0,s.mdx)("p",null,"They can be referenced in ",(0,s.mdx)("inlineCode",{parentName:"p"},"addGrid()"),", appending them as children of this new group."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"addGrid({ columns, rows, gutter, columnColor, rowColor }) {\n    // ...\n\n    const rowGroup = addRows(rows, gutter, rowColor);\n    const columnGroup = addColumns(columns, gutter, columnColor);\n\n    // create a parent group\n    const gridGroup = editor.createGroup();\n    page.artboards.first.children.append(gridGroup);\n    gridGroup.children.append(rowGroup, columnGroup); // filling with Rows and Columns\n    gridGroup.locked = true;\n}\n")),(0,s.mdx)("h3",{id:"deleting-grids"},"Deleting Grids"),(0,s.mdx)("p",null,"From the users' perspective, it would speed up the testing process of new grid designs if they could clear the current one and experiment with different combinations—that is, a Delete button. You can both add and remove elements to a container object's ",(0,s.mdx)("inlineCode",{parentName:"p"},"children")," list: most Node elements have a ",(0,s.mdx)("inlineCode",{parentName:"p"},"removeFromParent()")," method, which detaches them from their parent container."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},"gridGroup.removeFromParent(); // voilà\n")),(0,s.mdx)("p",null,"Curb your enthusiasm: if you think about it, there might be an issue lurking here. The process of removing a group is performed at a later time, with respect to its creation: how can we be sure to target the correct container? Groups don't have names or IDs, at least for the time being. Luckily, the ",(0,s.mdx)("inlineCode",{parentName:"p"},"code.js")," file provides ",(0,s.mdx)("strong",{parentName:"p"},"an environment that persists in between iframe calls"),": in other words, you can store the group in a variable and retrieve it later."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'let gridRef = null; // 👈 Grids group reference\n\nfunction start() {\n  runtime.exposeApi({\n    addGrid({ columns, rows, gutter, columnColor, rowColor }) {\n      // ...\n      const gridGroup = editor.createGroup();\n      // ...\n      gridRef = gridGroup; // 👈 storing the group for later\n    },\n    deleteGrid() {\n      if (gridRef) {\n        try {\n          gridRef.removeFromParent(); // 👈 removing from the document\n          gridRef = null;             //    clearing the reference\n        } catch (error) {\n          console.error(error);\n          return "Error: the Grid could not be deleted."\n        }\n      } \n    },\n  });\n}\nstart();\n')),(0,s.mdx)("p",null,"Although not exposed through the Communication API, the ",(0,s.mdx)("inlineCode",{parentName:"p"},"gridRef")," variable is private to ",(0,s.mdx)("inlineCode",{parentName:"p"},"code.js"),", and exists within the closure of the functions defined inside and exposed by ",(0,s.mdx)("inlineCode",{parentName:"p"},"runtime.exposeApi()"),".",(0,s.mdx)("sup",{parentName:"p",id:"fnref-6"},(0,s.mdx)("a",{parentName:"sup",href:"#fn-6",className:"footnote-ref"},"6"))),(0,s.mdx)("h2",{id:"next-steps"},"Next Steps"),(0,s.mdx)("p",null,"Congratulations! You've coded from scratch the Grids Design System add-on. This proof-of-concept may be extended to make it even more useful as a product; you may implement the following features as an exercise."),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Page margins"),": we're using the gutter for this purpose, but a proper ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-number-field>")," can be added to allow users to set margins."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Visibility toggle"),": Use a ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-slider>"),"to control the grid's opacity, or add a ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-switch>")," to toggle them on and off."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Presets"),": a dropdown menu might store commonly used grid sets—use a ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-picker>")," and the ",(0,s.mdx)("a",{parentName:"li",href:"/express-add-ons-docs/references/addonsdk/instance-clientStorage/"},"Client Storage API"),".")),(0,s.mdx)("h2",{id:"lessons-learned"},"Lessons Learned"),(0,s.mdx)("p",null,"Let's review the concepts covered in this tutorial and how they've been implemented in the Grids add-on."),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},"The ",(0,s.mdx)("strong",{parentName:"li"},"iframe")," and the ",(0,s.mdx)("strong",{parentName:"li"},"Authoring Sandbox")," are two distinct entities able to share contexts via the Communication API. We've used the ",(0,s.mdx)("inlineCode",{parentName:"li"},"exposeApi()")," method of the ",(0,s.mdx)("inlineCode",{parentName:"li"},"runtime")," object to allow the iframe to invoke functions in the Document API domain."),(0,s.mdx)("li",{parentName:"ul"},"The ",(0,s.mdx)("strong",{parentName:"li"},"Document API")," provides access to Adobe Express' Document Object Model, which defines containment structures and inheritance hierarchies. We've retrieved the document, its pages, and artboards; created, moved and assigned blending modes to shapes; created, populated and locked groups."),(0,s.mdx)("li",{parentName:"ul"},"Nodes (elements) in Adobe Express documents can be added to the document in a position relative to the currently active selection or targeting a container as the ",(0,s.mdx)("strong",{parentName:"li"},"insertion point"),"; we've seen how ",(0,s.mdx)("inlineCode",{parentName:"li"},"ContainerNode")," elements have a ",(0,s.mdx)("inlineCode",{parentName:"li"},"children")," collection to ",(0,s.mdx)("inlineCode",{parentName:"li"},"append()")," elements to."),(0,s.mdx)("li",{parentName:"ul"},"The Document API ",(0,s.mdx)("strong",{parentName:"li"},"context is permanent")," in between iframe calls. We've seen that it's possible to store a reference to a Node within the exposed methods' closure and act upon it after its creation."),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("strong",{parentName:"li"},"Spectrum Web Components")," are crucial to UI building, but sometimes they require customization; in this project, we've linked a ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-swatch>")," to a traditional ",(0,s.mdx)("inlineCode",{parentName:"li"},"<input>")," element to create an Adobe Express' native-looking color picker.")),(0,s.mdx)("h2",{id:"final-project"},"Final Project"),(0,s.mdx)("p",null,"The code for this project can be downloaded ",(0,s.mdx)("a",{parentName:"p",href:"https://github.com/undavide/express-grids-addon"},"here"),". It's available in two states: the starting point (one Create Shape button in the UI and the respective Document API function) if you want to follow along with the tutorial and type in the code—the best way to learn—and the final state, which code is also found below for convenience."),(0,s.mdx)(m,{slots:"heading, code",repeat:"5",languages:"index.html, index.js, styles.css, code.js, shapeUtils.js",mdxType:"CodeBlock"}),(0,s.mdx)("h4",{id:"iframe-4"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n\n<head>\n  <meta charset="UTF-8" />\n  <meta name="description" content="Adobe Express Add-on tutorial using JavaScript and the Authoring Sandbox" />\n  <meta name="keywords" content="Adobe, Express, Add-On, JavaScript, Authoring Sandbox, Adobe Express Document API" />\n  <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n  <title>Grids add-on</title>\n  <link rel="stylesheet" href="styles.css">\n</head>\n\n<body>\n  <sp-theme scale="medium" color="light" theme="express">\n    <h2>Design Grid creator</h2>\n    <div class="row gap-20">\n      <div class="row">\n        <div class="column">\n          <sp-field-label for="rows" size="m">Rows</sp-field-label>\n          <sp-number-field id="rows" min="1" max="20">\n          </sp-number-field>\n        </div>\n        <sp-swatch id="rowsColorSwatch" class="color-well"></sp-swatch>\n        <input type="color" id="rowsColorPicker" style="display: none;">\n      </div>\n      <div class="row">\n        <div class="column">\n          <sp-field-label for="cols" size="m">Columns</sp-field-label>\n          <sp-number-field id="cols" min="1" max="20">\n          </sp-number-field>\n        </div>\n        <sp-swatch id="colsColorSwatch" class="color-well"></sp-swatch>\n        <input type="color" id="colsColorPicker" style="display: none;">\n      </div>\n    </div>\n    <div class="row">\n      <sp-slider label="Gutter" id="gutter" variant="filled" editable hide-stepper min="1" max="50"\n        format-options=\'{"style": "unit", "unit": "px"}\' step="1"></sp-slider>\n    </div>\n    <sp-button-group horizontal>\n      <sp-button id="deleteGrid" variant="secondary" disabled>Delete</sp-button>\n      <sp-button id="createGrid" disabled>Create</sp-button>\n    </sp-button-group>\n  </sp-theme>\n</body>\n\n</html>\n')),(0,s.mdx)("h4",{id:"iframe-5"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import "@spectrum-web-components/styles/typography.css";\n\nimport "@spectrum-web-components/theme/src/themes.js";\nimport "@spectrum-web-components/theme/theme-light.js";\nimport "@spectrum-web-components/theme/express/theme-light.js";\nimport "@spectrum-web-components/theme/express/scale-medium.js";\nimport "@spectrum-web-components/theme/sp-theme.js";\n\nimport "@spectrum-web-components/button/sp-button.js";\nimport "@spectrum-web-components/button-group/sp-button-group.js";\nimport "@spectrum-web-components/field-label/sp-field-label.js";\nimport "@spectrum-web-components/number-field/sp-number-field.js";\nimport "@spectrum-web-components/slider/sp-slider.js";\nimport "@spectrum-web-components/swatch/sp-swatch.js";\n\nimport addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\naddOnUISdk.ready.then(async () => {\n  console.log("addOnUISdk is ready for use.");\n\n  // Get the Authoring Sandbox.\n  const { runtime } = addOnUISdk.instance;\n  const scriptApi = await runtime.apiProxy("script");\n\n  // Input fields -------------------------------------------\n\n  const rowsInput = document.getElementById("rows");\n  const colsInput = document.getElementById("cols");\n  const gutterInput = document.getElementById("gutter");\n\n  rowsInput.value = 4;\n  colsInput.value = 6;\n  gutterInput.value = 10;\n\n  // Color pickers ------------------------------------------\n\n  const colsColorPicker = document.getElementById("colsColorPicker");\n  const colsColorSwatch = document.getElementById("colsColorSwatch");\n  const rowsColorPicker = document.getElementById("rowsColorPicker");\n  const rowsColorSwatch = document.getElementById("rowsColorSwatch");\n\n  colsColorPicker.value = "#ffcccc";\n  colsColorSwatch.color = "#ffcccc";\n  rowsColorPicker.value = "#ccccff";\n  rowsColorSwatch.color = "#ccccff";\n\n  colsColorSwatch.addEventListener("click", function () {\n    colsColorPicker.click();\n  });\n  colsColorPicker.addEventListener("input", function (event) {\n    const selectedColor = event.target.value;\n    colsColorSwatch.setAttribute("color", selectedColor);\n  });\n\n  rowsColorSwatch.addEventListener("click", function () {\n    rowsColorPicker.click();\n  });\n  rowsColorPicker.addEventListener("input", function (event) {\n    const selectedColor = event.target.value;\n    rowsColorSwatch.setAttribute("color", selectedColor);\n  });\n\n  // CTA Buttons --------------------------------------------\n\n  const createGridBtn = document.getElementById("createGrid");\n  const deleteGridBtn = document.getElementById("deleteGrid");\n\n  deleteGridBtn.onclick = async (event) => {\n    const res = await scriptApi.deleteGrid();\n    if (res) {\n      // When there\'s been an error deleting the grid, you may want to handle it here\n    }\n    deleteGridBtn.disabled = true;\n  };\n\n  createGridBtn.onclick = async (event) => {\n    await scriptApi.addGrid({\n      columns: colsInput.value,\n      rows: rowsInput.value,\n      gutter: gutterInput.value,\n      columnColor: colsColorPicker.value,\n      rowColor: rowsColorPicker.value,\n    });\n    deleteGridBtn.disabled = false;\n  };\n\n  // Only now it is safe to enable the button\n  createGridBtn.disabled = false;\n});\n')),(0,s.mdx)("h4",{id:"iframe-6"},"iframe"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-css"},"body {\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n}\n\nsp-theme {\n  margin: 0 var(--spectrum-global-dimension-static-size-300);\n  display: grid;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  width: 100%;\n  align-items: flex-end;\n}\n\n.gap-20 {\n  gap: var(--spectrum-global-dimension-static-size-250);\n}\n\n.gutter-row {\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  width: 100%;\n  align-items: flex-start;\n  border: 1px solid black;\n  margin-bottom: var(--spectrum-global-dimension-static-size-150);\n}\n\n.column {\n  display: flex;\n  flex-direction: column;\n  padding-right: var(--spectrum-global-dimension-static-size-100);\n  width: var(--spectrum-global-dimension-static-size-1000);\n}\n\nh2 {\n  font-weight: var(--spectrum-global-font-weight-black);\n}\n\nsp-swatch {\n  width: var(--spectrum-swatch-size-medium);\n}\n\n.color-well {\n  cursor: pointer;\n  --mod-swatch-border-thickness: var(--spectrum-divider-thickness-small);\n  --mod-swatch-border-color: var(--spectrum-transparent-black-500);\n}\n\nsp-button {\n  flex: 1;\n  max-width: calc(\n    (100% - var(--spectrum-global-dimension-static-size-250)) / 2\n  );\n}\n\nsp-number-field,\nsp-slider {\n  width: 100%;\n}\n\nsp-button-group {\n  margin-top: var(--spectrum-global-dimension-static-size-300);\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n}\n")),(0,s.mdx)("h4",{id:"document-api-4"},"Document API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnScriptSdk from "AddOnScriptSdk";\nimport { editor } from "express";\nimport { addColumns, addRows } from "./shapeUtils";\n\n// Get the Authoring Sandbox.\nconst { runtime } = addOnScriptSdk.instance;\n\nlet gridRef = null;\n\nfunction start() {\n  // APIs to be exposed to the UI runtime\n  runtime.exposeApi({\n    /**\n     * Add a grid to the document.\n     *\n     * @param {Object} options - The options for the grid.\n     * @param {number} options.columns - The number of columns in the grid.\n     * @param {number} options.rows - The number of rows in the grid.\n     * @param {number} options.gutter - The size of the gutter between columns and rows.\n     * @param {string} options.columnColor - The color of the columns.\n     * @param {string} options.rowColor - The color of the rows.\n     * @returns {Group} The group containing the grid.\n     */\n    addGrid({ columns, rows, gutter, columnColor, rowColor }) {\n      // Get the document and page.\n      const doc = editor.documentRoot;\n      const page = doc.pages.first;\n      // Create the grid.\n      const rowGroup = addRows(rows, gutter, rowColor);\n      const columnGroup = addColumns(columns, gutter, columnColor);\n\n      // Create the grid\'s group.\n      const gridGroup = editor.createGroup();\n      page.artboards.first.children.append(gridGroup);\n      gridGroup.children.append(rowGroup, columnGroup);\n      gridGroup.locked = true;\n\n      // Save the grid reference.\n      gridRef = gridGroup;\n    },\n\n    /**\n     * Delete the grid from the document.\n     * @returns {void}\n     */\n    deleteGrid() {\n      if (gridRef) {\n        try {\n          gridRef.removeFromParent();\n          gridRef = null;\n        } catch (error) {\n          console.error(error);\n          return "Error: the Grid could not be deleted.";\n        }\n      }\n    },\n  });\n}\n\nstart();\n\n')),(0,s.mdx)("h4",{id:"document-api-5"},"Document API"),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, utils, Constants } from "express";\n\n/**\n * Convert a hex color string to an instance of the Color class\n * Private utility of the shapeUtils module.\n *\n * @param {string} hex - The hex color value to convert.\n * @returns {Color} A color instance with RGB values in the (0..1) range.\n */\nconst hexToColor = (hex) => {\n  // Ensure the hex value doesn\'t have a "#" at the beginning\n  if (hex.startsWith("#")) {\n    hex = hex.slice(1);\n  }\n\n  // Extract red, green, and blue hex values\n  const redHex = hex.slice(0, 2);\n  const greenHex = hex.slice(2, 4);\n  const blueHex = hex.slice(4, 6);\n\n  // Convert hex values to decimal values\n  const red = parseInt(redHex, 16) / 255;\n  const green = parseInt(greenHex, 16) / 255;\n  const blue = parseInt(blueHex, 16) / 255;\n\n  return utils.createColor(red, green, blue);\n};\n\n/**\n * Create a rectangle with the specified width, height, and color.\n * Private utility of the shapeUtils module.\n *\n * @param {number} width - The width of the rectangle.\n * @param {number} height - The height of the rectangle.\n * @param {string} color - The color of the rectangle in hex format.\n * @returns {RectangleNode} The created rectangle.\n */\nconst createRect = (width, height, color) => {\n  const rect = editor.createRectangle();\n  rect.width = width;\n  rect.height = height;\n  const rectangleFill = editor.createColorFill(hexToColor(color));\n  rect.fills.append(rectangleFill);\n  return rect;\n};\n\n/**\n * Add rows of rectangles to the document.\n *\n * @param {number} rowsNumber - The number of rows to add.\n * @param {number} gutter - The size of the gutter between rows.\n * @param {string} color - The color of the rows in hex format.\n * @returns {GroupNode} A group containing the created rows.\n */\nconst addRows = (rowsNumber, gutter, color) => {\n  const doc = editor.documentRoot;\n  const page = doc.pages.first;\n\n  var rows = [];\n  const rowHeight = (page.height - (rowsNumber + 1) * gutter) / rowsNumber;\n  // Create the rectangles\n  for (let i = 0; i < rowsNumber; i++) {\n    let r = createRect(page.width, rowHeight, color);\n    r.translateY = gutter + (gutter + rowHeight) * i;\n    rows.push(r);\n  }\n  // Append the rectangles to the document\n  rows.forEach((row) => page.artboards.first.children.append(row));\n  // Create the group\n  const rowsGroup = editor.createGroup();\n  // Append the group to the document\n  page.artboards.first.children.append(rowsGroup);\n  // Populate the group with the rectangles\n  rowsGroup.children.append(...rows);\n  // Edit the group\'s properties\n  rowsGroup.blendMode = Constants.BlendModeValue.multiply;\n  rowsGroup.locked = true;\n  return rowsGroup;\n};\n\n/**\n * Add columns of rectangles to the document.\n *\n * @param {number} columsNumber - The number of columns to add.\n * @param {number} gutter - The size of the gutter between columns.\n * @param {string} color - The color of the columns in hex format.\n * @returns {GroupNode} A group containing the created columns.\n */\nconst addColumns = (columsNumber, gutter, color) => {\n  const doc = editor.documentRoot;\n  const page = doc.pages.first;\n  var cols = [];\n  const colWidth = (page.width - (columsNumber + 1) * gutter) / columsNumber;\n  // Create the rectangles\n  for (let i = 0; i < columsNumber; i++) {\n    let r = createRect(colWidth, page.height, color);\n    r.translateX = gutter + (gutter + colWidth) * i;\n    cols.push(r);\n  }\n  // Append the rectangles to the document\n  cols.forEach((col) => page.artboards.first.children.append(col));\n  // Create the group\n  const columnsGroup = editor.createGroup();\n  // Append the group to the document\n  page.artboards.first.children.append(columnsGroup);\n  // Populate the group with the rectangles\n  columnsGroup.children.append(...cols);\n  // Edit the group\'s properties\n  columnsGroup.blendMode = Constants.BlendModeValue.multiply;\n  columnsGroup.locked = true;\n  return columnsGroup;\n};\n\nexport { addColumns, addRows };\n\n')),(0,s.mdx)("div",{className:"footnotes"},(0,s.mdx)("hr",{parentName:"div"}),(0,s.mdx)("ol",{parentName:"div"},(0,s.mdx)("li",{parentName:"ol",id:"fn-1"},"Future updates may offer a simpler color creation process.",(0,s.mdx)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"↩")),(0,s.mdx)("li",{parentName:"ol",id:"fn-2"},"The quotes are from the Documentation Reference of each element.",(0,s.mdx)("a",{parentName:"li",href:"#fnref-2",className:"footnote-backref"},"↩")),(0,s.mdx)("li",{parentName:"ol",id:"fn-3"},'The terms "list" is used in the Adobe Express reference documentation, while "collection" may be more familiar to CEP/UXP developers; they are used interchangeably here.',(0,s.mdx)("a",{parentName:"li",href:"#fnref-3",className:"footnote-backref"},"↩")),(0,s.mdx)("li",{parentName:"ol",id:"fn-4"},"It could have been another ",(0,s.mdx)("inlineCode",{parentName:"li"},"<sp-number-field>"),", but a slider played well with the overall design.",(0,s.mdx)("a",{parentName:"li",href:"#fnref-4",className:"footnote-backref"},"↩")),(0,s.mdx)("li",{parentName:"ol",id:"fn-5"},"For example, you may want to retrieve the page's ",(0,s.mdx)("inlineCode",{parentName:"li"},"width")," and ",(0,s.mdx)("inlineCode",{parentName:"li"},"height")," properties at the beginning, and use them in the rest of the code.",(0,s.mdx)("a",{parentName:"li",href:"#fnref-5",className:"footnote-backref"},"↩")),(0,s.mdx)("li",{parentName:"ol",id:"fn-6"},"Future versions of the Document API may provide more deliberate ways to refer to elements.",(0,s.mdx)("a",{parentName:"li",href:"#fnref-6",className:"footnote-backref"},"↩")))))}g.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-tutorials-grids-addon-md-529302de69b2d252c76a.js.map