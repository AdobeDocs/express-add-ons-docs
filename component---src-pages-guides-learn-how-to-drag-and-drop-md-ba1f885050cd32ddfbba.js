"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[9415],{61147:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return l},default:function(){return h}});var a=t(58168),o=t(80045),d=(t(88763),t(15680)),r=t(83407);const i=["components"],l={},m=(s="InlineAlert",function(e){return console.warn("Component "+s+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",e)});var s;const p={_frontmatter:l},c=r.A;function h(e){let{components:n}=e,t=(0,o.A)(e,i);return(0,d.mdx)(c,(0,a.A)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,d.mdx)("h1",{id:"use-drag-and-drop"},"Use Drag-and-Drop"),(0,d.mdx)("h2",{id:"with-local-images"},"With local images"),(0,d.mdx)("p",null,"You must invoke the ",(0,d.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/addonsdk/addonsdk-app.md#enabledragtodocument"},(0,d.mdx)("inlineCode",{parentName:"a"},"addOnUISdk.app.enableDragToDocument()"))," method for each draggable image to implement this feature. It accepts two parameters: the ",(0,d.mdx)("inlineCode",{parentName:"p"},"HTMLElement")," and an object with a ",(0,d.mdx)("inlineCode",{parentName:"p"},"previewCallback()")," that returns the image URL for preview purposes, and a ",(0,d.mdx)("inlineCode",{parentName:"p"},"completionCallback()")," that fetches the corresponding blob to finalize insertion into the document."),(0,d.mdx)("p",null,"You also need to listen for ",(0,d.mdx)("inlineCode",{parentName:"p"},'"dragstart"')," and ",(0,d.mdx)("inlineCode",{parentName:"p"},'"dragend"')," events to manage logs or other custom behaviour when the user interacts with the images."),(0,d.mdx)("h3",{id:"example"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://express.adobe.com/static/add-on-sdk/sdk.js";\n\n// Wait for the SDK to be ready before rendering elements in the DOM.\naddOnUISdk.ready.then(async () => {\n  // Create the image element in the DOM.\n  const image = document.createElement("img");\n  image.id = "image.jpg";\n  // The image is local to the add-on.\n  image.src = "./images/image.jpg";\n  image.addEventListener("click", addToDocument);\n\n  // Enable drag to document for the image.\n  addOnUISdk.app.enableDragToDocument(image, {\n    previewCallback: (element) => {\n      // return the new URL for preview purposes\n      return new URL(element.src);\n    },\n    completionCallback: async (element) => {\n      // return the blob for the image\n      return [{ blob: await getBlob(element.src) }];\n    },\n  });\n\n  // Add the image to the document.\n  document.body.appendChild(image);\n});\n\n// Utility functions\n\n//Add image to the document.\nasync function addToDocument(event) {\n  const url = event.currentTarget.src;\n  const blob = await getBlob(url);\n  addOnUISdk.app.document.addImage(blob);\n}\n\n// Handle "dragstart" event\nfunction startDrag(eventData) {\n  console.log("The drag event has started for", eventData.element.id);\n}\n\n// Handle "dragend" event\nfunction endDrag(eventData) {\n  if (!eventData.dropCancelled) {\n    console.log("The drag event has ended for", eventData.element.id);\n  } else {\n    console.log("The drag event was cancelled for", eventData.element.id);\n  }\n}\n\n// Get the binary object for the image.\nasync function getBlob(url) {\n  return await fetch(url).then((response) => response.blob());\n}\n')),(0,d.mdx)("h2",{id:"with-remote-images-or-audio"},"With remote images or audio"),(0,d.mdx)("p",null,"To implement drag and drop with remotely hosted images, you similarly invoke ",(0,d.mdx)("inlineCode",{parentName:"p"},"addOnUISdk.app.enableDragToDocument()"),", but you fetch the resource from its remote URL. Provide a ",(0,d.mdx)("inlineCode",{parentName:"p"},"previewCallback()")," that returns the preview URL and a ",(0,d.mdx)("inlineCode",{parentName:"p"},"completionCallback()")," that retrieves the image as a blob. You can then attach the same ",(0,d.mdx)("inlineCode",{parentName:"p"},'"dragstart"')," and ",(0,d.mdx)("inlineCode",{parentName:"p"},'"dragend"')," event handlers to log or customize interactions as needed."),(0,d.mdx)(m,{slots:"text",variant:"warning",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"To drag audio content, you must specify an additional ",(0,d.mdx)("inlineCode",{parentName:"p"},"attributes")," object with a ",(0,d.mdx)("inlineCode",{parentName:"p"},"title")," property. A note on how to include it is found in the following example."),(0,d.mdx)("h3",{id:"example-1"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-ts"},'import addOnUISdk from "https://express.adobe.com/static/add-on-sdk/sdk.js";\n\n// Enable drag support for an element\nfunction makeDraggableUsingUrl(elementId: string, previewUrl: string) {\n  const image = document.getElementById(elementId);\n\n  const dragCallbacks = {\n    previewCallback: (image: HTMLElement) => {\n      // Return a new URL for the remote preview\n      return new URL(previewUrl);\n    },\n    completionCallback: async (image: HTMLElement) => {\n      // Fetch and return the image blob\n      const imageBlob = await fetch(image.src).then((response) =>\n        response.blob()\n      );\n      return [{ blob: imageBlob }];\n\n      // ⚠️ for audio content, an attributes object\n      // with the title is mandatory. For example:\n      // return [{ blob: audioBlob, attributes: { title: "Jazzy beats" } }];\n    },\n  };\n\n  try {\n    addOnUISdk.app.enableDragToDocument(image, dragCallbacks);\n  } catch (error) {\n    console.log("Failed to enable DragToDocument:", error);\n  }\n}\n\n// Log start of the drag event\naddOnUISdk.app.on("dragstart", (eventData: DragStartEventData) => {\n  console.log("The drag event has started for", eventData.element);\n});\n\n// Log end of the drag event\naddOnUISdk.app.on("dragend", (eventData: DragEndEventData) => {\n  if (!eventData.dropCancelled) {\n    console.log("The drag event has ended for", eventData.element);\n    disableDragToDocument();\n  } else {\n    console.log("The drag event was cancelled for", eventData.element);\n    console.log("Cancel Reason:", eventData.dropCancelReason);\n  }\n});\n')),(0,d.mdx)("h2",{id:"dragging-converted-documents"},"Dragging converted documents"),(0,d.mdx)("p",null,"If the drag and drop operation is used to import a PDF document, and was specifically one converted from a Word document (",(0,d.mdx)("inlineCode",{parentName:"p"},".docx"),") or Google Docs (",(0,d.mdx)("inlineCode",{parentName:"p"},".gdoc"),") format, to improve the user experience, use the ",(0,d.mdx)("inlineCode",{parentName:"p"},"sourceMimeType")," parameter in the ",(0,d.mdx)("inlineCode",{parentName:"p"},"attributes"),' object. This ensures that when users drag the converted PDF, the import consent dialog shows "Import a document" instead of "Import a PDF".'),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-ts"},'// Enable drag support for a converted document\nfunction makeDraggableConvertedDoc(elementId: string, convertedPdfBlob: Blob, originalMimeType: string) {\n  const element = document.getElementById(elementId);\n\n  const dragCallbacks = {\n    previewCallback: (element: HTMLElement) => {\n      // URL of image to display during drag operation\n      return new URL(element.src);\n    },\n    completionCallback: async (element: HTMLElement) => {\n      // Return the converted PDF blob with source mime type information\n      return [{\n        blob: convertedPdfBlob,\n        attributes: {\n          title: "Converted Document",\n          sourceMimeType: originalMimeType // "docx" or "gdoc"\n        }\n      }];\n    },\n  };\n\n  addOnUISdk.app.enableDragToDocument(element, dragCallbacks);\n}\n')),(0,d.mdx)("h2",{id:"best-practices-and-limitations"},"Best Practices and Limitations"),(0,d.mdx)("p",null,"If the content being dragged is an animated GIF, it will be added as an animated GIF to the document, as long as it fits ",(0,d.mdx)("a",{parentName:"p",href:"https://helpx.adobe.com/express/create-and-edit-videos/change-file-formats/import-gif-limits.html"},"the size criteria for animated GIF's"),". In the event that it doesn't fit the size criteria, an error toast will be shown to the user."),(0,d.mdx)("p",null,"Since the Add-on SDK uses pointer event handlers to perform drag operations, you should ensure that you don't attach any pointer event handlers that prevent default or stop propagation. Adding those types of handlers will kill the built-in handlers and cause the events not to work."),(0,d.mdx)("p",null,"You should not attach ",(0,d.mdx)("inlineCode",{parentName:"p"},"click")," event listeners to drag-enabled elements in the capture phase, as the Add-on SDK attaches a ",(0,d.mdx)("inlineCode",{parentName:"p"},"cancelClickEvent")," handler to drag-enabled elements to ensure that the automatic click (pointer down + pointer up automatically fires a click event) doesn't fire. Adding other handlers to this same element will trigger them on drag & drop completion."),(0,d.mdx)(m,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"Use Chrome devTools to check the handlers attached to the element and its ancestors to identify any that may be causing conflicts with drag and drop handlers."),(0,d.mdx)("p",null,"There are several ",(0,d.mdx)("a",{parentName:"p",href:"../samples.md"},"code samples")," that implement drag and drop, including the ",(0,d.mdx)("a",{parentName:"p",href:"../samples.md#import-images-using-oauth"},"import-images-using-oauth")," and ",(0,d.mdx)("a",{parentName:"p",href:"../samples.md#pix"},"pix")," projects that you can reference."),(0,d.mdx)("h2",{id:"faqs"},"FAQs"),(0,d.mdx)("h4",{id:"q-how-do-i-enable-drag-and-drop-for-an-element"},"Q: How do I enable drag-and-drop for an element?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Call ",(0,d.mdx)("inlineCode",{parentName:"p"},"addOnUISdk.app.enableDragToDocument(element, callbacks)")," with preview and completion callbacks."),(0,d.mdx)("h4",{id:"q-what-callbacks-are-required"},"Q: What callbacks are required?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Provide ",(0,d.mdx)("inlineCode",{parentName:"p"},"previewCallback()")," for preview URL and ",(0,d.mdx)("inlineCode",{parentName:"p"},"completionCallback()")," to return the blob for insertion."),(0,d.mdx)("h4",{id:"q-how-do-i-handle-drag-events"},"Q: How do I handle drag events?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Listen for ",(0,d.mdx)("inlineCode",{parentName:"p"},'"dragstart"')," and ",(0,d.mdx)("inlineCode",{parentName:"p"},'"dragend"')," events using ",(0,d.mdx)("inlineCode",{parentName:"p"},"addOnUISdk.app.on()"),"."),(0,d.mdx)("h4",{id:"q-whats-special-about-audio-content"},"Q: What's special about audio content?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Audio requires an ",(0,d.mdx)("inlineCode",{parentName:"p"},"attributes")," object with a ",(0,d.mdx)("inlineCode",{parentName:"p"},"title")," property in the completion callback return."),(0,d.mdx)("h4",{id:"q-can-i-drag-remote-images"},"Q: Can I drag remote images?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Yes, fetch the remote URL in the completion callback and return the blob."),(0,d.mdx)("h4",{id:"q-how-do-i-use-sourcemimetype-when-dragging-converted-documents"},"Q: How do I use sourceMimeType when dragging converted documents?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Add ",(0,d.mdx)("inlineCode",{parentName:"p"},"sourceMimeType"),' to the attributes object in completionCallback to show "Import a document" instead of "Import a PDF" in the consent dialog.'),(0,d.mdx)("h4",{id:"q-when-should-i-include-sourcemimetype-in-drag-operations"},"Q: When should I include sourceMimeType in drag operations?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Use it when dragging PDFs that were converted from other document types like Word (.docx) or Google Docs (.gdoc) to provide clearer user messaging."),(0,d.mdx)("h4",{id:"q-what-sourcemimetype-values-work-for-drag-and-drop"},"Q: What sourceMimeType values work for drag and drop?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:"),' Common values include "docx" for Word documents and "gdoc" for Google Docs. Use the original document format before PDF conversion.'),(0,d.mdx)("h4",{id:"q-what-event-handlers-should-i-avoid"},"Q: What event handlers should I avoid?"),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"A:")," Avoid pointer event handlers that prevent default or stop propagation on drag-enabled elements."))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-learn-how-to-drag-and-drop-md-ba1f885050cd32ddfbba.js.map