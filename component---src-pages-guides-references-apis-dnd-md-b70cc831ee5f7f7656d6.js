"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[1956],{21069:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return i},default:function(){return h}});var a=t(87462),o=t(63366),r=(t(15007),t(64983)),l=t(91515),d=["components"],i={},s=function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",n)}},m=s("CodeBlock"),c=s("InlineAlert"),p={_frontmatter:i},g=l.Z;function h(e){var n=e.components,t=(0,o.Z)(e,d);return(0,r.mdx)(g,(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"drag-and-drop"},"Drag and Drop"),(0,r.mdx)("p",null,"The interfaces and methods outlined here support the add-on Drag and Drop functionality. See the example code for how to implement it in your own add-on."),(0,r.mdx)(m,{slots:"heading, code",repeat:"2",languages:"JavaScript",mdxType:"CodeBlock"}),(0,r.mdx)("h3",{id:"interface"},"Interface"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-js"},'interface DragCompletionData {\n  /**\n   * Blob (image/video) to be added to the document\n   */\n  blob: Blob;\n}\n\n/**\n * Callback to provide the preview image\n * @returns URL or DataURL\n **/\ntype DragPreviewCallback = (element: HTMLElement) => URL;\n\n/**\n * Callback to provide the content (image/video) to be added to the document\n **/\ntype DragCompletionCallback = (\n  element: HTMLElement\n) => Promise<DragCompletionData[]>;\n\ninterface DragCallbacks {\n  /**\n   * Callback to provide the preview image\n   */\n  previewCallback: DragPreviewCallback;\n\n  /**\n   * Callback to provide the content to be added to the document\n   */\n  completionCallback: DragCompletionCallback;\n}\n\ninterface Application {\n  /**\n   * Enable drag to document functionality for an element\n   */\n  enableDragToDocument(\n    element: HTMLElement,\n    dragCallbacks: DragCallbacks\n  ): void;\n}\n\n/**\n * "dragstart" event is triggered when the user starts dragging an item for which drag behavior is enabled\n *\n * "dragend" event is triggered when the drag operation ends\n */\n\ninterface DragStartEventData {\n  /**\n   * Element for which the drag event started\n   */\n  element: HTMLElement;\n}\n\ninterface DragEndEventData {\n  /**\n   * Drop occurred/Drag ended at invalid position\n   */\n  dropCancelled: boolean;\n\n  /**\n   * Element for which the drag event ended\n   */\n  element: HTMLElement;\n}\n')),(0,r.mdx)("h3",{id:"example"},"Example"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-js"},'import AddOnSdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\n// Enable drag support for an element\nfunction makeDraggableUsingUrl(elementId: string, previewUrl: string) {\n  const image = document.getElementById(elementId);\n\n  const dragCallbacks = {\n    previewCallback: (image: HTMLElement) => {\n      return new URL(previewUrl);\n    },\n    completionCallback: async (image: HTMLElement) => {\n      const imageBlob = await fetch(image.src).then((response) =>\n        response.blob()\n      );\n      return [{ blob: imageBlob }];\n    },\n  };\n\n  try {\n    AddOnSdk.app.enableDragToDocument(image, dragCallbacks);\n  } catch (error) {\n    console.log("Failed to enable DragToDocument:", error);\n  }\n}\n\nAddOnSdk.app.on("dragstart", (eventData: DragStartEventData) => {\n  console.log("The drag event has started for", eventData.element);\n});\n\nAddOnSdk.app.on("dragend", (eventData: DragEndEventData) => {\n  if (!eventData.dropCancelled) {\n    console.log("The drag event has ended for", eventData.element);\n  } else {\n    console.log("The drag event was cancelled for", eventData.element);\n  }\n});\n')),(0,r.mdx)(c,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Do not attach pointer event handlers that prevent default/stop propagation, since pointer event handlers are being used to perform drag operations, and adding these handlers will kill the handlers in useand cause the events to not work."),(0,r.mdx)("li",{parentName:"ul"},"Do not attach click event listeners to drag enabled elements in the capture phase since the SDK attaches a click cancel event handler to drag-enabled elements to ensure that the automatic click (pointer down + pointer up automatically fires a click event) does not fire and adding other handlers to this same element will cause them to be triggered on drag & drop completion"),(0,r.mdx)("li",{parentName:"ul"},"The maximum dimension of an object dropped on to the canvas in Express is 8000x8000. ")),(0,r.mdx)(c,{slots:"text",variant:"success",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"TIP:")," To check if any attached ",(0,r.mdx)("inlineCode",{parentName:"p"},"eventListeners")," are causing conflicts with Drag & Drop handlers, please inspect the drag-enabled element in chrome devTools and check handlers attached to the element and its ancestors to identify the ones causing this issue."),(0,r.mdx)("p",null,"Many of the samples we've included in the ",(0,r.mdx)("a",{parentName:"p",href:"guides/develop/samples"},"code samples")," implement the Drag and Drop APIs, so please use them as a reference. This includes the the ",(0,r.mdx)("strong",{parentName:"p"},"import-images-from-local"),", ",(0,r.mdx)("strong",{parentName:"p"},"import-images-using-oauth"),", ",(0,r.mdx)("strong",{parentName:"p"},"giphy")," and ",(0,r.mdx)("strong",{parentName:"p"},"qrcode")," samples."))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-references-apis-dnd-md-b70cc831ee5f7f7656d6.js.map