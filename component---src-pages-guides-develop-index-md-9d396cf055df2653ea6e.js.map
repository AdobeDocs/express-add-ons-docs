{"version":3,"file":"component---src-pages-guides-develop-index-md-9d396cf055df2653ea6e.js","mappings":"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","sources":["webpack://dev-site-documentation-template/./src/pages/guides/develop/index.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/express-add-ons-docs/express-add-ons-docs/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <InlineAlert slots=\"text\" variant=\"info\" mdxType=\"InlineAlert\" />\n    <p>{`Preview Adobe Express add-on SDK documentation while you wait to `}<a parentName=\"p\" {...{\n        \"href\": \"https://adobe.com/go/express-developer\"\n      }}>{`join our private beta`}</a>{`.`}</p>\n    <h1 {...{\n      \"id\": \"implementing-common-use-cases\"\n    }}>{`Implementing Common Use Cases`}</h1>\n    <p>{`If you're looking to explore and discover the capabilities of our add-ons platform, check out these common use cases and accompanying code snippets to help you get started with our add-on SDK. For more extensive usage examples, check out this set of `}<a parentName=\"p\" {...{\n        \"href\": \"samples.md\"\n      }}>{`code samples`}</a>{`.`}</p>\n    <h2 {...{\n      \"id\": \"importing-content\"\n    }}>{`Importing Content`}</h2>\n    <p>{`Importing content into a design is one of the most popular use cases. For instance, to add content retrieved from a third-party service or directly from the local hard drive. You can use the following examples to help you implement this feature in your add-on. The first function shows how to implement adding an image directly from a `}<inlineCode parentName=\"p\">{`blob`}</inlineCode>{` object, and the second shows how to implement it by fetching an image via a URL first. To implement the feature of importing content into a design in your add-on, you can use the following examples:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n\n// Reference to the active document\nconst { document } = AddOnSdk.app;\n\n// Add image via blob to the current page\nasync function addImageFromBlob(blob) {\n  try {\n    await document.addImage(blob);\n  } catch (error) {\n    console.log(\"Failed to add the image to the page.\");\n  }\n}\n\n// Add image via url to the current page\nasync function addImageFromURL(url) {\n  try {\n    const blob = await fetch(url).then((response) => response.blob());\n    await document.addImage(blob);\n  } catch (error) {\n    console.log(\"Failed to add the image to the page.\");\n  }\n}\n`}</code></pre>\n    <InlineAlert slots=\"text\" variant=\"info\" mdxType=\"InlineAlert\" />\n    <p>{`The supported file types for imported content are currently `}<strong parentName=\"p\"><inlineCode parentName=\"strong\">{`png/jpg/mp4`}</inlineCode>{`,`}</strong>{` and the size of the imported images should not exceed `}<strong parentName=\"p\">{`8000px`}</strong>{` or `}<strong parentName=\"p\">{`40MB`}</strong>{`.`}</p>\n    <h2 {...{\n      \"id\": \"exporting-content\"\n    }}>{`Exporting Content`}</h2>\n    <p>{`Another popular feature available for use in your add-on is the ability to export content. For instance, if you want to to allow the user to save/download the current design (or range of a design) with certain export configurations to their local hard drive. `}</p>\n    <p>{`The steps to export content:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Call `}<inlineCode parentName=\"li\">{`createRenditions()`}</inlineCode>{` to get the renditions based on your export configuration options. `}</li>\n      <li parentName=\"ul\">{`Convert the blob object returned in the response to a string with the `}<inlineCode parentName=\"li\">{`URL.createObjectURL(blob)`}</inlineCode>{` method.`}</li>\n      <li parentName=\"ul\">{`Create/update an anchor `}<inlineCode parentName=\"li\">{`<a>`}</inlineCode>{` element's `}<inlineCode parentName=\"li\">{`href`}</inlineCode>{` value with the URL string from the above step.`}</li>\n    </ul>\n    <InlineAlert slots=\"text\" variant=\"info\" mdxType=\"InlineAlert\" />\n    <p>{`Each page of your design is considered a single rendition. See the `}<a parentName=\"p\" {...{\n        \"href\": \"../../references/addonsdk/app-document.md\"\n      }}>{`SDK references`}</a>{` for additional rendition options and values):`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n\nconst response = await AddOnSdk.app.document.createRenditions({\n    range: \"currentPage\",\n    format: \"image/jpeg\",\n});\n\nconst downloadUrl = URL.createObjectURL(response[0].blob);\ndocument.getElementById(\"anchor\").href = downloadUrl; \n\n<a href=\"#\" download=\"download\" id=\"anchor\" style=\"text-decoration: none\">\n  <sp-button id=\"download-button\" style=\"display: none\">Download</sp-button>\n</a>\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"authenticating-with-oauth-20\"\n    }}>{`Authenticating with OAuth 2.0`}</h2>\n    <p>{`This recipe focuses on providing an authentication feature that allows a user to login to one of their existing services with OAuth 2.0. A typical use case would be to use assets you have stored in another service. `}</p>\n    <h3 {...{\n      \"id\": \"setup\"\n    }}>{`Setup`}</h3>\n    <p>{`The OAuth APIs can be used to obtain the authorization \"code\" from any OAuth 2.0 provider supporting the Code Exchange authorization workflow. You will need to go through some set up steps through the provider you want to use OAuth with first. Here are the steps to get started:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Log in to the OAuth provider's website and create an application (for example, Dropbox). This must be a web application, and if an option of SPA (Single Page Application) is listed, select it.`}</li>\n      <li parentName=\"ol\">{`As an input to the \"Redirect URIs\" field, add: `}<a parentName=\"li\" {...{\n          \"href\": \"https://new.express.adobe.com/static/oauth-redirect.html\"\n        }}>{`https://new.express.adobe.com/static/oauth-redirect.html`}</a>{`.`}</li>\n      <li parentName=\"ol\">{`Fill out other details as necessary and save the form. A client Id / application Id / application key (this differs on different OAuth providers) will be generated. Make note of it as you will need it in your add-on code.`}</li>\n      <li parentName=\"ol\">{`Next, update your add-on `}<inlineCode parentName=\"li\">{`manifest.json`}</inlineCode>{` file with the hostname of the OAuth provider's authorization URL. `}<strong parentName=\"li\">{`NOTE:`}</strong>{` When using multiple providers, all hostnames must be provided. For example, if the add-on uses two OAuth providers (\"login.microsoftonline.com\" and \"`}<a parentName=\"li\" {...{\n          \"href\": \"http://www.dropbox.com%22\"\n        }}>{`www.dropbox.com\"`}</a>{`), the `}<inlineCode parentName=\"li\">{`manifest.json`}</inlineCode>{` should contain both of them, as shown below:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n    \"id\": \"<ADD_ON_ID>\",\n    \"name\": \"<ADD_ON_NAME>\",\n    \"version\": \"1.0.0\",\n    \"manifestVersion\": 1,\n    \"requirements\": {\n        \"apps\": [\"Express\"]\n    },\n    \"entryPoints\": [\n        {\n            \"type\": \"panel\",\n            \"id\": \"panel1\",\n            \"label\": {\n                \"default\": \"<ADD_ON_LABEL>\"\n            },\n            \"main\": \"index.html\",\n            \"permissions\": {\n                \"oauth\": [\"login.microsoftonline.com\", \"www.dropbox.com\"]\n            }\n        }\n    ]\n}\n`}</code></pre>\n    <p>{`Once you complete the set up, you can use the following code snippet as an example of how to perform the OAuth exchange to retrieve an access token. The `}<a parentName=\"p\" {...{\n        \"href\": \"../../samples.md\"\n      }}>{`code samples`}</a>{` repo also contain a few different examples of using OAuth 2.0 that we highly recommend checking out. You will also find the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/AdobeDocs/express-add-on-samples/blob/main/samples/import-images-using-oauth/src/utils/OAuthUtils.js\"\n      }}>{`OAuthUtils.js`}</a>{` module there, which is referenced below, and we recommend using to help with your own OAuth implementation.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n \nconst DROPBOX_AUTHORIZATION_URL = \"https://www.dropbox.com/oauth2/authorize\";\nconst DROPBOX_TOKEN_URL = \"https://api.dropboxapi.com/oauth2/token\";\nconst DROPBOX_CLIENT_ID = \"<DROPBOX_CLIENT_ID>\";\nconst DROPBOX_SCOPE = \"<DROPBOX_SPACE_SEPARATED_SCOPES>\";\n \nconst ONEDRIVE_AUTHORIZATION_URL = \"https://login.microsoftonline.com/<AZURE_AD_TENANT_ID>/oauth2/v2.0/authorize\";\nconst ONEDRIVE_TOKEN_URL = \"https://login.microsoftonline.com/<AZURE_AD_TENANT_ID>/oauth2/v2.0/token\";\nconst ONEDRIVE_CLIENT_ID = \"<ONEDRIVE_CLIENT_ID>\";\nconst ONEDRIVE_SCOPE = \"<ONEDRIVE_SPACE_SEPARATED_SCOPES>\";\nconst OWN_REDIRECT_URI = \"<OWN_REDIRECT_URI>\";\n \nAddOnSdk.ready.then(() => {\n    // 'oauthUtils' is a helper javascript module (included with the OAuth template) which provides utility functions to:\n    // 1. generateChallenge()     Generate the 'code_challenge' and 'code_verifier' parameters that are essential in the OAuth 2.0 workflow.\n    // 2. generateAccessToken()   Generate an 'access_token' and a 'refresh_token' using the 'code' and 'redirectUri' received on successful authorization.\n    // 3. getAccessToken()        Get an always valid 'access_token'.\n     \n    const challenge = await oauthUtils.generateChallenge();     \n    await authorize(challenge);         \n});\n \nfunction authorize(challenge) {\n    // Trigger the OAuth 2.0 based authorization which opens up a sign-in window for the user\n    // and returns an authorization code which can be used to obtain an access_token.\n    const { id, code, redirectUri, result } = await oauth.authorize({\n        authorizationUrl: DROPBOX_AUTHORIZATION_URL,\n        clientId: DROPBOX_CLIENT_ID,\n        scope: DROPBOX_SCOPE,\n        codeChallenge: challenge.codeChallenge\n    });\n \n    const { status, description } = result;\n    if (status !== \"SUCCESS\") {\n        throw new Error(\\`Status: \\${status} | Description: \\${description}\\`);\n    }\n \n    // Generate the access_token which can be used to verify the identity of the user and\n    // grant them access to the requested resource.\n    await oauthUtils.generateAccessToken({\n        id,\n        clientId: DROPBOX_CLIENT_ID,\n        codeVerifier: challenge.codeVerifier,\n        code,\n        tokenUrl: DROPBOX_TOKEN_URL,\n        redirectUri\n    });\n \n    const accessToken = await oauthUtils.getAccessToken(id);\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"storing-and-retrieving-client-side-data\"\n    }}>{`Storing and Retrieving Client-Side Data`}</h2>\n    <p>{`If you want to be able to store and retrieve data on the client rather than send and retrieve from a server for certain instances (ie: caching images that were fetched to decrease load times etc), you can do so using the add-on `}<inlineCode parentName=\"p\">{`clientStorage`}</inlineCode>{` API. `}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n\nlet store;\n\nAddOnSdk.ready.then(async () => {\n    store = AddOnSdk.instance.clientStorage;\n}\n/**\n * Store item \n */\nasync function setItem(item: string, isComplete: boolean) {\n    await store.setItem(item, isComplete);\n    todoItemInput.value = \"\";\n}\n/**\n * Log all storage item values\n */\nasync function displayAllItems() {\n    const todoItems = await store.keys();\n    todoItems.forEach(async (item: string) => {\n        const itemValue = await store.getItem(item);\n        console.log(\"Key: \" + item + \" value: \" + itemValue);\n    });\n}\n\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"drag-and-drop\"\n    }}>{`Drag and Drop`}</h2>\n    <p>{`If you want to allow a user to drag and drop items from your add-on to the document, you can use the methods provided for this in the add-on SDK. An example of this is shown below:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// Enable drag support for an element\nfunction makeDraggableUsingUrl(elementId: string, previewUrl: string) {\n  const image = document.getElementById(elementId);\n\n  const dragCallbacks = {\n    previewCallback: (image: HTMLElement) => {\n      return new URL(previewUrl);\n    },\n    completionCallback: async (image: HTMLElement) => {\n      const imageBlob = await fetch(image.src).then((response) =>\n        response.blob()\n      );\n      return [{ blob: imageBlob }];\n    },\n  };\n\n  try {\n    AddOnSdk.app.enableDragToDocument(image, dragCallbacks);\n  } catch (error) {\n    console.log(\"Failed to enable DragToDocument:\", error);\n  }\n}\n\nAddOnSdk.app.on(\"dragstart\", (eventData: DragStartEventData) => {\n  console.log(\"The drag event has started for\", eventData.element);\n});\n\nAddOnSdk.app.on(\"dragend\", (eventData: DragEndEventData) => {\n  if (!eventData.dropCancelled) {\n    console.log(\"The drag event has ended for\", eventData.element);\n  } else {\n    console.log(\"The drag event was cancelled for\", eventData.element);\n  }\n});\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"modal-dialogs\"\n    }}>{`Modal Dialogs`}</h2>\n    <p>{`When you need to pop up a dialog to show a certain message such as an informational, warning or error message, you can use a simple modal dialog to do so:`}</p>\n    <h3 {...{\n      \"id\": \"simple-modal-dialog-example\"\n    }}>{`Simple Modal Dialog Example`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n \n// Wait for the SDK to be ready\nawait AddOnSdk.ready;\n\n// Confirmation Dialog Example\nlet dialogOptions = {\n    title: titleValue,\n    description: [descValue],\n    buttonLabels: {\n        primary:\n        primaryButtonTextValue != \"\" ? primaryButtonTextValue : undefined,\n        secondary:\n        secondaryButtonTextValue != \"\"\n            ? secondaryButtonTextValue\n            : undefined,\n        cancel:\n        cancelButtonTextValue != \"\" ? cancelButtonTextValue : undefined,\n    },\n    variant: \"confirmation\",\n};\nconst response = await addOnSdk.app.showModalDialog(dialogOptions);\nconsole.log(\"Button type clicked \" + response.buttonType)\n`}</code></pre>\n    <p>{`There's also support for complex modal dialogs, like an input dialog or a custom dialog that allows you to supply custom content, but it's currently behind an experimental flag. However, below is an example of using an `}<inlineCode parentName=\"p\">{`input`}</inlineCode>{` dialog that accepts input that you can retrieve:`}</p>\n    <h3 {...{\n      \"id\": \"input-modal-dialog-example\"\n    }}>{`Input Modal Dialog Example`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n \n// Wait for the SDK to be ready\nawait AddOnSdk.ready;\n\n// Input Dialog Example \nlet inputDialogOptions = {\n    title: titleValue,\n    description: [descValue],\n    buttonLabels: {\n        primary:\n        primaryButtonTextValue != \"\" ? primaryButtonTextValue : undefined,\n        secondary:\n        secondaryButtonTextValue != \"\"\n            ? secondaryButtonTextValue\n            : undefined,\n        cancel:\n        cancelButtonTextValue != \"\" ? cancelButtonTextValue : undefined,\n    },\n    variant: \"input\",\n    field: {\n          label: labelValue,\n          placeholder: placeholderValue,\n          fieldType: \"text\",\n    },\n\n    const response = await addOnSdk.app.showModalDialog(inputDialogOptions);\n    console.log(\"Field value \" + response.fieldValue); // returns the input the user entered\n}\n};\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"custom-modal-dialog-example\"\n    }}>{`Custom Modal Dialog Example`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n \n// Wait for the SDK to be ready\nawait AddOnSdk.ready;\n \nfunction useCustomDialogResult(data: unknown) {\n  // Use the dialog data\n}\n\n// Custom Dialog\nasync function showCustomDialog() {\n  try {\n    const dialogResult = await AddOnSdk.app.showModalDialog({\n        variant: \"custom\",\n        title: \"Custom Modal\",\n        src: \"dialog.html\", // use content from this html file\n        size: { width: 600, height: 400 }\n    });\n \n    // Use data received from the custom dialog\n    useCustomDialogResult(dialogResult.result);\n \n  } catch (error) {\n    console.log(\"Error showing modal dialog:\", error);\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"detecting-theme\"\n    }}>{`Detecting Theme`}</h2>\n    <p>{`When you want to detect the theme of the environment where your add-on is running (aka: Adobe Express), or if you want to be notified if it changes, you can use the following example. This is useful for knowing what theme is currently set in Adobe Express so you can also use the same in your add-on UI, and to apply the theme change when the user changes their Adobe Express theme. Note, that currently Adobe Express only supports a \"light\" theme, though this will be changing to also support a \"dark\" theme in the future.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n\nfunction applyTheme(theme) {\n    document.querySelector(\"sp-theme\").setAttribute(\"color\", theme);\n}\napplyTheme(AddOnSdk.app.ui.theme);\nAddOnSdk.app.on(\"themechange\", (data) => { applyTheme(data.theme); });\n\naddOnSdk.app.on(\"themechange\", (data) => {\n    applyTheme(data.theme == \"dark\" ? darkTheme : lightTheme);\n});\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"detecting-locale\"\n    }}>{`Detecting Locale`}</h2>\n    <p>{`If you want to detect the current locale, or when the locale changes, for instance to set the language in your add-on, you can do so with the following code:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import AddOnSdk from \"https://new.express.adobe.com/static/add-on-sdk/sdk.js\";\n\nfunction setLanguage(language) { \n  /* Set the language in your UI strings based on the change detected */ \n}\n\nAddOnSdk.ready.then(() => {\n  console.log(AddOnSdk.app.ui.locales);\n  setLanguage(AddOnSdk.app.ui.locale);\n});\n\nAddOnSdk.app.on(\"localechange\", data => {\n  setLanguage(data.locale));\n});\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","mdx","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","_objectWithoutPropertiesLoose","_excluded","_extends","mdxType","slots","variant","parentName","isMDXComponent"],"sourceRoot":""}