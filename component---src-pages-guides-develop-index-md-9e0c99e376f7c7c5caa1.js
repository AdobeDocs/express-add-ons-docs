"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[6874],{6012:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return l},default:function(){return m}});var a,o=t(87462),r=t(63366),d=(t(15007),t(64983)),s=t(91515),i=["components"],l={},c=(a="InlineAlert",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",e)}),p={_frontmatter:l},u=s.Z;function m(e){var n=e.components,t=(0,r.Z)(e,i);return(0,d.mdx)(u,(0,o.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,d.mdx)(c,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"Preview Adobe Express add-on SDK documentation while you wait to ",(0,d.mdx)("a",{parentName:"p",href:"https://adobe.com/go/express-developer"},"join our private beta"),"."),(0,d.mdx)("h1",{id:"common-use-case-examples"},"Common Use Case Examples"),(0,d.mdx)("p",null,"This set of how to's for popular use cases will help you explore and discover the capabilities of our add-ons platform. You will find common use cases along with code snippets that you can use to quickly get started with our add-on SDK. Along with these how to's, we also provide a set of ",(0,d.mdx)("a",{parentName:"p",href:"samples.md"},"code samples")," that provide more extensive usage for each case."),(0,d.mdx)("h2",{id:"importing-content"},"Importing Content"),(0,d.mdx)("p",null,"Importing content into the document is one of the most popular use cases, since it allows a user to add content retrieved from a third-party service, or their local hard drive, directly into their designs quickly and easily. You can use this feature in your add-ons using one of the function examples below."),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'// Reference to the active document\nconst { document } = AddOnSdk.app;\n\n// Add image via blob to the current page\nasync function addImageFromBlob(blob) {\n  try {\n    await document.addImage(blob);\n  } catch (error) {\n    console.log("Failed to add the image to the page.");\n  }\n}\n\n// Add image via url to the current page\nasync function addImageFromURL(url) {\n  try {\n    const blob = await fetch(url).then((response) => response.blob());\n    await document.addImage(blob);\n  } catch (error) {\n    console.log("Failed to add the image to the page.");\n  }\n}\n')),(0,d.mdx)(c,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"The supported file types for imported content are currently ",(0,d.mdx)("strong",{parentName:"p"},(0,d.mdx)("inlineCode",{parentName:"strong"},"png/jpg/mp4"),",")," and the size of the imported images should not exceed ",(0,d.mdx)("strong",{parentName:"p"},"8000 px")," or ",(0,d.mdx)("strong",{parentName:"p"},"40 MB"),"."),(0,d.mdx)("h2",{id:"exporting-content"},"Exporting Content"),(0,d.mdx)("p",null,"Another popular feature available for use in your add-on is the ability to export content. For instance, if you want to to allow the user to save/download the current design (or range of a design) with certain export configurations to their local hard drive. "),(0,d.mdx)("p",null,"The steps to export content:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},"Call ",(0,d.mdx)("inlineCode",{parentName:"li"},"createRenditions()")," to get the renditions based on your export configuration options. "),(0,d.mdx)("li",{parentName:"ul"},"Convert the blob object returned in the response to a string with the ",(0,d.mdx)("inlineCode",{parentName:"li"},"URL.createObjectURL(blob)")," method."),(0,d.mdx)("li",{parentName:"ul"},"Create/update an anchor ",(0,d.mdx)("inlineCode",{parentName:"li"},"<a>")," element's ",(0,d.mdx)("inlineCode",{parentName:"li"},"href")," value with the URL string from the above step.")),(0,d.mdx)(c,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"Each page of your design is considered a single rendition. see the ",(0,d.mdx)("a",{parentName:"p",href:"../../references/addonsdk/app-document.md"},"SDK references")," for additional rendition options and values):"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'const response = await AddOnSdk.app.document.createRenditions({\n    range: "currentPage",\n    format: "image/jpeg",\n});\n\nconst downloadUrl = URL.createObjectURL(response[0].blob);\ndocument.getElementById("anchor").href = downloadUrl; \n\n<a href="#" download="download" id="anchor" style="text-decoration: none">\n  <sp-button id="download-button" style="display: none">Download</sp-button>\n</a>\n')),(0,d.mdx)("h2",{id:"authenticating-with-oauth-20"},"Authenticating with OAuth 2.0"),(0,d.mdx)("p",null,"This recipe focuses on providing an authentication feature that allows a user to login to one of their existing services with OAuth 2.0. A typical use case would be to use assets you have stored in another service. The login makes it much easier to offer the users their assets directly after login without having to switch browser windows to login to their other service and download their asset, only to have to upload it again back in Adobe Express. "),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'const Connection = ({ accessToken, updateAccessToken }) => {  \n  async function handleConnect() {\n    // Generate the cryptographic challenge parameters\n    // required in the OAuth 2.0 authorization workflow.\n    const challenge = await oauthUtils.generateChallenge();\n\n    // Trigger the OAuth 2.0 based authorization which opens up a sign-in window for the user\n    // and returns an authorization code which can be used to obtain an access_token.\n    const { id, code, redirectUri, result } = await addOnSdk.app.oauth.authorize({\n        authorizationUrl: AUTHORIZATION_URL,\n        clientId: CLIENT_ID,\n        scope: SCOPE,\n        codeChallenge: challenge.codeChallenge\n    });\n\n    const { status, description } = result;\n    if (status !== "SUCCESS") {\n        setLoading(false);\n        console.error(`Failed to authorize. Status: ${status} | Description: ${description}`);\n        return;\n    }\n\n    // Generate the access_token which can be used to verify the identity of the user and\n    // grant them access to the requested resource.\n    await oauthUtils.generateAccessToken({\n        id,\n        clientId: CLIENT_ID,\n        codeVerifier: challenge.codeVerifier,\n        code,\n        tokenUrl: TOKEN_URL,\n        redirectUri\n    });\n\n    // Get the generated access_token.\n    const newAccessToken = await oauthUtils.getAccessToken(id);   \n    updateAccessToken(newAccessToken);\n  }\n}\n')),(0,d.mdx)("p",null,"Now retrieve assets with the token saved in the above:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'// Use the access_token to retrieve assets\nasync function getAssets(path) {\n    const data = { path };\n    const options = {\n        method: "POST",\n        headers: {\n            Authorization: `Bearer ${accessToken}`,\n            "Content-Type": "application/json"\n        },\n        body: JSON.stringify(data)\n    };\n\n    const response = await fetch(LIST_FOLDER_API_URL, options);\n    const assets = await response.json();\n    if (!response.ok) {\n        const error = assets.error\n            ? assets.error.message\n            : "Unexpected error occurred while fetching assets.";\n\n        throw new Error(error);\n    }\n\n    return assets;\n  }\n}\n')),(0,d.mdx)("h2",{id:"storing-and-retrieving-client-side-data"},"Storing and Retrieving Client-Side Data"),(0,d.mdx)("p",null,"If you want to be able to store and retrieve data on the client rather than send and retrieve from a server for certain instances (ie: caching images that were fetched to decrease load times etc), you can do so using the add-on ",(0,d.mdx)("inlineCode",{parentName:"p"},"clientStorage")," API. "),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import AddOnSdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nlet store;\n\nAddOnSdk.ready.then(async () => {\n    store = AddOnSdk.instance.clientStorage;\n}\n/**\n * Store item \n */\nasync function setItem(item: string, isComplete: boolean) {\n    await store.setItem(item, isComplete);\n    todoItemInput.value = "";\n}\n/**\n * Log all storage item values\n */\nasync function displayAllItems() {\n    const todoItems = await store.keys();\n    todoItems.forEach(async (item: string) => {\n        const itemValue = await store.getItem(item);\n        console.log("Key: " + item + " value: " + itemValue);\n    });\n}\n\n')),(0,d.mdx)("h2",{id:"drag-and-drop"},"Drag and Drop"),(0,d.mdx)("p",null,"If you want to allow a user to drag and drop items from your add-on to the document, you can use the methods provided for this in the add-on SDK. An example of this is shown below:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'// Enable drag support for an element\nfunction makeDraggableUsingUrl(elementId: string, previewUrl: string) {\n  const image = document.getElementById(elementId);\n\n  const dragCallbacks = {\n    previewCallback: (image: HTMLElement) => {\n      return new URL(previewUrl);\n    },\n    completionCallback: async (image: HTMLElement) => {\n      const imageBlob = await fetch(image.src).then((response) =>\n        response.blob()\n      );\n      return [{ blob: imageBlob }];\n    },\n  };\n\n  try {\n    AddOnSdk.app.enableDragToDocument(image, dragCallbacks);\n  } catch (error) {\n    console.log("Failed to enable DragToDocument:", error);\n  }\n}\n\nAddOnSdk.app.on("dragstart", (eventData: DragStartEventData) => {\n  console.log("The drag event has started for", eventData.element);\n});\n\nAddOnSdk.app.on("dragend", (eventData: DragEndEventData) => {\n  if (!eventData.dropCancelled) {\n    console.log("The drag event has ended for", eventData.element);\n  } else {\n    console.log("The drag event was cancelled for", eventData.element);\n  }\n});\n')),(0,d.mdx)("h2",{id:"modal-dialogs"},"Modal Dialogs"),(0,d.mdx)("p",null,"When you need to pop up a dialog to show a certain message such as an informational, warning or error message, you can use a simple modal dialog to do so:"),(0,d.mdx)("h3",{id:"simple-modal-dialog-example"},"Simple Modal Dialog Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import AddOnSdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \n// Wait for the SDK to be ready\nawait AddOnSDKAPI.ready;\n\n// Confirmation Dialog Example\nlet dialogOptions = {\n    title: titleValue,\n    description: [descValue],\n    buttonLabels: {\n        primary:\n        primaryButtonTextValue != "" ? primaryButtonTextValue : undefined,\n        secondary:\n        secondaryButtonTextValue != ""\n            ? secondaryButtonTextValue\n            : undefined,\n        cancel:\n        cancelButtonTextValue != "" ? cancelButtonTextValue : undefined,\n    },\n    variant: "confirmation",\n};\nconst response = await addOnSdk.app.showModalDialog(dialogOptions);\nconsole.log("Button type clicked " + response.buttonType)\n')),(0,d.mdx)("p",null,"There's also support for complex modal dialogs, like an input dialog or a custom dialog that allows you to supply custom content, but it's currently behind an experimental flag. However, below is an example of using an ",(0,d.mdx)("inlineCode",{parentName:"p"},"input")," dialog that accepts input that you can retrieve:"),(0,d.mdx)("h3",{id:"input-modal-dialog-example"},"Input Modal Dialog Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import AddOnSdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \n// Wait for the SDK to be ready\nawait AddOnSDKAPI.ready;\n\n// Input Dialog Example \nlet inputDialogOptions = {\n    title: titleValue,\n    description: [descValue],\n    buttonLabels: {\n        primary:\n        primaryButtonTextValue != "" ? primaryButtonTextValue : undefined,\n        secondary:\n        secondaryButtonTextValue != ""\n            ? secondaryButtonTextValue\n            : undefined,\n        cancel:\n        cancelButtonTextValue != "" ? cancelButtonTextValue : undefined,\n    },\n    variant: "input",\n    field: {\n          label: labelValue,\n          placeholder: placeholderValue,\n          fieldType: "text",\n    },\n\n    const response = await addOnSdk.app.showModalDialog(inputDialogOptions);\n    console.log("Field value " + response.fieldValue); // returns the input the user entered\n}\n};\n')),(0,d.mdx)("h3",{id:"custom-modal-dialog-example"},"Custom Modal Dialog Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import AddOnSdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \n// Wait for the SDK to be ready\nawait AddOnSDKAPI.ready;\n \nfunction useCustomDialogResult(data: unknown) {\n  // Use the dialog data\n}\n\n// Custom Dialog\nasync function showCustomDialog() {\n  try {\n    const dialogResult = await AddOnSDKAPI.app.showModalDialog({\n        variant: Variant.custom,\n        title: "WiX",\n        src: "dialog.html",\n        size: { width: 600, height: 400 }\n    });\n \n    // Use data received from the custom dialog\n    useCustomDialogResult(dialogResult.result);\n \n  } catch (error) {\n    console.log("Error showing modal dialog:", error);\n  }\n}\n')),(0,d.mdx)("h2",{id:"detecting-theme"},"Detecting Theme"),(0,d.mdx)("p",null,'When you want to detect the theme of the environment where your add-on is running (aka: Adobe Express), or if you want to be notified if it changes, you can use the following example. This is useful for knowing what theme is currently set in Adobe Express so you can also use the same in your add-on UI, and to apply the theme change when the user changes their Adobe Express theme. Note, that currently Adobe Express only supports a "light" theme, though this will be changing to also support a "dark" theme in the future.'),(0,d.mdx)("p",null,(0,d.mdx)("inlineCode",{parentName:"p"},"AddOnSdk.app.on.themechange")),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'function applyTheme(theme) {\n    document.querySelector("sp-theme").setAttribute("color", theme);\n}\napplyTheme(AddOnSdk.app.ui.theme);\nAddOnSdk.app.on("themechange", (data) => { applyTheme(data.theme); });\n\naddOnSdk.app.on("themechange", (data) => {\n    applyTheme(data.theme == "dark" ? darkTheme : lightTheme);\n});\n')),(0,d.mdx)("h2",{id:"detecting-locale"},"Detecting Locale"),(0,d.mdx)("p",null,"If you want to detect the current locale, or when the locale changes, for instance to set the language in your add-on, you can do so with the following code:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'AddOnSdk.app.ui.locales\nAddOnSdk.app.ui.locale\n\nAddOnSdk.app.on("localechange", data => {\n  setLanguage(data.locale);\n});\n')))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-develop-index-md-9e0c99e376f7c7c5caa1.js.map