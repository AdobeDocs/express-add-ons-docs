{"version":3,"file":"component---src-pages-guides-learn-how-to-tutorials-stats-addon-md-546597097516326d9a67.js","mappings":"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","sources":["webpack://dev-site-documentation-template/./src/pages/guides/learn/how_to/tutorials/stats-addon.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/github/workspace/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst ListBlock = makeShortcode(\"ListBlock\");\nconst CodeBlock = makeShortcode(\"CodeBlock\");\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"creating-a-document-stats-add-on-with-the-adobe-express-communication-api\"\n    }}>{`Creating a Document Stats add-on with the Adobe Express Communication API`}</h1>\n    <p>{`In this tutorial, we'll build an Adobe Express add-on that gathers statistics on the active document using the Communication API.`}</p>\n    <h2 {...{\n      \"id\": \"introduction\"\n    }}>{`Introduction`}</h2>\n    <p>{`Hello, and welcome to this Adobe Express Communication API tutorial, where we'll build together a `}<strong parentName=\"p\">{`fully functional Stats add-on`}</strong>{` from scratch. This add-on will retrieve metadata from the currently open Adobe Express document, such as pages and their size, plus information about the kind and number of any element used.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"58.4375%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/5530d/stats-addon.webp 320w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/0c8fb/stats-addon.webp 640w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/94b1e/stats-addon.webp 1280w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/0b34d/stats-addon.webp 1920w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/9df40/stats-addon.webp 2218w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/dd4a7/stats-addon.png 320w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/0f09e/stats-addon.png 640w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/bbbf7/stats-addon.png 1280w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/ac7a9/stats-addon.png 1920w\", \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/40851/stats-addon.png 2218w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/7aab0ee44dcf95632a5fc076a9219302/bbbf7/stats-addon.png\",\n            \"alt\": \"stats addon\",\n            \"title\": \"stats addon\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h3 {...{\n      \"id\": \"timestamp\"\n    }}>{`Timestamp`}</h3>\n    <p>{`This tutorial has been written by Davide Barranca, software developer and author from Italy. It's been first published on December 14th, 2023.`}</p>\n    <h3 {...{\n      \"id\": \"prerequisites\"\n    }}>{`Prerequisites`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`Familiarity with HTML, CSS, JavaScript.`}</li>\n      <li parentName=\"ul\">{`Familiarity with the Adobe Express add-ons environment; if you need a refresher, follow the `}<a parentName=\"li\" {...{\n          \"href\": \"../../../getting_started/hello-world.md\"\n        }}>{`quickstart`}</a>{` guide.`}</li>\n      <li parentName=\"ul\">{`Familiarity with the Adobe Express Document API, covered in `}<a parentName=\"li\" {...{\n          \"href\": \"../tutorials/grids-addon.md\"\n        }}>{`this tutorial`}</a>{`.`}</li>\n      <li parentName=\"ul\">{`An Adobe Express account; use your existing Adobe ID or create one for free.`}</li>\n      <li parentName=\"ul\">{`Node.js version 16 or newer.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"topics-covered\"\n    }}>{`Topics Covered`}</h3>\n    {/* List block here */}\n    <ListBlock slots=\"text1, text2\" repeat=\"2\" iconColor=\"#2ac3a2\" icon=\"disc\" variant=\"fullWidth\" mdxType=\"ListBlock\" />\n    <p><a parentName=\"p\" {...{\n        \"href\": \"#proxy-api\"\n      }}>{`Invoking Document Model Sandbox methods from the UI iframe`}</a></p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"#logic\"\n      }}>{`Invoking UI iframe methods from the Document Model Sandbox`}</a></p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"#proxy-api\"\n      }}>{`Proxy API`}</a></p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"#functions\"\n      }}>{`Context Closures`}</a></p>\n    <p><img parentName=\"p\" {...{\n        \"src\": \"/express-add-ons-docs/assets/0bd437229c8ac38756f7e599371074bd/stats-addon-animation.gif\",\n        \"alt\": null\n      }}></img></p>\n    <h2 {...{\n      \"id\": \"getting-started-with-the-communication-api\"\n    }}>{`Getting Started with the Communication API`}</h2>\n    <p>{`As we've seen in the previous Adobe Express `}<a parentName=\"p\" {...{\n        \"href\": \"grids-addon.md\"\n      }}>{`Document API tutorial`}</a>{`, add-ons belong to the `}<strong parentName=\"p\">{`UI iframe`}</strong>{`: a sandboxed environment subject to `}<a parentName=\"p\" {...{\n        \"href\": \"../../platform_concepts/context.md#cors\"\n      }}>{`CORS policies`}</a>{`, where the User Interface (UI) and the add-on logic are built. The iframe itself has limited editing capabilities, though: via the `}<inlineCode parentName=\"p\">{`addOnUISdk`}</inlineCode>{` module, it can invoke a few methods to import media (image, video, and audio) and export the document into a number of formats, like `}<inlineCode parentName=\"p\">{`.pdf`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`.mp4`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`.jpg`}</inlineCode>{` for example.`}</p>\n    <p>{`The `}<strong parentName=\"p\">{`Document API`}</strong>{` makes new, more powerful capabilities available, allowing the add-on to manipulate elements directly—like scripting in Desktop applications such as Photoshop or InDesign. This API is one component of the Document Sandbox, a JavaScript execution environment that also includes a restricted set of Web API (mostly debugging aids) as well as the means for the UI iframe and the Document API to exchange messages—the Communication API. This infrastructure is paramount as it bridges the gap between the two environments, allowing them to create a seamless experience.`}</p>\n    <h3 {...{\n      \"id\": \"proxies\"\n    }}>{`Proxies`}</h3>\n    <p>{`How does this all work, then? The process involves exposing proxies for the `}<em parentName=\"p\">{`other context`}</em>{` to use, serving as a user-friendly abstraction; under the hood, the implementation relies on a messaging system, which is hidden to us developers.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// runtime in the UI iframe\nimport addOnUISdk from \"https://express.adobe.com/static/add-on-sdk/sdk.js\";\nconst { runtime } = addOnUISdk.instance;\n\n// runtime in the Document Sandbox\nimport addOnSandboxSdk from \"add-on-sdk-document-sandbox\";\nconst { runtime } = addOnSandboxSdk.instance;\n`}</code></pre>\n    <p>{`The `}<inlineCode parentName=\"p\">{`runtime`}</inlineCode>{` object uses the `}<inlineCode parentName=\"p\">{`exposeApi()`}</inlineCode>{`to make content available to the other context—it works the same, regardless of whether the subject is the iframe or the Document Sandbox.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// 👇 both in the UI frame and the Document Sandbox\nruntime.exposeApi({\n  /* ... */\n}); // exposing a payload {}\n`}</code></pre>\n    <p>{`We'll get to the details of such a payload in a short while; for the moment, think about it as a collection of methods acting on their environment (UI iframe or Document Sandbox). There needs to be more than exposing, though: some action is required `}<em parentName=\"p\">{`on the other side`}</em>{` to surface such a payload—it involves using the `}<inlineCode parentName=\"p\">{`apiProxy()`}</inlineCode>{` method documented `}<a parentName=\"p\" {...{\n        \"href\": \"/express-add-ons-docs/references/addonsdk/instance-runtime/\"\n      }}>{`here`}</a>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// UI iframe, importing a payload from the Document Sandbox\nconst sandboxProxy = await runtime.apiProxy(\"documentSandbox\");\n\n// Document Sandbox, importing a payload from the UI iframe\nconst panelUIProxy = await runtime.apiProxy(\"panel\");\n`}</code></pre>\n    <p>{`At this point, `}<inlineCode parentName=\"p\">{`sandboxProxy`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`panelUIProxy`}</inlineCode>{` represent their counterparts from the original contexts. It all may be easier to understand when the entire process is written down; for example, in the following code, we expose a custom method called `}<inlineCode parentName=\"p\">{`ready()`}</inlineCode>{` defined in the UI iframe to the Document API.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"2\" languages=\"UI iframe, Document Sandbox\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"ui-iframe\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnUISdk from \"https://express.adobe.com/static/add-on-sdk/sdk.js\";\nconst { runtime } = addOnUISdk.instance;\n\n// exporting a payload to the Document Sandbox\nruntime.exposeApi({\n  ready: (env) => {\n    console.log(\\`The \\${env} environment is ready\\`);\n  },\n});\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnSandboxSdk from \"add-on-sdk-document-sandbox\";\nconst { runtime } = addOnSandboxSdk.instance;\n\n// importing from the iframe\nconst panelUIProxy = await runtime.apiProxy(\"panel\");\n\n// We can call this method now\nawait panelUIProxy.ready(\"Document Sandbox\");\n`}</code></pre>\n    <p>{`As the name implies, the `}<inlineCode parentName=\"p\">{`panelUIProxy`}</inlineCode>{` constant in the Document Sandbox is a `}<em parentName=\"p\">{`proxy`}</em>{` for the object exposed by the iframe's runtime. The other way around works the same: exposing a Document API method to the iframe.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"2\" languages=\"iframe, Document Sandbox\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"ui-iframe-1\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnUISdk from \"https://express.adobe.com/static/add-on-sdk/sdk.js\";\nconst { runtime } = addOnUISdk.instance;\n\n// importing from the Document Sandbox\nconst sandboxProxy = await runtime.apiProxy(\"documentSandbox\");\n\n// We can call this method now\nawait sandboxProxy.drawRect();\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox-1\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnSandboxSdk from \"add-on-sdk-document-sandbox\";\nconst { runtime } = addOnSandboxSdk.instance;\n\n// exporting a payload to the iframe\nruntime.exposeApi({\n  drawRect: () => {\n    // uss the Document API to draw a Rectangle shape...\n  },\n});\n`}</code></pre>\n    <p>{`The following diagram helps visualize the process.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"59.06250000000001%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/5530d/stats-addon-proxy.webp 320w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/0c8fb/stats-addon-proxy.webp 640w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/94b1e/stats-addon-proxy.webp 1280w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/0b34d/stats-addon-proxy.webp 1920w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/f3963/stats-addon-proxy.webp 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/dd4a7/stats-addon-proxy.png 320w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/0f09e/stats-addon-proxy.png 640w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/bbbf7/stats-addon-proxy.png 1280w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/ac7a9/stats-addon-proxy.png 1920w\", \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/6482f/stats-addon-proxy.png 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/8293cd87615a6599e4e56d9dd4d8c07b/bbbf7/stats-addon-proxy.png\",\n            \"alt\": \"Proxy objects\",\n            \"title\": \"Proxy objects\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h3 {...{\n      \"id\": \"proxy-api\"\n    }}>{`Proxy API`}</h3>\n    <p>{`Now that we've seen how contexts expose and import each other's API, let's discuss what's inside the payload objects that cross this environment boundary.`}</p>\n    <h4 {...{\n      \"id\": \"functions\"\n    }}>{`Functions`}</h4>\n    <p>{`Most of the time, you're going to expose `}<strong parentName=\"p\">{`functions`}</strong>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// Document Sandbox\nruntime.exposeApi({\n  drawRect: () => {\n    /* ... */\n  }, // 👈\n  drawEllipse: () => {\n    /* ... */\n  }, // 👈\n  drawShape: () => {\n    /* ... */\n  }, // 👈\n  // etc.\n});\n`}</code></pre>\n    <p>{`In the above example, if `}<inlineCode parentName=\"p\">{`drawShape()`}</inlineCode>{` needs to call either `}<inlineCode parentName=\"p\">{`drawEllipse()`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`drawRect()`}</inlineCode>{`, you may use the `}<em parentName=\"p\">{`method shorthand syntax`}</em>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// Document Sandbox\nruntime.exposeApi({\n  drawRect() {\n    /* ... */\n  }, // 👈\n  drawEllipse() {\n    /* ... */\n  }, // 👈\n  drawShape() {\n    this.drawRect(); // 👆\n    // or\n    this.drawEllipse(); // 👆\n  },\n  // etc.\n});\n`}</code></pre>\n    <p>{`When not strictly necessary, keep functions private and expose only the ones needed.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// Document Sandbox\nconst drawRect = () => {\n  /* ... */\n}; // 👈 private\nconst drawEllipse = () => {\n  /* ... */\n}; // 👈 private\n\nruntime.exposeApi({\n  drawShape() {\n    drawRect(); // 👆\n    // or\n    drawEllipse(); // 👆\n  },\n});\n`}</code></pre>\n    <p>{`Here, `}<inlineCode parentName=\"p\">{`drawRect()`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`drawEllipse()`}</inlineCode>{` exist within the closure of the `}<inlineCode parentName=\"p\">{`drawShape()`}</inlineCode>{` function exposed to the iframe and will work just fine when the iframe invokes it. This notion of \"private\" variables defined in one context can be exploited in various ways, for instance, with a counter as follows.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"2\" languages=\"iframe, Document Sandbox\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"ui-iframe-2\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const sandboxProxy = await runtime.apiProxy(\"documentSandbox\");\n\n// Calling the exposed method\nconst shapesNo = await sandboxProxy.drawShape();\nconsole.log(\"Shapes drawn\", shapesNo);\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox-2\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const drawRect = () => {\n  /* ... */\n};\nconst drawEllipse = () => {\n  /* ... */\n};\n\nlet counter = 0; // 👈 private to the sandbox\n\nruntime.exposeApi({\n  drawShape() {\n    if (counter >= 10) {\n      throw new Error(\"Shape's budget depleted!\");\n    }\n    // Randomly draw either a rectangle or an ellipse\n    Math.random() < 0.5 ? drawRect() : drawEllipse();\n\n    return ++counter; // 👆\n  },\n});\n`}</code></pre>\n    <p>{`The `}<inlineCode parentName=\"p\">{`counter`}</inlineCode>{` variable in the Document Sandbox is maintained between iframe calls within the same user session. It remains isolated to the specific document and cannot be shared with other open documents or users. However, it can be accessed by the `}<inlineCode parentName=\"p\">{`drawShape()`}</inlineCode>{` function. In this context, it's returned to provide the iframe with the count of shapes created up to that point. This introduces us to the notion of `}<strong parentName=\"p\">{`returned values`}</strong>{`.`}</p>\n    <p>{`Generally speaking, you should restrict your returns to the following types.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`✅ Primitive values.`}</li>\n      <li parentName=\"ul\">{`✅ Object literals.`}</li>\n      <li parentName=\"ul\">{`✅ JSON strings.`}</li>\n      <li parentName=\"ul\">{`✅ ArrayBuffers and Blobs.`}</li>\n      <li parentName=\"ul\">{`✅ Promises.`}</li>\n    </ul>\n    <p>{`The following returns won't work as expected and must be avoided.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`❌ Classes (constructor functions).`}</li>\n      <li parentName=\"ul\">{`❌ Class instances (will get serialized and stripped away from any method).`}</li>\n      <li parentName=\"ul\">{`❌ Functions.`}</li>\n      <li parentName=\"ul\">{`❌ Proxies.`}</li>\n      <li parentName=\"ul\">{`❌ Constructs such as `}<inlineCode parentName=\"li\">{`Maps`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`Sets`}</inlineCode>{` won't get through either, nor will `}<inlineCode parentName=\"li\">{`Date`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`RegExp`}</inlineCode>{`.`}</li>\n      <li parentName=\"ul\">{`❌ `}<inlineCode parentName=\"li\">{`new Error()`}</inlineCode>{`, either thrown or returned, won't provide any error message (at the moment) when caught using a `}<inlineCode parentName=\"li\">{`try`}</inlineCode>{`/`}<inlineCode parentName=\"li\">{`catch`}</inlineCode>{` block.`}</li>\n    </ul>\n    <h4 {...{\n      \"id\": \"primitives\"\n    }}>{`Primitives`}</h4>\n    <p>{`Nothing prevents you from using something else besides functions in your proxy. For instance, you can refactor the `}<inlineCode parentName=\"p\">{`drawShape()`}</inlineCode>{` example by exposing a `}<inlineCode parentName=\"p\">{`counter`}</inlineCode>{` property alongside its setter and getter.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"2\" languages=\"iframe, Document Sandbox\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"ui-iframe-3\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// iframe\nconst sandboxProxy = await runtime.apiProxy(\"documentSandbox\");\n\nfor (let i = 0; i < 10; i++) {\n  await sandboxProxy.drawShape();\n}\nsandboxProxy.counter = 0; // resetting the counter\nawait sandboxProxy.drawShape();\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox-3\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// Document Sandbox\nconst drawRect    = () => { /* ... */ };\nconst drawEllipse = () => { /* ... */ };\n\nlet _counter = 0; 👈 // private member (mind the underscore)\n\nruntime.exposeApi({\n  drawShape() {\n    if (_counter >= 10) { // 👈 mind the underscore\n      throw new Error(\"Shape's budget depleted!\");\n    }\n    // Randomly draw either a rectangle or an ellipse\n    Math.random() < 0.5 ? drawRect() : drawEllipse();\n    this.counter = this.counter + 1; // Use the setter to increment\n    return this.counter; // Return the new value after incrementing\n  },\n  get counter()    { return _counter; }, // 👈 getter\n  set counter(val) { _counter = val; }   // 👈 setter\n});\n`}</code></pre>\n    <p>{`The `}<inlineCode parentName=\"p\">{`counter`}</inlineCode>{` setter has the ability to perform additional actions, such as manipulating the document, in addition to assigning a new value to the private variable `}<inlineCode parentName=\"p\">{`_counter`}</inlineCode>{`.`}</p>\n    <p>{`Please note that, given the async nature of the Communication API, retrieving the `}<inlineCode parentName=\"p\">{`counter`}</inlineCode>{` value in the iframe requires the use of `}<inlineCode parentName=\"p\">{`await`}</inlineCode>{` or a `}<inlineCode parentName=\"p\">{`then()`}</inlineCode>{` callback.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`let counter = await sandboxProxy.counter;\n// or\nsandboxProxy.counter.then((counter) => {\n  /* ... */\n});\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"asynchronous-communication\"\n    }}>{`Asynchronous communication`}</h3>\n    <p>{`The Communication API wraps all inter-context function invocations with a `}<strong parentName=\"p\">{`Promise`}</strong>{`. In other words, regardless of the nature of the function called, when it gets from one context to the other (from the iframe to the Document Sandbox or vice-versa), it must be dealt with as if it were `}<strong parentName=\"p\">{`asynchronous`}</strong>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// Document Sandbox\nruntime.exposeApi({\n  drawShape() { /* ... */ } // 👈 Document API methods are typically *synchronous*\n});\n\n// iframe\n❌ const res = sandboxProxy.drawShape(); // 👀 no await, returns a Promise\n❌ console.log(res instanceof Promise);  // true\n\n✅ const res = await sandboxProxy.drawShape(); // using await\n✅ console.log(typeof res); // number (it returns the counter, as you remember)\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"coding-the-stats-add-on\"\n    }}>{`Coding the Stats add-on`}</h2>\n    <p>{`You are now equipped with all the theory and reference snippets needed to start building the Stats add-on: it's a simple project implementing the Communication API in a couple of different ways. Feature-wise, it's split into two parts.`}</p>\n    <ol>\n      <li parentName=\"ol\">{`The add-on shows two `}<strong parentName=\"li\">{`status lights`}</strong>{` that indicate whether the SDKs are ready for use.`}</li>\n      <li parentName=\"ol\">{`At the press of a button, the add-on (via Document API) collects the document's metadata`}<sup parentName=\"li\" {...{\n          \"id\": \"fnref-0\"\n        }}><a parentName=\"sup\" {...{\n            \"href\": \"#fn-0\",\n            \"className\": \"footnote-ref\"\n          }}>{`0`}</a></sup>{`, which is used to compile and show a `}<strong parentName=\"li\">{`table of Nodes`}</strong>{` (elements).`}</li>\n    </ol>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"51.5625%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/5530d/stats-addon-vscode.webp 320w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/0c8fb/stats-addon-vscode.webp 640w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/94b1e/stats-addon-vscode.webp 1280w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/0b34d/stats-addon-vscode.webp 1920w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/d5269/stats-addon-vscode.webp 2560w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/d44a4/stats-addon-vscode.webp 2706w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/dd4a7/stats-addon-vscode.png 320w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/0f09e/stats-addon-vscode.png 640w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/bbbf7/stats-addon-vscode.png 1280w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/ac7a9/stats-addon-vscode.png 1920w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/c7a69/stats-addon-vscode.png 2560w\", \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/2e2a9/stats-addon-vscode.png 2706w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/4202a1e06beb29f84415e2d944edf238/bbbf7/stats-addon-vscode.png\",\n            \"alt\": \"stats addon vscode\",\n            \"title\": \"stats addon vscode\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`Like in the `}<a parentName=\"p\" {...{\n        \"href\": \"grids-addon.md\"\n      }}>{`Grids add-on tutorial`}</a>{`, the starting point will be `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/AdobeDocs/express-add-on-samples/tree/main/document-sandbox-samples/express-addon-document-api-template\"\n      }}>{`this template`}</a>{`, which provides a Webpack-managed JavaScript—hence, able to easily import Spectrum Web Components to build the User Interface. Everything's in the `}<inlineCode parentName=\"p\">{`src`}</inlineCode>{` folder:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`index.html`}</inlineCode>{` is where the iframe's UI is built.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`ui/index.js`}</inlineCode>{` deals with the add-on's internal logic.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`ui/table-utils.js`}</inlineCode>{` contains table-related functions consumed by the iframe and imported by `}<inlineCode parentName=\"li\">{`index.js`}</inlineCode>{` to keep it slim.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`documentSandbox/code.js`}</inlineCode>{` contains the Document API methods exposed to the iframe.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`documentSandbox/utils.js`}</inlineCode>{` stores Document API private functions imported in `}<inlineCode parentName=\"li\">{`code.js`}</inlineCode>{`.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"user-interface\"\n    }}>{`User Interface`}</h3>\n    <p>{`To keep a consistent look & feel with the rest of the application, we'll use Spectrum Web Component as much as possible, styling them with the `}<inlineCode parentName=\"p\">{`express`}</inlineCode>{` theme provided by the `}<inlineCode parentName=\"p\">{`<sp-theme>`}</inlineCode>{` wrapper.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"62.5%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/5530d/stats-addon-doc.webp 320w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/0c8fb/stats-addon-doc.webp 640w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/94b1e/stats-addon-doc.webp 1280w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/0b34d/stats-addon-doc.webp 1920w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/f3963/stats-addon-doc.webp 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/dd4a7/stats-addon-doc.png 320w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/0f09e/stats-addon-doc.png 640w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/bbbf7/stats-addon-doc.png 1280w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/ac7a9/stats-addon-doc.png 1920w\", \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/6482f/stats-addon-doc.png 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/0774237689c842565fb91f04299b80b2/bbbf7/stats-addon-doc.png\",\n            \"alt\": \"stats addon doc\",\n            \"title\": \"stats addon doc\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`For the \"Framework Status\", the `}<a parentName=\"p\" {...{\n        \"href\": \"https://opensource.adobe.com/spectrum-web-components/components/status-light/\"\n      }}>{`Status Light`}</a>{` component is spot-on: it comes in many variants, which set different light colors—`}<inlineCode parentName=\"p\">{`positive`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`negative`}</inlineCode>{` (green 🟢 and red 🔴) will be enough for us. The \"Document Statistics\" section is going to show a list of key/value pairs (the element type and the number of items found on each page). The most obvious choice is a `}<a parentName=\"p\" {...{\n        \"href\": \"https://opensource.adobe.com/spectrum-web-components/components/table/\"\n      }}>{`Table`}</a>{` component, which in SWC is constructed with several tags.`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<sp-table>`}</inlineCode>{` is the outer wrapper.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<sp-table-head>`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`<sp-table-head-cell>`}</inlineCode>{` set the header.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`<sp-table-body>`}</inlineCode>{` is for the body, which contains `}<inlineCode parentName=\"li\">{`<sp-table-row>`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`<sp-table-cell>`}</inlineCode>{` elements.`}</li>\n    </ul>\n    <p>{`We'll start with a placeholder row with a friendly message, which is going to be removed at the first launch. A regular `}<inlineCode parentName=\"p\">{`<sp-button>`}</inlineCode>{` is placed at the bottom to initiate the metadata-collecting process.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"index.html\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"indexhtml\"\n    }}>{`index.html`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`<body>\n  <sp-theme\n    scale=\"medium\"\n    color=\"light\"\n    theme=\"express\"\n  >\n    <h3>Framework status</h3>\n    <hr />\n    <div class=\"row\">\n      <sp-status-light\n        size=\"m\"\n        variant=\"negative\"\n        id=\"iframe-status\"\n      >\n        iFrame API\n      </sp-status-light>\n      <sp-status-light\n        size=\"m\"\n        variant=\"negative\"\n        id=\"document-status\"\n      >\n        Authoring API\n      </sp-status-light>\n    </div>\n    <h3>Document statistics</h3>\n    <hr />\n    <div class=\"row\">\n      <sp-table size=\"m\">\n        <sp-table-head>\n          <sp-table-head-cell>Element</sp-table-head-cell>\n          <sp-table-head-cell>Count</sp-table-head-cell>\n        </sp-table-head>\n        <sp-table-body id=\"stats-table-body\">\n          <sp-table-row id=\"row-placeholder\">\n            <sp-table-cell>Get the Document stats first...</sp-table-cell>\n          </sp-table-row>\n        </sp-table-body>\n      </sp-table>\n    </div>\n    <div class=\"row align-right\">\n      <sp-button id=\"stats\">Analyze document</sp-button>\n    </div>\n  </sp-theme>\n</body>\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"logic\"\n    }}>{`Logic`}</h3>\n    <p>{`The diagram below illustrates the communication flow between the two contexts.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"35.3125%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/5530d/stats-addon-flow.webp 320w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/0c8fb/stats-addon-flow.webp 640w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/94b1e/stats-addon-flow.webp 1280w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/0b34d/stats-addon-flow.webp 1920w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/f3963/stats-addon-flow.webp 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/dd4a7/stats-addon-flow.png 320w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/0f09e/stats-addon-flow.png 640w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/bbbf7/stats-addon-flow.png 1280w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/ac7a9/stats-addon-flow.png 1920w\", \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/6482f/stats-addon-flow.png 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/ada8646adfcb9f5a6031b84de7858b1a/bbbf7/stats-addon-flow.png\",\n            \"alt\": \"stats addon flow\",\n            \"title\": \"stats addon flow\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`The iframe exposes two methods:`}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`toggleStatus()`}</inlineCode>{` will be used independently by the iframe and the Document API to switch the Framework Status lights to green when ready.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`createTable()`}</inlineCode>{` expects to be passed the document metadata and deals with the `}<inlineCode parentName=\"li\">{`<sp-table>`}</inlineCode>{` setup.`}</li>\n    </ul>\n    <p>{`The Document Sandbox exposes only a `}<inlineCode parentName=\"p\">{`getDocumentData()`}</inlineCode>{` method, which collects the metadata from the open document. Both contexts import each other's API via proxy.`}</p>\n    <p>{`When the iframe has loaded its SDK, it will call `}<inlineCode parentName=\"p\">{`toggleStatus()`}</inlineCode>{`, passing the `}<inlineCode parentName=\"p\">{`\"iframe\"`}</inlineCode>{` string as a parameter—telling the function which light to turn green. Similarly, when the Document Sandbox is ready, it will reach out for `}<inlineCode parentName=\"p\">{`toggleStatus()`}</inlineCode>{` on its own. Neither process requires the user's intervention.`}</p>\n    <p>{`When the \"Analyze Document\" button is clicked, the iframe—via the Document Sandbox proxy—invokes `}<inlineCode parentName=\"p\">{`getDocumentData()`}</inlineCode>{`. Instead of returning an object with the metadata to the iframe for further processing (which would be OK), `}<strong parentName=\"p\">{`the Document API uses the iframe proxy to run directly`}</strong>{` `}<inlineCode parentName=\"p\">{`createTable()`}</inlineCode>{` and initiate the table subroutine in an `}<em parentName=\"p\">{`iframe-to-Document-Sandbox-to-iframe`}</em>{` roundtrip. Let's have a look at the overall structure in `}<inlineCode parentName=\"p\">{`index.js`}</inlineCode>{` implementing the logic I've just described.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"index.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"uiindexjs\"\n    }}>{`ui/index.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// SWC imports\nimport \"@spectrum-web-components/styles/typography.css\";\nimport \"@spectrum-web-components/theme/src/themes.js\";\nimport \"@spectrum-web-components/theme/theme-light.js\";\nimport \"@spectrum-web-components/theme/express/theme-light.js\";\nimport \"@spectrum-web-components/theme/express/scale-medium.js\";\nimport \"@spectrum-web-components/theme/sp-theme.js\";\n\nimport \"@spectrum-web-components/status-light/sp-status-light.js\";\nimport \"@spectrum-web-components/table/elements.js\";\nimport \"@spectrum-web-components/button/sp-button.js\";\n\nimport addOnUISdk from \"https://express.adobe.com/static/add-on-sdk/sdk.js\";\n\n// Wait until the addOnUISdk has been loaded\naddOnUISdk.ready.then(async () => {\n  // API to expose to the Document Sandbox\n  const iframeApi = {\n    createTable(documentData) {\n      /* ... */\n    },\n    toggleStatus(sdk) {\n      /* ... */\n    },\n  };\n  runtime.exposeApi(iframeApi);\n\n  // Toggle the iframe SDK status light\n  iframeApi.toggleStatus(\"iframe\");\n\n  // Import the Document Sandbox API proxy\n  const { runtime } = addOnUISdk.instance;\n  const sandboxProxy = await runtime.apiProxy(\"documentSandbox\");\n  // Exposing the iFrame API to the Document Sandbox.\n\n  // Set the button's click handler\n  const statsButton = document.getElementById(\"stats\");\n  statsButton.addEventListener(\"click\", async () => {\n    // Invoke the Document API via Document Sandbox proxy\n    // to get the document metadata and initiate the table creation process\n    await sandboxProxy.getDocumentData(); // 👈 mind the await\n  });\n\n  // Enable the button only when the addOnUISdk is ready\n  statsButton.disabled = false;\n});\n`}</code></pre>\n    <p>{`Besides the usual SWC imports, everything must be wrapped by a callback invoked when the `}<inlineCode parentName=\"p\">{`addOnUISdk`}</inlineCode>{` module is `}<inlineCode parentName=\"p\">{`ready`}</inlineCode>{`—which also means we can switch the first SDK status light to green. Please note that `}<inlineCode parentName=\"p\">{`toggleStatus()`}</inlineCode>{` must be available to both the iframe and the Document Sandbox: declaring the `}<inlineCode parentName=\"p\">{`iframeApi`}</inlineCode>{` constant first (lines 18-21) and passing it to `}<inlineCode parentName=\"p\">{`exposeApi()`}</inlineCode>{` later allows me to call it (line 21).`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// ❌ _in this case_ it's the wrong syntax choice!\nruntime.exposeApi({\n  createTable(documentData) { /* ... */ },\n  toggleStatus(sdk) { /* ... */ }\n});\n\n// ✅ better for our needs _in this context_\nconst iframeApi = {\n  createTable(documentData) { /* ... */ },\n  toggleStatus(sdk) { /* ... */ }\n});\nruntime.exposeApi(iframeApi);\n// toggleStatus is accessible in the iframe too\niframeApi.toggleStatus(\"iframe\"); // 👈\n`}</code></pre>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`Let me remind you again of the need to `}<inlineCode parentName=\"p\">{`await`}</inlineCode>{` when invoking `}<inlineCode parentName=\"p\">{`getDocumentData()`}</inlineCode>{` (line 37, `}<inlineCode parentName=\"p\">{`index.js`}</inlineCode>{`), as the Communication API wraps proxy calls with Promises.`}</p>\n    <p>{`In `}<inlineCode parentName=\"p\">{`documentSandbox/code.js`}</inlineCode>{`, we bring the iframe proxy in, toggle the status light, and expose the `}<inlineCode parentName=\"p\">{`getDocumentData()`}</inlineCode>{` function. Please note that it must be declared asynchronous (line 7) because of the need to `}<inlineCode parentName=\"p\">{`await`}</inlineCode>{` when invoking the `}<inlineCode parentName=\"p\">{`panelUIProxy`}</inlineCode>{` method `}<inlineCode parentName=\"p\">{`createTable()`}</inlineCode>{` (line 12).`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"code.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"documentsandboxcodejs\"\n    }}>{`documentSandbox/code.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnSandboxSdk from \"add-on-sdk-document-sandbox\";\nconst { runtime } = addOnSandboxSdk.instance;\n\nasync function start() {\n  const panelUIProxy = await runtime.apiProxy(\"panel\");\n  runtime.exposeApi({\n    async getDocumentData() {\n      // 👈 async keyword, because 👇\n      // Get the document's metadata\n      let documentData;\n      // ... TODO\n      // ... then, directly invoke the iframe method\n      await panelUIProxy.createTable(documentData); // 👈 the Communication API is async 👆\n    },\n  });\n  // switch the Framework Status light to green\n  panelUIProxy.toggleStatus(\"document\");\n}\nstart();\n`}</code></pre>\n    <InlineAlert variant=\"info\" slots=\"text, text1, text2\" mdxType=\"InlineAlert\" />\n    <p>{`Please note that it would be perfectly fine to return the `}<inlineCode parentName=\"p\">{`documentData`}</inlineCode>{` object to the iframe and let it invoke `}<inlineCode parentName=\"p\">{`createTable()`}</inlineCode>{` on its own. I've chosen to do it this way to show you how that this sort of \"circular\" communication is possible—although the other approach is perhaps more common.`}</p>\n    <p>{`Speaking of coding style in the way the proxy is exposed, you may find more readable to implement the functions elsewhere (either in the same file or in a separate module) and use the object property shorthand syntax.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const getDocumentData = async () => {\n  /* ... */\n};\n// ...\nruntime.exposeApi({\n  getDocumentData, // 👈 shorthand syntax\n  // ...\n});\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"implementation\"\n    }}>{`Implementation`}</h3>\n    <p>{`Let's start filling in the missing parts in our code; we'll begin with the Framework Status, the easiest bit. The `}<inlineCode parentName=\"p\">{`toggleStatus()`}</inlineCode>{` method is immediately invoked in the `}<inlineCode parentName=\"p\">{`addOnUISdk.ready`}</inlineCode>{` callback, as well as the Document Sandbox `}<inlineCode parentName=\"p\">{`code.js`}</inlineCode>{`, where it is also exposed. It updates the `}<inlineCode parentName=\"p\">{`variant`}</inlineCode>{` attribute of the `}<inlineCode parentName=\"p\">{`<sp-status-light>`}</inlineCode>{` element based on the `}<inlineCode parentName=\"p\">{`sdk`}</inlineCode>{` parameter passed in.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"2\" languages=\"iframe, Document Sandbox\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"ui-iframe-4\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const iframeApi = {\n  toggleStatus(sdk) {\n    // sdk parameter validation\n    if ([\"document\", \"iframe\"].indexOf(sdk) === -1) {\n      throw new Error(\"Invalid SDK type\");\n    }\n    const el =\n      sdk === \"document\"\n        ? document.getElementById(\"document-status\")\n        : document.getElementById(\"iframe-status\");\n    el.setAttribute(\"variant\", \"positive\"); // 🟢\n  },\n  // ...\n};\n\niframeApi.toggleStatus(\"iframe\"); // 👈\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox-4\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnSandboxSdk from \"add-on-sdk-document-sandbox\";\nconst { runtime } = addOnSandboxSdk.instance;\n\nasync function start() {\n  const panelUIProxy = await runtime.apiProxy(\"panel\");\n  // ...\n  panelUIProxy.toggleStatus(\"document\"); // 👈\n}\nstart();\n`}</code></pre>\n    <p>{`When refreshing the add-on, the UI updates almost instantly, but a frame-by-frame analysis would reveal a progression in the rendering process: first, the HTML is loaded, then the CSS with the `}<inlineCode parentName=\"p\">{`<sp-status-light>`}</inlineCode>{` components in their original, \"red\" variant; finally, when the two SDK are fully loaded, we get the green lights.`}<sup parentName=\"p\" {...{\n        \"id\": \"fnref-1\"\n      }}><a parentName=\"sup\" {...{\n          \"href\": \"#fn-1\",\n          \"className\": \"footnote-ref\"\n        }}>{`1`}</a></sup></p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"29.375%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/5530d/stats-addon-lights.webp 320w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/0c8fb/stats-addon-lights.webp 640w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/94b1e/stats-addon-lights.webp 1280w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/0b34d/stats-addon-lights.webp 1920w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/f3963/stats-addon-lights.webp 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/dd4a7/stats-addon-lights.png 320w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/0f09e/stats-addon-lights.png 640w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/bbbf7/stats-addon-lights.png 1280w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/ac7a9/stats-addon-lights.png 1920w\", \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/6482f/stats-addon-lights.png 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/e2bf382ae58e38fba1ef4ed17367c39b/bbbf7/stats-addon-lights.png\",\n            \"alt\": \"Status lights\",\n            \"title\": \"Status lights\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <p>{`Let's tackle the metadata collection in the Document Sandbox, especially the data structure we want to create`}<sup parentName=\"p\" {...{\n        \"id\": \"fnref-2\"\n      }}><a parentName=\"sup\" {...{\n          \"href\": \"#fn-2\",\n          \"className\": \"footnote-ref\"\n        }}>{`2`}</a></sup>{`. There are many ways to go about this business: I've decided to keep track of elements on a Page basis and store page dimensions, too. Eventually, the iframe will receive `}<inlineCode parentName=\"p\">{`documentData`}</inlineCode>{`, an array of objects, one for each page, with `}<inlineCode parentName=\"p\">{`dimensions`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`nodes`}</inlineCode>{` properties. If you've got a taste for TypeScript, the type definition would be as follows.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-ts\"\n      }}>{`type DocumentData = Array<{\n  dimensions: { width: number; height: number };\n  nodes: { [key: string]: number };\n}>;\n`}</code></pre>\n    <p>{`The above would transpose into something along these lines.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`[\n  {\n    // page 1\n    dimensions: { width: 1200, height: 1200 },\n    nodes: {\n      \"ab:Artboard\": 1,\n      MediaContainer: 1,\n      Text: 2,\n      ComplexShape: 3,\n    },\n  },\n  {\n    // page 2\n    dimensions: { width: 800, height: 400 },\n    nodes: {\n      \"ab:Artboard\": 1,\n      MediaContainer: 4,\n      Rectangle: 2,\n    },\n  },\n  // ...\n];\n`}</code></pre>\n    <p>{`The various `}<inlineCode parentName=\"p\">{`\"ab:Artboard\"`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`\"MediaContainer\"`}</inlineCode>{` and others, are the Node type strings as Adobe Express exposes them. Let's create the `}<inlineCode parentName=\"p\">{`getDocumentData()`}</inlineCode>{` function that outputs such a structure.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"50.625%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/5530d/stats-addon-type.webp 320w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/0c8fb/stats-addon-type.webp 640w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/94b1e/stats-addon-type.webp 1280w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/0b34d/stats-addon-type.webp 1920w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/d5269/stats-addon-type.webp 2560w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/dd4a7/stats-addon-type.png 320w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/0f09e/stats-addon-type.png 640w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/bbbf7/stats-addon-type.png 1280w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/ac7a9/stats-addon-type.png 1920w\", \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/c7a69/stats-addon-type.png 2560w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/2ffba3474f2c90964a0bc31af2dd7053/bbbf7/stats-addon-type.png\",\n            \"alt\": \"stats addon type\",\n            \"title\": \"stats addon type\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"code.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"documentsandboxcodejs-1\"\n    }}>{`documentSandbox/code.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { getNodeData } from \"./utils\";\n\nruntime.exposeApi({\n  async getDocumentData() {\n    const doc = editor.documentRoot; // get the document\n    let documentData = []; // initialize the array to return\n    for (const page of doc.pages) {\n      // loop through each page\n      let pageData = {}; // create an empty object\n      pageData.dimensions = {\n        // get and store the page \\`dimensions\\`\n        width: page.width,\n        height: page.height,\n      };\n      pageData.nodes = getNodeData(page); // 👈 build the \\`nodes\\` object (more on this later)\n      documentData.push(pageData); // push the object to the documentData array\n    }\n    // invoke the iframe method to create the table on the UI\n    await panelUIProxy.createTable(documentData);\n  },\n});\n`}</code></pre>\n    <p>{`The code comments will guide you through the process of getting the document, loop through pages extracting dimensions, and retrieving nodes metadata, but up to a point. What's `}<inlineCode parentName=\"p\">{`getNodeData`}</inlineCode>{`? As I mentioned before, I've split the Document API code into two parts: the main Document Sandbox entrypoint (`}<inlineCode parentName=\"p\">{`code.js`}</inlineCode>{`, where methods are exposed to and imported from the iframe) and `}<inlineCode parentName=\"p\">{`table-utils.js`}</inlineCode>{`, which is kept private to the context and exports just what `}<inlineCode parentName=\"p\">{`code.js`}</inlineCode>{` needs—the `}<inlineCode parentName=\"p\">{`getNodeData()`}</inlineCode>{` method, which makes use of `}<inlineCode parentName=\"p\">{`increaseCount()`}</inlineCode>{`.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"utils.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"documentsandboxtable-utilsjs\"\n    }}>{`documentSandbox/table-utils.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const increaseCount = (obj, type) => {\n  // If the type is already in the object, increase its count, otherwise set it to 1\n  if (obj.hasOwnProperty(type)) {\n    obj[type] += 1;\n  } else {\n    obj[type] = 1;\n  }\n};\n\nconst getNodeData = (node, nodeData = {}) => {\n  if (node.type === \"MediaContainer\") {\n    return nodeData;\n  }\n\n  // Check if the current node has children and if they are not an empty array\n  if (node.allChildren && node.allChildren.length > 0) {\n    // Iterate over all children using for..of\n    for (const child of node.allChildren) {\n      // Increase the count for the current type\n      increaseCount(nodeData, child.type);\n\n      // Recursively call getNodeData for each child that has its own children\n      // ... unless it's a MediaContainer\n      if (\n        child.type !== \"MediaContainer\" &&\n        child.allChildren &&\n        child.allChildren.length > 0\n      ) {\n        getNodeData(child, nodeData);\n      }\n    }\n  }\n\n  return nodeData;\n};\n\nexport { getNodeData };\n`}</code></pre>\n    <p>{`Given the nature of Adobe Express documents (which will be covered in detail in a future tutorial), it makes sense to build `}<inlineCode parentName=\"p\">{`getNodeData()`}</inlineCode>{` as a recursive function: a `}<a parentName=\"p\" {...{\n        \"href\": \"/express-add-ons-docs/references/document-sandbox/document-apis/classes/PageNode/\"\n      }}><inlineCode parentName=\"a\">{`PageNode`}</inlineCode></a>{` can contain multiple `}<a parentName=\"p\" {...{\n        \"href\": \"/express-add-ons-docs/references/document-sandbox/document-apis/classes/ArtboardNode/\"\n      }}><inlineCode parentName=\"a\">{`ArtboardNode`}</inlineCode></a>{` elements, which in turn can contain multiple `}<a parentName=\"p\" {...{\n        \"href\": \"/express-add-ons-docs/references/document-sandbox/document-apis/classes/GroupNode/\"\n      }}><inlineCode parentName=\"a\">{`GroupNode`}</inlineCode></a>{` elements, and so on. As follows, the metacode.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The `}<inlineCode parentName=\"p\">{`getNodeData()`}</inlineCode>{` method begins its execution when called by `}<inlineCode parentName=\"p\">{`getDocumentData()`}</inlineCode>{`, taking a single parameter named `}<inlineCode parentName=\"p\">{`page`}</inlineCode>{`. At the start, `}<inlineCode parentName=\"p\">{`nodeData`}</inlineCode>{` is initialized as an empty object. The method then checks if the current node has the `}<inlineCode parentName=\"p\">{`allChildren`}</inlineCode>{` property, which should be a non-empty iterable (please note: it's not an Array, but can be transformed into one if needed via `}<inlineCode parentName=\"p\">{`Array.from()`}</inlineCode>{`). If so, it goes through it. During each iteration, it increments the count for the `}<inlineCode parentName=\"p\">{`type`}</inlineCode>{` property of each child node (such as `}<inlineCode parentName=\"p\">{`\"Text\"`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`\"Group\"`}</inlineCode>{`, etc.).`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`If a child node within this array also features a non-empty `}<inlineCode parentName=\"p\">{`allChildren`}</inlineCode>{` property, `}<inlineCode parentName=\"p\">{`getNodeData()`}</inlineCode>{` is called recursively on that child node. Mind you: during these recursive calls, `}<inlineCode parentName=\"p\">{`nodeData`}</inlineCode>{` is passed as the second argument. This approach ensures that the same `}<inlineCode parentName=\"p\">{`nodeData`}</inlineCode>{` object is continuously used throughout the recursion, allowing it to accumulate and keep tabs on all node types encountered across all hierarchy levels. The `}<inlineCode parentName=\"p\">{`\"MediaContainer\"`}</inlineCode>{` node is a particular one, `}<sup parentName=\"p\" {...{\n            \"id\": \"fnref-3\"\n          }}><a parentName=\"sup\" {...{\n              \"href\": \"#fn-3\",\n              \"className\": \"footnote-ref\"\n            }}>{`3`}</a></sup>{` and when encountered, we stop there.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The `}<inlineCode parentName=\"p\">{`increaseCount()`}</inlineCode>{` method, which we keep private to the `}<inlineCode parentName=\"p\">{`utils.js`}</inlineCode>{` module, receives the `}<inlineCode parentName=\"p\">{`nodeData`}</inlineCode>{` object and bumps the count for each `}<inlineCode parentName=\"p\">{`child.type`}</inlineCode>{`.`}</p>\n      </li>\n    </ol>\n    <p>{`When the whole process is repeated for each `}<inlineCode parentName=\"p\">{`page`}</inlineCode>{`, we can finally invoke the iframe `}<inlineCode parentName=\"p\">{`createTable()`}</inlineCode>{` method, passing the `}<inlineCode parentName=\"p\">{`documentData`}</inlineCode>{`.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"code.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"documentsandboxcodejs-2\"\n    }}>{`documentSandbox/code.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`runtime.exposeApi({\n  async getDocumentData() {\n    // ... create and fill the \\`documentData\\` array\n    await panelUIProxy.createTable(documentData); // 👈 calling this iframe proxy method\n  },\n});\n`}</code></pre>\n    <p>{`Now, it's up to the iframe to manage such data (the array of objects collecting page dimensions and node counts) and transform it into a Spectrum Table.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"index.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"uiindexjs-1\"\n    }}>{`ui/index.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { rebuildTable } from \"./table-utils\";\n\nconst iframeApi = {\n  toggleStatus(sdk) {\n    /* ... */\n  },\n  createTable(documentData) {\n    // 👈\n    const table = document.getElementById(\"stats-table-body\");\n    rebuildTable(table, documentData);\n  },\n};\n`}</code></pre>\n    <p>{`The process is not difficult per se, but it may be slightly tedious. The `}<inlineCode parentName=\"p\">{`rebuildTable()`}</inlineCode>{` method is declared in the `}<inlineCode parentName=\"p\">{`table-utils.js`}</inlineCode>{` module alongside a private `}<inlineCode parentName=\"p\">{`addRowToTable()`}</inlineCode>{`.`}</p>\n    <CodeBlock slots=\"heading, code\" repeat=\"1\" languages=\"table-utils.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"documentsandboxtable-utilsjs-1\"\n    }}>{`documentSandbox/table-utils.js`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`// documentSandbox/table-utils.js\n\nconst addRowToTable = (table, rowData) => {\n  // Create a new row\n  const newRow = document.createElement(\"sp-table-row\");\n\n  // For each cell data, create a cell and append it to the row\n  let cell;\n  rowData.forEach((cellData) => {\n    cell = document.createElement(\"sp-table-cell\");\n    cell.textContent = cellData;\n    newRow.appendChild(cell);\n  });\n  if (rowData.length === 1) {\n    // Making the page row bold\n    cell.className = \"page-row\";\n  }\n  // Append the row to the table body\n  table.appendChild(newRow);\n};\n\nconst rebuildTable = (table, documentData) => {\n  // Removing all existing rows from the table,\n  // either the placeholder or the previous results\n  while (table.firstChild) {\n    table.removeChild(table.firstChild);\n  }\n  documentData.forEach((pageData, index) => {\n    addRowToTable(table, [\n      \\`Page \\${index + 1} (\\${pageData.dimensions.width} x \\${\n        pageData.dimensions.height\n      })\\`,\n    ]);\n    // the for...in loop iterates over the keys of an object\n    for (const node in pageData.nodes) {\n      // for example,      [\"Text\", 1]\n      addRowToTable(table, [node, pageData.nodes[node]]);\n    }\n  });\n};\n\nexport { rebuildTable };\n`}</code></pre>\n    <p>{`As follows, the `}<inlineCode parentName=\"p\">{`rebuildTable()`}</inlineCode>{` metacode.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Initialize the existing table, which is the first argument it receives.`}</li>\n      <li parentName=\"ul\">{`Loop through each page in the `}<inlineCode parentName=\"li\">{`documentData`}</inlineCode>{` array, adding a row with the dimensions via `}<inlineCode parentName=\"li\">{`addRowToTable()`}</inlineCode>{`; please note that, although the Table is supposed to have two columns, we can set a row with only one cell, which will span both of them.`}</li>\n      <li parentName=\"ul\">{`Loop through each node in the `}<inlineCode parentName=\"li\">{`pageData.nodes`}</inlineCode>{` object, adding a row with the node type and the number of instances found on that page.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`addRowToTable()`}</inlineCode>{` is a utility function that takes a table and an array of strings as arguments. It creates a new `}<inlineCode parentName=\"li\">{`<sp-table-row>`}</inlineCode>{`, then loops through the array, creating a `}<inlineCode parentName=\"li\">{`<sp-table-cell>`}</inlineCode>{` for each string and appending it to the row. If the array contains only one element, the cell is given a `}<inlineCode parentName=\"li\">{`page-row`}</inlineCode>{` class, which makes it bold.`}</li>\n    </ul>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1280px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"61.5625%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"display\": \"block\",\n            \"transition\": \"opacity 0.5s 0.5s\",\n            \"pointerEvents\": \"none\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/5530d/stats-addon-stats.webp 320w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/0c8fb/stats-addon-stats.webp 640w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/94b1e/stats-addon-stats.webp 1280w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/0b34d/stats-addon-stats.webp 1920w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/f3963/stats-addon-stats.webp 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n          `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/dd4a7/stats-addon-stats.png 320w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/0f09e/stats-addon-stats.png 640w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/bbbf7/stats-addon-stats.png 1280w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/ac7a9/stats-addon-stats.png 1920w\", \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/6482f/stats-addon-stats.png 2500w\"],\n            \"sizes\": \"(max-width: 1280px) 100vw, 1280px\",\n            \"type\": \"image/png\"\n          }}></source>{`\n          `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/express-add-ons-docs/static/20c123041cdc33e0fc1d7d9bd0b60492/bbbf7/stats-addon-stats.png\",\n            \"alt\": \"stats addon stats\",\n            \"title\": \"stats addon stats\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"opacity\": \"0\",\n              \"transition\": \"opacity 0.5s\",\n              \"color\": \"inherit\",\n              \"boxShadow\": \"inset 0px 0px 0px 400px none\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n        `}</picture>{`\n    `}</span></p>\n    <h2 {...{\n      \"id\": \"next-steps\"\n    }}>{`Next Steps`}</h2>\n    <p>{`Congratulations! You've coded from scratch the Stats add-on for Adobe Express. As an exercise, you may want to extend it with the following features.`}</p>\n    <ul>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Better visualization`}</strong>{`: you can add `}<inlineCode parentName=\"li\">{`<sp-icon>`}</inlineCode>{` elements for each Node type, or bypass the Table altogether using an Accordion component for a hierarchical, collapsible menu.`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Hide and Show`}</strong>{`: via the `}<a parentName=\"li\" {...{\n          \"href\": \"/express-add-ons-docs/references/document-sandbox\"\n        }}>{`Document API`}</a>{` you may hide and show elements based on their type—the `}<inlineCode parentName=\"li\">{`<sp-table>`}</inlineCode>{` has a `}<inlineCode parentName=\"li\">{`selects`}</inlineCode>{` and a `}<inlineCode parentName=\"li\">{`selected`}</inlineCode>{` attributes that you can put to use.`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Save Snapshots`}</strong>{`: using the `}<a parentName=\"li\" {...{\n          \"href\": \"/express-add-ons-docs/references/addonsdk/instance-clientStorage/\"\n        }}>{`Client Storage API`}</a>{`, you can keep track of the document's metadata and compare it with previous versions.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"lessons-learned\"\n    }}>{`Lessons Learned`}</h2>\n    <p>{`Let's review the concepts covered in this tutorial and how they've been implemented in the Stats add-on.`}</p>\n    <ul>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Communication API`}</strong>{`: the iframe and the Document Sandbox can expose and import each other's API via proxy objects. The Communication API wraps all inter-context function invocations with a Promise; hence, the need to `}<inlineCode parentName=\"li\">{`await`}</inlineCode>{` when invoking a proxy method.`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Proxy API`}</strong>{`: the payload objects exchanged between the two contexts can contain functions, which are the most common use case: they can return primitives, object literals, JSON strings, ArrayBuffers, and Blobs.`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Context Closures`}</strong>{`: proxy methods have access to variables defined in their context, even when invoked from the other context. This is a powerful feature that can be exploited to keep private variables and functions out of the Communication API.`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Roundtrip calls`}</strong>{`: proxy methods can be chained—the iframe can invoke the Document API via the Document Sandbox proxy, which in turn can invoke the iframe proxy, and so on.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"final-project\"\n    }}>{`Final Project`}</h2>\n    <p>{`The code for this project can be downloaded `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/AdobeDocs/express-add-on-samples/tree/main/document-sandbox-samples/express-stats-addon\"\n      }}>{`here`}</a>{`. Use `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/AdobeDocs/express-add-on-samples/tree/main/document-sandbox-samples/express-addon-document-api-template\"\n      }}>{`this template`}</a>{` as a starting point.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text1\" mdxType=\"InlineAlert\" />\n    <p>{`Please use the UI iframe and Document Sandbox tabs to switch between the two domains and find a dropdown in the top-right corner to select which file to show.`}</p>\n    {/* Code below */}\n    <CodeBlock slots=\"heading, code\" repeat=\"6\" languages=\"index.html, styles.css, ui/index.js, ui/table-utils.js, documentSandbox/code.js, documentSandbox/utils.js\" mdxType=\"CodeBlock\" />\n    <h4 {...{\n      \"id\": \"ui-iframe-5\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-html\"\n      }}>{`<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"description\"\n      content=\"Adobe Express Add-on template using JavaScript, the Document Sandbox, and Webpack\"\n    />\n    <meta\n      name=\"keywords\"\n      content=\"Adobe, Express, Add-On, JavaScript, Document Sandbox, Adobe Express Document API\"\n    />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0\"\n    />\n    <title>Stats add-ons</title>\n    <link\n      rel=\"stylesheet\"\n      href=\"styles.css\"\n    />\n  </head>\n\n  <body>\n    <sp-theme\n      scale=\"medium\"\n      color=\"light\"\n      theme=\"express\"\n    >\n      <h3>Framework status</h3>\n      <hr />\n      <div class=\"row\">\n        <sp-status-light\n          size=\"m\"\n          variant=\"negative\"\n          id=\"iframe-status\"\n          >iFrame API</sp-status-light\n        >\n        <sp-status-light\n          size=\"m\"\n          variant=\"negative\"\n          id=\"document-status\"\n          >Authoring API</sp-status-light\n        >\n      </div>\n      <h3>Document statistics</h3>\n      <hr />\n      <div class=\"row\">\n        <sp-table size=\"m\">\n          <sp-table-head>\n            <sp-table-head-cell>Element</sp-table-head-cell>\n            <sp-table-head-cell>Count</sp-table-head-cell>\n          </sp-table-head>\n          <sp-table-body id=\"stats-table-body\">\n            <sp-table-row id=\"row-placeholder\">\n              <sp-table-cell>Get the Document stats first...</sp-table-cell>\n            </sp-table-row>\n          </sp-table-body>\n        </sp-table>\n      </div>\n      <div class=\"row align-right\">\n        <sp-button id=\"stats\">Analyze document</sp-button>\n      </div>\n    </sp-theme>\n  </body>\n</html>\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"ui-iframe-6\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-css\"\n      }}>{`body {\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n}\n\nsp-theme {\n  margin: 0 var(--spectrum-global-dimension-static-size-300);\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  margin-bottom: var(--spectrum-global-dimension-static-size-175);\n}\n\n.align-right {\n  justify-content: flex-end;\n}\n\nsp-table {\n  width: 100%;\n}\n\nsp-button {\n  align-self: flex-end;\n}\n\n.page-row {\n  font-weight: var(--spectrum-global-font-weight-bold);\n}\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"ui-iframe-7\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import \"@spectrum-web-components/styles/typography.css\";\nimport \"@spectrum-web-components/theme/src/themes.js\";\nimport \"@spectrum-web-components/theme/theme-light.js\";\nimport \"@spectrum-web-components/theme/express/theme-light.js\";\nimport \"@spectrum-web-components/theme/express/scale-medium.js\";\nimport \"@spectrum-web-components/theme/sp-theme.js\";\n\nimport \"@spectrum-web-components/status-light/sp-status-light.js\";\nimport \"@spectrum-web-components/table/elements.js\";\nimport \"@spectrum-web-components/button/sp-button.js\";\n\nimport addOnUISdk from \"https://express.adobe.com/static/add-on-sdk/sdk.js\";\nimport { rebuildTable } from \"./table-utils\";\n\naddOnUISdk.ready.then(async () => {\n  const iframeApi = {\n    /**\n     * Toggles the status light.\n     * @param {string} sdk - The type of SDK that is ready, either \"document\" or \"iframe\"\n     */\n    toggleStatus(sdk) {\n      if ([\"document\", \"iframe\"].indexOf(sdk) === -1) {\n        throw new Error(\"Invalid SDK type\");\n      }\n      const el =\n        sdk === \"document\"\n          ? document.getElementById(\"document-status\")\n          : document.getElementById(\"iframe-status\");\n      el.setAttribute(\"variant\", \"positive\");\n    },\n\n    createTable(documentData) {\n      const table = document.getElementById(\"stats-table-body\");\n      rebuildTable(table, documentData);\n    },\n  };\n\n  // the addOnUISdk is ready, so we can now toggle the status light\n  iframeApi.toggleStatus(\"iframe\");\n\n  // Get the Document Sandbox.\n  const { runtime } = addOnUISdk.instance;\n  // Importing the Document Sandbox API.\n  const sandboxProxy = await runtime.apiProxy(\"documentSandbox\");\n  // Exposing the iframe API to the Document Sandbox.\n  runtime.exposeApi(iframeApi);\n\n  const statsButton = document.getElementById(\"stats\");\n\n  statsButton.addEventListener(\"click\", async () => {\n    await sandboxProxy.getDocumentData();\n  });\n  // Enabling the button only when the addOnUISdk is ready\n  statsButton.disabled = false;\n});\n\n/**\n * Adds a new row to the specified table.\n *\n * @param {HTMLTableElement} table - The table to which the row should be added.\n * @param {Array} rowData - An array containing the data for each cell in the row.\n */\nfunction addRowToTable(table, rowData) {\n  // Create a new row\n  const newRow = document.createElement(\"sp-table-row\");\n\n  // For each cell data, create a cell and append it to the row\n  let cell;\n  rowData.forEach((cellData) => {\n    cell = document.createElement(\"sp-table-cell\");\n    cell.textContent = cellData;\n    newRow.appendChild(cell);\n  });\n  if (rowData.length === 1) {\n    // Making the page row bold\n    cell.className = \"page-row\";\n  }\n  // Append the row to the table body\n  table.appendChild(newRow);\n}\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"ui-iframe-8\"\n    }}>{`UI iframe`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`/**\n * Adds a new row to the specified table.\n *\n * @param {HTMLTableElement} table - The table to which the row should be added.\n * @param {Array} rowData - An array containing the data for each cell in the row.\n */\nconst addRowToTable = (table, rowData) => {\n  // Create a new row\n  const newRow = document.createElement(\"sp-table-row\");\n\n  // For each cell data, create a cell and append it to the row\n  let cell;\n  rowData.forEach((cellData) => {\n    cell = document.createElement(\"sp-table-cell\");\n    cell.textContent = cellData;\n    newRow.appendChild(cell);\n  });\n  if (rowData.length === 1) {\n    // Making the page row bold\n    cell.className = \"page-row\";\n  }\n  // Append the row to the table body\n  table.appendChild(newRow);\n};\n\nconst rebuildTable = (table, documentData) => {\n  // Removing all existing rows from the table\n  while (table.firstChild) {\n    table.removeChild(table.firstChild);\n  }\n\n  // The pageData comes as an array of objects, one for each page\n  // Each pageData object contains the dimensions of the page and the nodes, e.g.\n  // [{ dimensions: { width: 600, height: 800 }, nodes: { Text: 1, Rectangle: 4 } }, { ... }]\n  documentData.forEach((pageData, index) => {\n    addRowToTable(table, [\n      \\`Page \\${index + 1} (\\${pageData.dimensions.width} x \\${\n        pageData.dimensions.height\n      })\\`,\n    ]);\n    // the for...in loop iterates over the keys of an object\n    for (const node in pageData.nodes) {\n      // for example,      [\"Text\", 1]\n      addRowToTable(table, [node, pageData.nodes[node]]);\n    }\n  });\n};\n\nexport { rebuildTable };\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox-5\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import addOnSandboxSdk from \"add-on-sdk-document-sandbox\";\nconst { runtime } = addOnSandboxSdk.instance;\n\nimport { editor } from \"express-document-sdk\";\nimport { getNodeData } from \"./utils\";\n\nasync function start() {\n  const panelUIProxy = await runtime.apiProxy(\"panel\");\n\n  runtime.exposeApi({\n    async getDocumentData() {\n      const doc = editor.documentRoot;\n      let documentData = [];\n      for (const page of doc.pages) {\n        console.log(\"Page\", page);\n        let pageData = {};\n        pageData.dimensions = {\n          width: page.width,\n          height: page.height,\n        };\n        pageData.nodes = getNodeData(page);\n        documentData.push(pageData);\n      }\n      console.log(\"documentData\", documentData);\n      await panelUIProxy.createTable(documentData);\n    },\n  });\n\n  panelUIProxy.toggleStatus(\"document\");\n}\n\nstart();\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"document-sandbox-6\"\n    }}>{`Document Sandbox`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const increaseCount = (obj, type) => {\n  // If the type is already in the object, increase its count, otherwise set it to 1\n  if (obj.hasOwnProperty(type)) {\n    obj[type] += 1;\n  } else {\n    obj[type] = 1;\n  }\n};\n\nconst getNodeData = (node, nodeData = {}) => {\n  if (node.type === \"MediaContainer\") {\n    return nodeData;\n  }\n\n  // Check if the current node has children and if they are not an empty array\n  if (node.allChildren && node.allChildren.length > 0) {\n    // Iterate over all children using for..of\n    for (const child of node.allChildren) {\n      // Increase the count for the current type\n      increaseCount(nodeData, child.type);\n\n      // Recursively call getNodeData for each child that has its own children\n      // ... unless it's a MediaContainer\n      if (\n        child.type !== \"MediaContainer\" &&\n        child.allChildren &&\n        child.allChildren.length > 0\n      ) {\n        getNodeData(child, nodeData);\n      }\n    }\n  }\n  return nodeData;\n};\n\nexport { getNodeData };\n`}</code></pre>\n\n    <div {...{\n      \"className\": \"footnotes\"\n    }}>\n      <hr parentName=\"div\"></hr>\n      <ol parentName=\"div\">\n        <li parentName=\"ol\" {...{\n          \"id\": \"fn-0\"\n        }}>{`When referring to \"metadata\", I mean the dimensions and types of elements on each page. Custom metadata haven't been implemented in Adobe Express yet.`}<a parentName=\"li\" {...{\n            \"href\": \"#fnref-0\",\n            \"className\": \"footnote-backref\"\n          }}>{`↩`}</a></li>\n        <li parentName=\"ol\" {...{\n          \"id\": \"fn-1\"\n        }}>{`In my tests, the two SDKs are ready almost instantly and together—I couldn't tell which one is loaded firsts.`}<a parentName=\"li\" {...{\n            \"href\": \"#fnref-1\",\n            \"className\": \"footnote-backref\"\n          }}>{`↩`}</a></li>\n        <li parentName=\"ol\" {...{\n          \"id\": \"fn-2\"\n        }}>{`Designing data structures in the early stages of the development process is, in my humble opinion, a way to dodge a good deal of future headaches.`}<a parentName=\"li\" {...{\n            \"href\": \"#fnref-2\",\n            \"className\": \"footnote-backref\"\n          }}>{`↩`}</a></li>\n        <li parentName=\"ol\" {...{\n          \"id\": \"fn-3\"\n        }}>{`A `}<inlineCode parentName=\"li\">{`\"MediaContainer\"`}</inlineCode>{` (say, an image) has as children both the `}<inlineCode parentName=\"li\">{`\"ImageRectangle\"`}</inlineCode>{` and the mask that crops it. At this stage of the Document API development, getting complex masks may throw an Error—hence, I've decided to use the `}<inlineCode parentName=\"li\">{`\"MediaContainer\"`}</inlineCode>{` type as a recursion's termination clause.`}<a parentName=\"li\" {...{\n            \"href\": \"#fnref-3\",\n            \"className\": \"footnote-backref\"\n          }}>{`↩`}</a></li>\n      </ol>\n    </div>\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","makeShortcode","name","props","console","warn","mdx","ListBlock","CodeBlock","InlineAlert","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","_objectWithoutProperties","_excluded","_extends","mdxType","parentName","slots","repeat","iconColor","icon","variant","languages","isMDXComponent"],"sourceRoot":""}