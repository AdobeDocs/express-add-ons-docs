"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[3740],{39032:function(e,n,a){a.r(n),a.d(n,{_frontmatter:function(){return r},default:function(){return h}});var t=a(58168),s=a(80045),o=(a(88763),a(15680)),d=a(83407);const i=["components"],r={},p=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.mdx)("div",n)},l=p("InlineAlert"),c=p("CodeBlock"),m={_frontmatter:r},x=d.A;function h(e){let{components:n}=e,a=(0,s.A)(e,i);return(0,o.mdx)(x,(0,t.A)({},m,a,{components:n,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"adobe-express-document-api-concepts"},"Adobe Express Document API Concepts"),(0,o.mdx)("p",null,"The structures that make up the Adobe Express Document Object Model, their features, and how they're reflected in the Reference documentation."),(0,o.mdx)("h2",{id:"overview"},"Overview"),(0,o.mdx)("p",null,"In this article, you'll dive deep into the architecture and key elements of the Adobe Express Document Object Model (DOM) and why the Reference Documentation is the primary tool to explore it. Understanding the structures at play, hierarchy, and inheritance system will help you develop add-ons that exploit their full potential."),(0,o.mdx)("h3",{id:"getting-started-with-the-dom"},"Getting started with the DOM"),(0,o.mdx)("p",null,"The notion of ",(0,o.mdx)("strong",{parentName:"p"},"Document Object Model")," (DOM) is key to any scripting environment; developers refer to ",(0,o.mdx)("em",{parentName:"p"},"scripting")," when their programs use tools primarily available through the application's User Interface (UI) but programmatically, with code. For example, the ",(0,o.mdx)("a",{parentName:"p",href:"../how_to/tutorials/grids-addon.md"},"Grids tutorial")," add-on creates a grid system while operating with built-in elements like shapes and editing their dimensions, positions, fills, and blending modes. If you were to implement an unsupported object type, you'd need to go beyond the combination of existing tools—i.e., outside the scripting realm.",(0,o.mdx)("sup",{parentName:"p",id:"fnref-1"},(0,o.mdx)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,o.mdx)("p",null,"It is essential to hierarchically organize the features that are surfaced",(0,o.mdx)("sup",{parentName:"p",id:"fnref-2"},(0,o.mdx)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," to the scripting layer. For example, a shape is not just contained within a document: it may be included in a particular Group in a certain Artboard, which belongs to a specific Page of a Document. Additionally, Ellipses and Rectangles, as shapes, share some properties, such as the ability to be filled or stroked with a solid color; in that respect, though, they differ from a bitmap image, which can be stroked but not filled."),(0,o.mdx)("p",null,"More formally stated, any scripting environment must expose information about the ",(0,o.mdx)("strong",{parentName:"p"},"Containment Structures")," (parent/child relations, like groups nesting shapes) and ",(0,o.mdx)("strong",{parentName:"p"},"Inheritance Hierarchies")," (shared attributes like the opacity property available to both) of any element it deals with. Such a collection of organized information is called the Document Object Model, or DOM."),(0,o.mdx)("p",null,"Developers with a front-end background may instinctively associate the notion of DOM with HTML and the Browser. Although it has been the most common case for decades, all applications supporting scripting rely on their own Document Object Model—as those working with desktop versions of the Creative Cloud know very well. The Adobe Express add-on system is technically different from CEP extensions in Adobe After Effects or UXP plugins in Adobe Photoshop; still, the concept of the DOM is equally valid."),(0,o.mdx)(l,{variant:"warning",slots:"heading, text1, text2, text3w",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,(0,o.mdx)("strong",{parentName:"p"},"Warning")," "),(0,o.mdx)("p",null,"Some confusion may arise regarding the meaning of the following terms—let me clarify."),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Document Model Sandbox"),": the sandboxed JavaScript environment that makes the Document API available to add-on developers. It's usually juxtaposed with the iframe UI: both reciprocally share APIs via proxy, as described in ",(0,o.mdx)("a",{parentName:"li",href:"../how_to/tutorials/stats-addon.md"},"this tutorial"),"."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Document Object Model"),": it represents Adobe Express documents' structure, the hierarchies between each element, and their inheritance.")),(0,o.mdx)("p",null,"You may think about the Document API as operating in the context of the DOM—while the Document Model Sandbox provides a secure and isolated environment for such code to run."),(0,o.mdx)("h3",{id:"coding-along"},"Coding along"),(0,o.mdx)("p",null,"You are encouraged to try the code snippets discussed here; please use ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/express-add-on-samples/tree/main/document-sandbox-samples/express-dimensions-addon"},"this boilerplate")," to follow along. It contains a demo add-on in two states: the complete version (in the ",(0,o.mdx)("inlineCode",{parentName:"p"},"express-dimensions-end")," folder, whose code is also found in the ",(0,o.mdx)("a",{parentName:"p",href:"#final-project"},"Final Project")," section at the bottom of this page) and a starting point (",(0,o.mdx)("inlineCode",{parentName:"p"},"express-dimensions-start"),") that you can also use to test your assumptions and inspect the Console. The Document API code belongs to the ",(0,o.mdx)("inlineCode",{parentName:"p"},"src/documentSandbox/code.js")," file."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'// ...\nimport { editor, colorUtils } from "express-document-sdk";\nfunction start() {\n  runtime.exposeApi({\n    log: () => {\n      const selectedNode = editor.context.selection[0];\n      console.log("Currently selected node", selectedNode);\n    },\n    // ...\n  });\n}\n')),(0,o.mdx)("p",null,'Run the add-on, select any object in the UI, and click the "Log selected node" button: it\'ll be logged in the Console.'),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"51.87500000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/5530d/refs-addon-log.webp 320w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/0c8fb/refs-addon-log.webp 640w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/94b1e/refs-addon-log.webp 1280w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/0b34d/refs-addon-log.webp 1920w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/d5269/refs-addon-log.webp 2560w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/dd4a7/refs-addon-log.png 320w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/0f09e/refs-addon-log.png 640w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/bbbf7/refs-addon-log.png 1280w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/ac7a9/refs-addon-log.png 1920w","/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/c7a69/refs-addon-log.png 2560w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/588a6599aa96020f7b8663aa8829faf2/bbbf7/refs-addon-log.png",alt:"refs addon log",title:"refs addon log",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h2",{id:"the-adobe-express-dom"},"The Adobe Express DOM"),(0,o.mdx)("p",null,"An Adobe Express document is internally represented as a hierarchical tree of ",(0,o.mdx)("strong",{parentName:"p"},"nodes"),". Some of them may branch: in other words, contain other nodes, host children—like an Artboard or a Group with some shapes or media in them. Other ones are so-called leaf nodes: the tree's endpoints, for example, a text or a line."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"64.375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/5530d/refs-addon-scenegraph.webp 320w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/0c8fb/refs-addon-scenegraph.webp 640w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/94b1e/refs-addon-scenegraph.webp 1280w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/0b34d/refs-addon-scenegraph.webp 1920w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/d5269/refs-addon-scenegraph.webp 2560w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/be35b/refs-addon-scenegraph.webp 2801w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/dd4a7/refs-addon-scenegraph.png 320w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/0f09e/refs-addon-scenegraph.png 640w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/bbbf7/refs-addon-scenegraph.png 1280w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/ac7a9/refs-addon-scenegraph.png 1920w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/c7a69/refs-addon-scenegraph.png 2560w","/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/7ce87/refs-addon-scenegraph.png 2801w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/75ca40da706a1daf661fcf276d3d23e8/bbbf7/refs-addon-scenegraph.png",alt:"refs addon scenegraph",title:"refs addon scenegraph",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"Such a structure is referred to as the ",(0,o.mdx)("strong",{parentName:"p"},"Scenegraph"),", and it allows for efficient rendering, manipulation, and traversal of all scene elements."),(0,o.mdx)("h3",{id:"object-oriented-programming-concepts"},"Object-Oriented programming concepts"),(0,o.mdx)("p",null,"Understanding the hierarchical tree of nodes in the Adobe Express DOM requires a firm grasp of a handful of key concepts in object-oriented programming (OOP)."),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Classes"),": the blueprint for creating objects. They define a set of properties and methods the created objects (known as ",(0,o.mdx)("em",{parentName:"li"},"instances")," of that class) will have. For example, when users add a page to an Adobe Express document, a new ",(0,o.mdx)("inlineCode",{parentName:"li"},"PageNode")," class is ",(0,o.mdx)("em",{parentName:"li"},"instantiated"),". Such a Page instance comes by default with a peculiar set of accessors (properties) like ",(0,o.mdx)("inlineCode",{parentName:"li"},"width"),", ",(0,o.mdx)("inlineCode",{parentName:"li"},"height"),", and ",(0,o.mdx)("inlineCode",{parentName:"li"},"artboards")," and methods like ",(0,o.mdx)("inlineCode",{parentName:"li"},"removeFromParent()"),"."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Inheritance"),": classes can inherit properties and methods from an existing class. The ",(0,o.mdx)("inlineCode",{parentName:"li"},"LineNode")," inherits from the ",(0,o.mdx)("inlineCode",{parentName:"li"},"StrokableNode"),", which in turn inherits from the ",(0,o.mdx)("inlineCode",{parentName:"li"},"Node")," class, establishing a parent/child relation."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Class Extension"),": this concept is closely related to Inheritance. A child class inherits the methods and properties from its parent and extends them with its additional ones. ",(0,o.mdx)("inlineCode",{parentName:"li"},"TextNode")," extends ",(0,o.mdx)("inlineCode",{parentName:"li"},"Node"),", adding, among others, the ",(0,o.mdx)("inlineCode",{parentName:"li"},"text")," property and the ",(0,o.mdx)("inlineCode",{parentName:"li"},"setPositionInParent()")," method."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Interfaces"),": define a ",(0,o.mdx)("em",{parentName:"li"},"contract")," for classes without implementing any behavior themselves. They specify a set of methods and properties a class must have but do not define how they work internally. For example, the ",(0,o.mdx)("inlineCode",{parentName:"li"},"ContainerNode")," interface mandates the implementation of ",(0,o.mdx)("inlineCode",{parentName:"li"},"allChildren"),", ",(0,o.mdx)("inlineCode",{parentName:"li"},"children"),", ",(0,o.mdx)("inlineCode",{parentName:"li"},"parent"),", and ",(0,o.mdx)("inlineCode",{parentName:"li"},"type")," properties. Classes implementing this interface, such as ",(0,o.mdx)("inlineCode",{parentName:"li"},"ArtboardNode")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"GroupNode"),", are responsible for providing these properties' actual implementation. By doing so, these classes conform to the structure and requirements defined by the ",(0,o.mdx)("inlineCode",{parentName:"li"},"ContainerNode")," interface. Interfaces can be extended, too: the ",(0,o.mdx)("inlineCode",{parentName:"li"},"ColorFill")," inherits the ",(0,o.mdx)("inlineCode",{parentName:"li"},"type")," property from the ",(0,o.mdx)("inlineCode",{parentName:"li"},"Fill")," interface and extends it with an additional ",(0,o.mdx)("inlineCode",{parentName:"li"},"color"),".")),(0,o.mdx)("p",null,"Compared to other Adobe desktop applications, the Adobe Express DOM features a remarkably clean class hierarchy, where every element has a well-defined lineage that traces back to a minimal set of root classes."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"15.625%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/5530d/refs-addon-hierarchy.webp 320w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/0c8fb/refs-addon-hierarchy.webp 640w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/94b1e/refs-addon-hierarchy.webp 1280w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/0b34d/refs-addon-hierarchy.webp 1920w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/d5269/refs-addon-hierarchy.webp 2560w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/9b54d/refs-addon-hierarchy.webp 2602w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/dd4a7/refs-addon-hierarchy.png 320w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/0f09e/refs-addon-hierarchy.png 640w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/bbbf7/refs-addon-hierarchy.png 1280w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/ac7a9/refs-addon-hierarchy.png 1920w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/c7a69/refs-addon-hierarchy.png 2560w","/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/de60c/refs-addon-hierarchy.png 2602w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/6758ad8b93a000e5f6697c4a9ec8aa16/bbbf7/refs-addon-hierarchy.png",alt:"refs addon hierarchy",title:"refs addon hierarchy",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h3",{id:"how-to-read-the-reference"},"How to read the Reference"),(0,o.mdx)("p",null,"With this knowledge, you can use the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/"},"Document APIs")," reference as the primary tool to study and learn about the Adobe Express DOM."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"36.875%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/5530d/refs-addon-doc.webp 320w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/0c8fb/refs-addon-doc.webp 640w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/94b1e/refs-addon-doc.webp 1280w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/0b34d/refs-addon-doc.webp 1920w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/f3963/refs-addon-doc.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/dd4a7/refs-addon-doc.png 320w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/0f09e/refs-addon-doc.png 640w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/bbbf7/refs-addon-doc.png 1280w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/ac7a9/refs-addon-doc.png 1920w","/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/6482f/refs-addon-doc.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/fa6d710ff7c4a94775020a91c8919f79/bbbf7/refs-addon-doc.png",alt:"refs addon doc",title:"refs addon doc",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"There is a comprehensive list of Classes (",(0,o.mdx)("em",{parentName:"p"},"blueprints"),"), Interfaces (",(0,o.mdx)("em",{parentName:"p"},"contracts"),"), and Constants in the left navigation bar. Familiarize yourself with this content and learn how to read it."),(0,o.mdx)("p",null,"Using the ",(0,o.mdx)("inlineCode",{parentName:"p"},"EllipseNode")," as an example, you can find:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"The ",(0,o.mdx)("strong",{parentName:"li"},"class name"),", always PascalCase."),(0,o.mdx)("li",{parentName:"ul"},"A short ",(0,o.mdx)("strong",{parentName:"li"},"description")," of what it represents and its role in the scenegraph."),(0,o.mdx)("li",{parentName:"ul"},"The ",(0,o.mdx)("strong",{parentName:"li"},"inheritance tree"),": in this case, ",(0,o.mdx)("inlineCode",{parentName:"li"},"EllipseNode")," is a subclass of ",(0,o.mdx)("inlineCode",{parentName:"li"},"FillableNode"),"; following the chain, you'll find that, in turn, this inherits from ",(0,o.mdx)("inlineCode",{parentName:"li"},"StrokableNode"),", which eventually comes from the ",(0,o.mdx)("inlineCode",{parentName:"li"},"Node")," root class."),(0,o.mdx)("li",{parentName:"ul"},"A list of ",(0,o.mdx)("strong",{parentName:"li"},"accessors")," (properties), like ",(0,o.mdx)("inlineCode",{parentName:"li"},"stroke"),", ",(0,o.mdx)("inlineCode",{parentName:"li"},"opacity"),", etc."),(0,o.mdx)("li",{parentName:"ul"},"A list of ",(0,o.mdx)("strong",{parentName:"li"},"methods"),", like ",(0,o.mdx)("inlineCode",{parentName:"li"},"removeFromParent()")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"setPositionInParent()"),".")),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"62.5%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/5530d/refs-addon-ref.webp 320w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/0c8fb/refs-addon-ref.webp 640w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/94b1e/refs-addon-ref.webp 1280w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/0b34d/refs-addon-ref.webp 1920w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/f3963/refs-addon-ref.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/dd4a7/refs-addon-ref.png 320w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/0f09e/refs-addon-ref.png 640w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/bbbf7/refs-addon-ref.png 1280w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/ac7a9/refs-addon-ref.png 1920w","/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/6482f/refs-addon-ref.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/2087150422f9f50ed159e3b65d5f1192/bbbf7/refs-addon-ref.png",alt:"refs addon ref",title:"refs addon ref",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"Some accessors are read-only, for instance, parent or rotation; some have ",(0,o.mdx)("strong",{parentName:"p"},"getters")," and ",(0,o.mdx)("strong",{parentName:"p"},"setters"),", like ",(0,o.mdx)("inlineCode",{parentName:"p"},"locked")," or ",(0,o.mdx)("inlineCode",{parentName:"p"},"fill"),". Properties can support a range of value kinds, from primitive values to objects, class instances, or collections. Let's break down the ",(0,o.mdx)("inlineCode",{parentName:"p"},"translation")," property as an example."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"62.5%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/5530d/refs-addon-accessor.webp 320w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/0c8fb/refs-addon-accessor.webp 640w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/94b1e/refs-addon-accessor.webp 1280w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/0b34d/refs-addon-accessor.webp 1920w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/f3963/refs-addon-accessor.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/dd4a7/refs-addon-accessor.png 320w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/0f09e/refs-addon-accessor.png 640w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/bbbf7/refs-addon-accessor.png 1280w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/ac7a9/refs-addon-accessor.png 1920w","/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/6482f/refs-addon-accessor.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/3b70098a406f8a65a9f6064592c32e47/bbbf7/refs-addon-accessor.png",alt:"refs addon accessor",title:"refs addon accessor",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"It's split into two parts: ",(0,o.mdx)("inlineCode",{parentName:"p"},"get")," (the getter, when you read the property) and ",(0,o.mdx)("inlineCode",{parentName:"p"},"set")," (the setter, when you write it). From the description, you see that it's a way to find out about the node's coordinates relative to its parent. The return type for the getter (wrapped with ",(0,o.mdx)("inlineCode",{parentName:"p"},"< >")," angle brackets) is ",(0,o.mdx)("inlineCode",{parentName:"p"},"{ x: number, y: number}"),", i.e. an object with numeric ",(0,o.mdx)("inlineCode",{parentName:"p"},"x")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"y")," properties. You also read that this property is inherited from the ",(0,o.mdx)("inlineCode",{parentName:"p"},"FillableNode")," class that ",(0,o.mdx)("inlineCode",{parentName:"p"},"EllipseNode")," extends. The setter expects a ",(0,o.mdx)("inlineCode",{parentName:"p"},"value"),", which the Parameters table describes as of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"Object"),", with the same numeric ",(0,o.mdx)("inlineCode",{parentName:"p"},"x")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"y")," properties; it returns ",(0,o.mdx)("inlineCode",{parentName:"p"},"void")," (i.e., nothing). Given all this, it's possible to confidently write something along these lines."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"const ellipse = editor.createEllipse();\neditor.context.insertionParent.children.append(ellipse); // attach to the scenegraph\nconsole.log(ellipse.translation); // { x: 0, y: 0 }\nellipse.translation = { x: 100, y: 50 };\n")),(0,o.mdx)("p",null,"Some properties rely on interfaces to define their type. The ellipse's ",(0,o.mdx)("inlineCode",{parentName:"p"},"stroke")," happens to be of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"Stroke"),", an interface whose ",(0,o.mdx)("em",{parentName:"p"},"contract")," mandates the implementation of five different properties: ",(0,o.mdx)("inlineCode",{parentName:"p"},"color"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"width"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"position"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"dashPattern"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"dashOffset"),"."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"81.5625%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/5530d/refs-addon-stroke.webp 320w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/0c8fb/refs-addon-stroke.webp 640w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/94b1e/refs-addon-stroke.webp 1280w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/0b34d/refs-addon-stroke.webp 1920w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/f3963/refs-addon-stroke.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/dd4a7/refs-addon-stroke.png 320w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/0f09e/refs-addon-stroke.png 640w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/bbbf7/refs-addon-stroke.png 1280w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/ac7a9/refs-addon-stroke.png 1920w","/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/6482f/refs-addon-stroke.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/e54e7bee50ade8bcbe0710446a747767/bbbf7/refs-addon-stroke.png",alt:"refs addon stroke",title:"refs addon stroke",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h3",{id:"the-importance-of-constants"},"The importance of Constants"),(0,o.mdx)("p",null,"Let's use the ",(0,o.mdx)("inlineCode",{parentName:"p"},"stroke")," to demonstrate the use of Constants in the DOM. They are a named import—mind the lowercase spelling."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, colorUtils, constants } from "express-document-sdk";\n')),(0,o.mdx)("p",null,"They represent a safe, user-friendly way to refer to internal values (subject to change) that developers should not directly manipulate. For example, the stroke's ",(0,o.mdx)("inlineCode",{parentName:"p"},"position")," property is of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"StrokePosition"),", which happens to be enumerable—a fixed set of pre-defined values."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"62.5%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/5530d/refs-addon-strokeposition.webp 320w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/0c8fb/refs-addon-strokeposition.webp 640w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/94b1e/refs-addon-strokeposition.webp 1280w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/0b34d/refs-addon-strokeposition.webp 1920w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/f3963/refs-addon-strokeposition.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/dd4a7/refs-addon-strokeposition.png 320w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/0f09e/refs-addon-strokeposition.png 640w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/bbbf7/refs-addon-strokeposition.png 1280w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/ac7a9/refs-addon-strokeposition.png 1920w","/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/6482f/refs-addon-strokeposition.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/b6e7875c68423d7e2f320d25c33620c6/bbbf7/refs-addon-strokeposition.png",alt:"refs addon strokeposition",title:"refs addon strokeposition",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"Internally, the center, inside, and outside positions are represented with the integers ",(0,o.mdx)("inlineCode",{parentName:"p"},"0"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"1"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"2"),". You should instead use the ",(0,o.mdx)("inlineCode",{parentName:"p"},"StrokePosition")," constant and its available members:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"StrokePosition.center")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"StrokePosition.inside")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"StrokePosition.outside"))),(0,o.mdx)("p",null,"Using constants will ensure expected outcomes, in case Adobe Express engineers remap values in the future. This is the code needed to conclude the ",(0,o.mdx)("inlineCode",{parentName:"p"},"stroke")," example."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"const ellipse = editor.createEllipse();\neditor.context.insertionParent.children.append(ellipse);\nellipse.stroke = {\n  color: { red: 0.7, green: 0.6, blue: 1, alpha: 1 },\n  dashOffset: 0,\n  dashPattern: [4, 2],\n  // position: 1 ❌\n  position: constants.StrokePosition.inside, // ✅\n  width: 3,\n};\n")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("a",{parentName:"p",href:"../how_to/tutorials/stats-addon.md"},"Document Stats tutorial")," features an add-on that goes through all elements in the scenegraph and groups them by ",(0,o.mdx)("inlineCode",{parentName:"p"},"type"),", providing a count of each: ",(0,o.mdx)("inlineCode",{parentName:"p"},"ComplexShape"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"Group"),", etc."),(0,o.mdx)("p",null,(0,o.mdx)("img",{parentName:"p",src:"/express-add-ons-docs/assets/0bd437229c8ac38756f7e599371074bd/stats-addon-animation.gif",alt:null})),(0,o.mdx)("p",null,"To log the ",(0,o.mdx)("inlineCode",{parentName:"p"},"type")," property is acceptable in this specific case, although the proper way to check against node types involves constants; the ",(0,o.mdx)("inlineCode",{parentName:"p"},"type")," itself is an internal string value mapped to the ",(0,o.mdx)("inlineCode",{parentName:"p"},"SceneNodeType")," enumerable."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'❌ if (someNode.type === "ab:Artboard") { /* ... */ }\n✅ if (someNode.type === constants.SceneNodeType.artboard) { /* ... */ }\n')),(0,o.mdx)("h3",{id:"helper-functions"},"Helper functions"),(0,o.mdx)("p",null,"Let's return to strokes and fills: they are expressed as plain objects; in fact, all the properties the ",(0,o.mdx)("inlineCode",{parentName:"p"},"Stroke")," interface requires, like ",(0,o.mdx)("inlineCode",{parentName:"p"},"dashPattern"),", were previously provided. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"editor.makeStroke()")," utility will fill in the default values when you don't provide them."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"const ellipse = editor.createEllipse();\neditor.context.insertionParent.children.append(ellipse);\nellipse.stroke = editor.makeStroke({\n  color: { red: 0.7, green: 0.6, blue: 1, alpha: 1 },\n});\n")),(0,o.mdx)("p",null,"Here, you get a 1-pixel, solid stroke of the provided color, the only property you've explicitly supplied. There's a similar helper function for the ",(0,o.mdx)("inlineCode",{parentName:"p"},"ColorFill")," interface."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"ellipse.fill = editor.makeColorFill({\n  red: 0.6,\n  green: 0.9,\n  blue: 0.6,\n  alpha: 1,\n});\n")),(0,o.mdx)("p",null,"If you wonder where all the help is since you've to type the entire color object manually anyway, let me remind you that the ",(0,o.mdx)("inlineCode",{parentName:"p"},"fill")," property is of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"ColorFill"),": such an interface expects a ",(0,o.mdx)("inlineCode",{parentName:"p"},"color")," property (the one provided above) as well as a ",(0,o.mdx)("inlineCode",{parentName:"p"},"type")," expressed by the ",(0,o.mdx)("inlineCode",{parentName:"p"},"FillType.color")," constants. Without the ",(0,o.mdx)("inlineCode",{parentName:"p"},"makeColorFill()")," method, you must write the following."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"ellipse.fill = {\n  color: { red: 0.6, green: 0.9, blue: 0.6, alpha: 1 },\n  type: constants.FillType.color, // 👈\n};\n")),(0,o.mdx)(l,{variant:"info",slots:"text1, text2",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"A specific ",(0,o.mdx)("strong",{parentName:"p"},"naming convention")," exists for methods used in the Adobe Express DOM."),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"make*"),": used for plain objects and helper utilities, e.g.,",(0,o.mdx)("inlineCode",{parentName:"li"},"makeColorFill()"),"."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"create*"),": used for live document objects, like ",(0,o.mdx)("inlineCode",{parentName:"li"},"createEllipse()")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("inlineCode",{parentName:"li"},"add*"),": reserved to create complex structures like Pages and Artboards, adding them to the parent list automatically in a way that may also update the insertion point. Found in ",(0,o.mdx)("inlineCode",{parentName:"li"},"addPage()")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"addArtboard()"),".")),(0,o.mdx)("p",null,"Speaking of colors, the ",(0,o.mdx)("inlineCode",{parentName:"p"},"ColorUtils")," module can output a proper ",(0,o.mdx)("inlineCode",{parentName:"p"},"Color")," from either a partial RGB object (where the ",(0,o.mdx)("inlineCode",{parentName:"p"},"alpha")," property is optional, defaulting to ",(0,o.mdx)("inlineCode",{parentName:"p"},"1"),") or a Hex string with or without alpha, providing the reverse function as well."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'const gecko = colorUtils.fromHex("#9de19a"); // alpha is optional\n// or\nconst gecko = colorUtils.fromRGB(157, 225, 154); // alpha is optional\nellipse.fill = editor.makeColorFill(gecko);\nconst geckoHex = colorUtils.toHex(gecko); // "#9de19aff" 👈 alpha is included\n')),(0,o.mdx)("h3",{id:"types-matter"},"Types matter"),(0,o.mdx)("p",null,"CLI versions from ",(0,o.mdx)("inlineCode",{parentName:"p"},'"1.1.1"')," onwards now scaffold add-ons with ",(0,o.mdx)("strong",{parentName:"p"},"type definitions")," for JavaScript and TypeScript projects. If you're unfamiliar with TypeScript, these additional ",(0,o.mdx)("inlineCode",{parentName:"p"},".d.ts")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"tsconfig.json")," files offer significant benefits. The ",(0,o.mdx)("inlineCode",{parentName:"p"},".d.ts")," files, or ",(0,o.mdx)("em",{parentName:"p"},"TypeScript declarations"),", contain type information about the APIs. They describe the shape of JavaScript objects, providing TypeScript type-checking and autocompletion capabilities (in the form of IntelliSense in VSCode). The ",(0,o.mdx)("inlineCode",{parentName:"p"},"tsconfig.json")," files, on the other hand, are configuration files necessary to provide type information for global types in the sandbox runtime. For instance, the sandbox' Console only exposes a subset of the available methods: the ",(0,o.mdx)("inlineCode",{parentName:"p"},"tsconfig.json")," file (via ",(0,o.mdx)("inlineCode",{parentName:"p"},"typeRoots"),") informs the IntelliSense engine only to show the methods that are actually available."),(0,o.mdx)("p",null,"The bottom line is that ",(0,o.mdx)("inlineCode",{parentName:"p"},".d.ts")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"tsconfig.json")," files in your JavaScript (and TypeScript) projects give code editors knowledge about the Adobe Express document sandbox APIs: it's used to provide code completion and type checking, which can help you avoid errors and write code faster."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.62500000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/5530d/refs-addon-intellisense.webp 320w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/0c8fb/refs-addon-intellisense.webp 640w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/94b1e/refs-addon-intellisense.webp 1280w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/0b34d/refs-addon-intellisense.webp 1920w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/f3963/refs-addon-intellisense.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/dd4a7/refs-addon-intellisense.png 320w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/0f09e/refs-addon-intellisense.png 640w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/bbbf7/refs-addon-intellisense.png 1280w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/ac7a9/refs-addon-intellisense.png 1920w","/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/6482f/refs-addon-intellisense.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/9453b02c514bbbc1e5a7d5c2be05cb55/bbbf7/refs-addon-intellisense.png",alt:"refs addon intellisense",title:"refs addon intellisense",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)(l,{variant:"info",slots:"text1, text2, text3",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"To use TypeScript declarations in existing projects, install the ",(0,o.mdx)("inlineCode",{parentName:"p"},"@adobe/ccweb-add-on-sdk-types")," package."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-sh"},"npm install @adobe/ccweb-add-on-sdk-types --saveDev\n")),(0,o.mdx)("p",null,"The ",(0,o.mdx)("inlineCode",{parentName:"p"},".d.ts")," files can be found in the ",(0,o.mdx)("inlineCode",{parentName:"p"},"node_modules/@adobe/ccweb-add-on-sdk-types")," folder."),(0,o.mdx)("p",null,"While IntelliSense is undoubtedly handy, type safety can prevent errors that are otherwise difficult to foresee. Let me show you a revealing example."),(0,o.mdx)("p",null,"Several classes in the Adobe Express DOM have a ",(0,o.mdx)("inlineCode",{parentName:"p"},"children")," property, like ",(0,o.mdx)("inlineCode",{parentName:"p"},"GroupNode")," or ",(0,o.mdx)("inlineCode",{parentName:"p"},"ArtboardNode"),"—both implementing the ",(0,o.mdx)("inlineCode",{parentName:"p"},"ContainerNode")," interface. Intuitively, their ",(0,o.mdx)("inlineCode",{parentName:"p"},"children")," are the contained elements: a group can hold bitmap images, shapes, and whatnot. ",(0,o.mdx)("inlineCode",{parentName:"p"},"ContainerNode")," also mandates the implementation of an ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," property, which, apparently, serves the same purpose (we'll get to the difference in a moment)."),(0,o.mdx)("p",null,"The type for ",(0,o.mdx)("inlineCode",{parentName:"p"},"children")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," is defined as ",(0,o.mdx)("inlineCode",{parentName:"p"},"Iterable<Node>"),", where the ",(0,o.mdx)("inlineCode",{parentName:"p"},"Iterable")," is basically a collection that supports a ",(0,o.mdx)("inlineCode",{parentName:"p"},"for...of")," loop."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"for (const node of someIterable) {\n  console.log(node.type);\n}\n")),(0,o.mdx)("p",null,"In ",(0,o.mdx)("em",{parentName:"p"},"previous versions")," of Adobe Express, the Console would log ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," as an actual ",(0,o.mdx)("em",{parentName:"p"},"Array")," of Nodes."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"35.625%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/5530d/refs-addon-allchildren.webp 320w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/0c8fb/refs-addon-allchildren.webp 640w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/94b1e/refs-addon-allchildren.webp 1280w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/0b34d/refs-addon-allchildren.webp 1920w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/bad56/refs-addon-allchildren.webp 2374w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/dd4a7/refs-addon-allchildren.png 320w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/0f09e/refs-addon-allchildren.png 640w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/bbbf7/refs-addon-allchildren.png 1280w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/ac7a9/refs-addon-allchildren.png 1920w","/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/e2156/refs-addon-allchildren.png 2374w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/fc6ad9ae6afe1d1e8685f9c69debe7a8/bbbf7/refs-addon-allchildren.png",alt:"refs addon allchildren",title:"refs addon allchildren",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"If ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," is an Array, the following code will work just fine, won't it?"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"const selectedNode = editor.context.selection[0];\n// If we have a group\nif (selectedNode.type === constants.SceneNodeType.group) {\n  // Filtering the ellipse shapes\n  const ellipses = selectedNode.allChildren.filter(\n    // 👈 danger! ❌\n    (node) => node.type === constants.SceneNodeType.ellipse\n  );\n  console.log(`Number of ellipses in this group: ${ellipses.length}`);\n}\n")),(0,o.mdx)("p",null,"In fact, it ",(0,o.mdx)("em",{parentName:"p"},"used to work"),", but it doesn't anymore; however, it's not Adobe Express' fault. Why, then?"),(0,o.mdx)("p",null,"The ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," property is defined in its ",(0,o.mdx)("em",{parentName:"p"},"contract")," to be of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"Iterable"),". The key point here is ",(0,o.mdx)("strong",{parentName:"p"},"the nature of the contract")," itself rather than the specific implementation. For instance, when ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," was internally implemented as an Array, this was in line with the contract since Arrays are indeed iterable and support the ",(0,o.mdx)("inlineCode",{parentName:"p"},"for...of")," loop. However, Arrays offer additional functionalities ",(0,o.mdx)("em",{parentName:"p"},"beyond")," the requirements of the ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," contract. Developers should focus on using features that the contract explicitly supports rather than relying on capabilities that might be available in the current implementation of the property but are ",(0,o.mdx)("em",{parentName:"p"},"outside the contract's scope"),". This approach ensures compatibility and reliability, irrespective of the property's underlying implementation changes. If you must use Array methods, convert the iterable with the static method ",(0,o.mdx)("inlineCode",{parentName:"p"},"Array.from()")," first."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"const ellipses = Array.from(selectedNode.allChildren) // 👈\n  .filter((node) => node.type === constants.SceneNodeType.ellipse);\n")),(0,o.mdx)("p",null,"To finally unravel the ",(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," purpose mystery, let's see what the documentation says about it."),(0,o.mdx)("blockquote",null,(0,o.mdx)("p",{parentName:"blockquote"},"[",'...] nodes with a more specific structure can hold children in various discrete "slots"; this ',(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," list includes ",(0,o.mdx)("em",{parentName:"p"},"all")," such children and reflects their overall display z-order.")),(0,o.mdx)("p",null,"If you inspect a ",(0,o.mdx)("inlineCode",{parentName:"p"},"MediaContainerNode")," class, which is instantiated every time you place an image, it has two peculiar properties: ",(0,o.mdx)("inlineCode",{parentName:"p"},"maskShape")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"mediaRectangle"),". They hold the shape that masks the bitmap (in UI terms, the Crop—by default, a rectangle with the same image dimensions) and the ",(0,o.mdx)("inlineCode",{parentName:"p"},"ImageRectangleNode"),' itself. They are the "structures" the documentation refers to; therefore, you\'ll find them in its ',(0,o.mdx)("inlineCode",{parentName:"p"},"allChildren")," property. Other notable examples are ",(0,o.mdx)("inlineCode",{parentName:"p"},"maskShape")," in Groups and ",(0,o.mdx)("inlineCode",{parentName:"p"},"artboards")," in Pages."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.3125%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/2053d4208854616d436cb34549978825/5530d/refs-addon-mediacontainer.webp 320w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/0c8fb/refs-addon-mediacontainer.webp 640w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/94b1e/refs-addon-mediacontainer.webp 1280w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/0b34d/refs-addon-mediacontainer.webp 1920w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/f3963/refs-addon-mediacontainer.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/2053d4208854616d436cb34549978825/dd4a7/refs-addon-mediacontainer.png 320w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/0f09e/refs-addon-mediacontainer.png 640w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/bbbf7/refs-addon-mediacontainer.png 1280w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/ac7a9/refs-addon-mediacontainer.png 1920w","/express-add-ons-docs/static/2053d4208854616d436cb34549978825/6482f/refs-addon-mediacontainer.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/2053d4208854616d436cb34549978825/bbbf7/refs-addon-mediacontainer.png",alt:"refs addon mediacontainer",title:"refs addon mediacontainer",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h2",{id:"classes-and-interfaces"},"Classes and Interfaces"),(0,o.mdx)("p",null,"The Reference documentation does a good job listing all the classes and interfaces that make up the Adobe Express DOM, but there are classification differences worth knowing."),(0,o.mdx)("h3",{id:"live-object-classes"},"Live Object classes"),(0,o.mdx)("p",null,"Concrete classes like ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/RectangleNode.md%22"},(0,o.mdx)("inlineCode",{parentName:"a"},"RectangleNode"))," and ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/GroupNode.md%22"},(0,o.mdx)("inlineCode",{parentName:"a"},"GroupNode"))," represent the DOM's ",(0,o.mdx)("strong",{parentName:"p"},"object elements with live setters"),". Some of these classes can be instantiated and used directly through factory methods."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor } from "express-document-sdk";\n\nconst rect = editor.createRectangle();\nconst group = editor.createGroup();\ngroup.children.append(rect);\neditor.context.insertionParent.children.append(group);\n')),(0,o.mdx)("p",null,"Currently, only some classes of this kind have their equivalent ",(0,o.mdx)("inlineCode",{parentName:"p"},"create*")," method (for example, ",(0,o.mdx)("inlineCode",{parentName:"p"},"PathNode")," lacks it), but it's fair to expect that most of them will, eventually. Live Object classes are the ones whose instances make up the Adobe Express scenegraph: ",(0,o.mdx)("inlineCode",{parentName:"p"},"PageNode"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"ArtboardNode"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"StrokeShapeNode"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"LineNode"),", and so on.\nA particular case is represented by the ",(0,o.mdx)("inlineCode",{parentName:"p"},"UnknownNode"),", which acts as a safety placeholder when dealing with actual DOM objects that don't yet have a corresponding class."),(0,o.mdx)("h3",{id:"collection-classes"},"Collection classes"),(0,o.mdx)("p",null,"In Adobe Express, most collections (",(0,o.mdx)("inlineCode",{parentName:"p"},"children")," is a notable example) are expressed as ",(0,o.mdx)("strong",{parentName:"p"},"Lists"),": groups of homogeneous elements with properties such as ",(0,o.mdx)("inlineCode",{parentName:"p"},"first"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"last"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"length"),", and dedicated methods like ",(0,o.mdx)("inlineCode",{parentName:"p"},"append()"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"clear()"),", etc. They are iterable with ",(0,o.mdx)("inlineCode",{parentName:"p"},"for...of")," loops."),(0,o.mdx)("p",null,"Some of these collections are Generic, like ",(0,o.mdx)("inlineCode",{parentName:"p"},"ItemList<T>"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"ReadOnlyItemList<T>"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"RestrictedItemList<T>"),", where the ",(0,o.mdx)("inlineCode",{parentName:"p"},"<T>")," means they are designed to be type-agnostic and can work with various data types. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"<T>")," acts as a placeholder for the type of objects that the collection will hold or manage."),(0,o.mdx)("p",null,"An implementation of such generic classes is the ",(0,o.mdx)("inlineCode",{parentName:"p"},"ArtboardList")," (which subclasses ",(0,o.mdx)("inlineCode",{parentName:"p"},"RestrictedItemList<Artboard>"),") and ",(0,o.mdx)("inlineCode",{parentName:"p"},"PageList")," (subclassing ",(0,o.mdx)("inlineCode",{parentName:"p"},"RestrictedItemList<Page>"),"), found respectively in the ",(0,o.mdx)("inlineCode",{parentName:"p"},"PageNode.artboards")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"ExpressRootNode.pages")," properties."),(0,o.mdx)("h3",{id:"abstract-classes"},"Abstract classes"),(0,o.mdx)("p",null,"These are classes that serve as a ",(0,o.mdx)("strong",{parentName:"p"},"base for other classes"),". Used by Adobe to rationalize the DOM structure, they provide a common set of properties and methods, but typically cannot be instantiated themselves nor manipulated by add-on developers. Instead, they are meant to be inherited and extended by other subclasses. These subclasses can then implement the abstract class's methods. In the Reference, you can identify abstract classes such as ",(0,o.mdx)("inlineCode",{parentName:"p"},"FillableNode"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"Node"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"BaseNode"),"."),(0,o.mdx)("h3",{id:"static-classes"},"Static classes"),(0,o.mdx)("p",null,(0,o.mdx)("inlineCode",{parentName:"p"},"Editor")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"ColorUtils")," are special ",(0,o.mdx)("strong",{parentName:"p"},"Singleton classes")," that aren't meant to be instantiated or extended; the former acts as the entry point for APIs that read or modify the document's content, whereas the latter provides static utility methods for color manipulation. They are brought into the scope as lowercase named imports from the ",(0,o.mdx)("inlineCode",{parentName:"p"},'"express-document-sdk"'),"."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, colorUtils } from "express-document-sdk";\n')),(0,o.mdx)("h3",{id:"object-pojo-interfaces"},"Object (POJO) Interfaces"),(0,o.mdx)("p",null,"Such interfaces define the properties of ",(0,o.mdx)("strong",{parentName:"p"},"actual JavaScript objects")," that must be created and used, for example, to set a shape's ",(0,o.mdx)("inlineCode",{parentName:"p"},"fill")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"stroke")," (respectively, the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/interfaces/ColorFill.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"ColorFill"))," or ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/interfaces/Stroke.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"Stroke"))," interfaces) or fed to utility functions like ",(0,o.mdx)("inlineCode",{parentName:"p"},"colorUtils.fromRGB()")," that expect a parameter that implements the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/interfaces/Color.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"Color"))," interface. They are the ",(0,o.mdx)("em",{parentName:"p"},"contracts"),' that establish the shape of actual JavaScript objects that developers use in their code. POJO is an acronym that stands for "Plain Old Java Object", which in this context refers to a plain JavaScript object.'),(0,o.mdx)("h3",{id:"implementable-interfaces"},"Implementable Interfaces"),(0,o.mdx)("p",null,"Implementable interfaces like ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/interfaces/IFillableNode.md%22"},(0,o.mdx)("inlineCode",{parentName:"a"},"IFillableNode"))," are only meant to be implemented by classes: they define a contract of properties and methods to which a class must adhere."),(0,o.mdx)("p",null,"In summary, the distinction between all the listed categories lies in their ",(0,o.mdx)("em",{parentName:"p"},"purpose and usage"),': "concrete" classes and object interfaces are used to create actual objects (either JavaScript objects, node instances, or collections), while abstract classes and implementable interfaces provide structure and behaviors that other classes can inherit or implement.'),(0,o.mdx)("h2",{id:"from-theory-to-practice"},"From theory to practice"),(0,o.mdx)("p",null,"Experimenting with newly acquired knowledge is one of the most effective methods to test it. Let's say you have an idea for an add-on that traces the dimensions of the selected object in the style of technical drawings."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"57.50000000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/5530d/refs-addon-draw.webp 320w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/0c8fb/refs-addon-draw.webp 640w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/94b1e/refs-addon-draw.webp 1280w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/0b34d/refs-addon-draw.webp 1920w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/f3963/refs-addon-draw.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/dd4a7/refs-addon-draw.png 320w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/0f09e/refs-addon-draw.png 640w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/bbbf7/refs-addon-draw.png 1280w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/ac7a9/refs-addon-draw.png 1920w","/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/6482f/refs-addon-draw.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/043d93ced3a4abb9db33481cbc6f3708/bbbf7/refs-addon-draw.png",alt:"refs addon draw",title:"refs addon draw",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"The production of such an add-on would require a number of stages, starting from the MVP (Minimum Viable Product) feature set to the UI. Here, you'll focus exclusively on the DOM prototyping; that is to say, you'll try to figure out the code building blocks by navigating the documentation reference alone—it will be an excellent exercise to get accustomed to it. Every step will be carefully described here; for simplicity, the add-on will be restricted to drawing dimensions on ",(0,o.mdx)("inlineCode",{parentName:"p"},"MediaContainer")," objects, assuming no crop has been applied."),(0,o.mdx)("p",null,"To follow along, add one button to the ",(0,o.mdx)("inlineCode",{parentName:"p"},"index.html")," file and attach a ",(0,o.mdx)("inlineCode",{parentName:"p"},"drawDimensions()")," function to it in ",(0,o.mdx)("inlineCode",{parentName:"p"},"code.js"),"."),(0,o.mdx)(c,{slots:"heading, code",repeat:"3",languages:"index.html, ui/index.js, documentSandbox/code.js",mdxType:"CodeBlock"}),(0,o.mdx)("h4",{id:"ui-iframe"},"UI iframe"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-html"},'<body>\n  <sp-theme\n    scale="medium"\n    color="light"\n    theme="express"\n  >\n    <sp-button id="logNode">Log selected node</sp-button>\n    <sp-button id="drawDimensions">Draw Dimensions</sp-button>\n  </sp-theme>\n</body>\n')),(0,o.mdx)("h4",{id:"ui-iframe-1"},"UI iframe"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'// ...\naddOnUISdk.ready.then(async () => {\n  console.log("addOnUISdk is ready for use.");\n\n  // Get the Authoring Sandbox.\n  const { runtime } = addOnUISdk.instance;\n  const sandboxProxy = await runtime.apiProxy("documentSandbox");\n\n  const buttonIds = ["logNode", "drawDimensions"];\n  buttonIds.forEach((id) => {\n    const button = document.getElementById(id);\n    button.addEventListener("click", () => {\n      sandboxProxy[id](); // 👈 attach the function to the button, like:\n    }); // sandboxProxy.logNode() or sandboxProxy.drawDimensions()\n    button.disabled = false;\n  });\n});\n')),(0,o.mdx)("h4",{id:"document-sandbox"},"Document Sandbox"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nfunction start() {\n  runtime.exposeApi({\n    logNode: () => {\n      /* ... */\n    },\n    drawDimensions: () => {\n      // ...\n    },\n  });\n}\n")),(0,o.mdx)("h3",{id:"getting-the-context"},"Getting the context"),(0,o.mdx)("p",null,"The first part is to get and validate the selected node. There's a promising ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/Context.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"Context"))," class in the reference documentation that ",(0,o.mdx)("em",{parentName:"p"},'"contains the user\'s current selection state, indicating the content they are focused on"'),". Excellent! But how can you access it, though? The ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/Editor.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"Editor"))," class is the Document API entry point; it may be worth paying a visit to its page. Lo and behold, it exposes a context property, which returns a context instance: you can use it to check if there's a selection and whether it's of the right type—",(0,o.mdx)("inlineCode",{parentName:"p"},"hasSelection")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"selection")," will do the job."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, constants, colorUtils } from "express-document-sdk";\n\nruntime.exposeApi({\n  drawDimensions: () => {\n    if (\n      editor.context.hasSelection &&\n      editor.context.selection[0].type ===\n        constants.SceneNodeType.mediaContainer\n    ) {\n      // ...\n    }\n  },\n});\n')),(0,o.mdx)("p",null,"Please note the use of the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/enumerations/SceneNodeType.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"SceneNodeType"))," constant, as discussed earlier, instead of the ",(0,o.mdx)("inlineCode",{parentName:"p"},'"MediaContainer"')," string literal."),(0,o.mdx)("h3",{id:"getting-the-dimensions"},"Getting the dimensions"),(0,o.mdx)("p",null,"Now that you've made sure only the right kind of node is handled, let's get its dimensions; since you'll need to draw a line, it may be helpful to have its coordinates in space (relative to its parent container) as well. According to the reference, the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/MediaContainerNode.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"MediaContainerNode"))," class provides a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/MediaContainerNode.md#translation"},(0,o.mdx)("inlineCode",{parentName:"a"},"translation"))," property that returns an object with ",(0,o.mdx)("inlineCode",{parentName:"p"},"x")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"y")," properties, which you need. There are no ",(0,o.mdx)("inlineCode",{parentName:"p"},"width")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"height"),", though; where to look? ",(0,o.mdx)("inlineCode",{parentName:"p"},"MediaContainerNode")," also features a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/MediaContainerNode.md#mediarectangle"},(0,o.mdx)("inlineCode",{parentName:"a"},"mediaRectangle"))," property, which, upon inspection, is of type ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/ImageRectangleNode.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"ImageRectangleNode")),": this holds the actual media and offers both ",(0,o.mdx)("inlineCode",{parentName:"p"},"width")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"height")," properties. In future versions, Adobe Express will make available a proper ",(0,o.mdx)("inlineCode",{parentName:"p"},"bounds")," object for this purpose."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"if ( /* ... */ ) {\n  // grabbing the selected node\n  const selectedNode = editor.context.selection[0];\n  // getting its coordinates\n  const nodeTranslation = selectedNode.translation;\n  // getting its dimensions from the mediaRectangle, destucturing and renaming them on the fly\n  const { width: nodeWidth, height: nodeHeight } = selectedNode.mediaRectangle;\n}\n")),(0,o.mdx)("h3",{id:"drawing-a-line"},"Drawing a line"),(0,o.mdx)("p",null,"Time to draw the line. The ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/Editor.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"Editor"))," class includes a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/Editor.md#createline"},(0,o.mdx)("inlineCode",{parentName:"a"},"createLine()"))," factory method, which returns a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/LineNode.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"LineNode"))," instance. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"LineNode")," class, you learn from the reference, has ",(0,o.mdx)("inlineCode",{parentName:"p"},"startX"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"startY"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"endX"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"endY")," properties: they only implement the getter, though—hence, are read-only. Scrolling through the methods, you find ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/LineNode.md#setendpoints"},(0,o.mdx)("inlineCode",{parentName:"a"},"setEndPoints()")),", which expects the same parameters and is used as a setter for them."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nconst hLine = editor.createLine();\nhLine.setEndPoints(\n  nodeTranslation.x,\n  nodeTranslation.y - 20,\n  nodeTranslation.x + nodeWidth,\n  nodeTranslation.y - 20\n);\n")),(0,o.mdx)("p",null,"Here, an arbitrary 20px margin is added between the horizontal line and the selected node; this could very well be a parameter chosen by the user from a UI control you can add later. The line is extended to a ",(0,o.mdx)("inlineCode",{parentName:"p"},"nodeWidth")," length, i.e., the ",(0,o.mdx)("inlineCode",{parentName:"p"},"mediaRectangle"),"'s. You can finally add it to the scenegraph."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"editor.context.insertionParent.children.append(hLine);\n")),(0,o.mdx)(l,{variant:"info",slots:"text1, text2",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"Please note that, according to the documentation, ",(0,o.mdx)("inlineCode",{parentName:"p"},"translation")," is ",(0,o.mdx)("strong",{parentName:"p"},"relative to the node's parent container"),": in other words, you're capturing the position of the ",(0,o.mdx)("inlineCode",{parentName:"p"},"MediaContainerNode")," with respect to its parent. How can you be sure, then, that the line will be drawn in the right place?"),(0,o.mdx)("p",null,"The answer is that the ",(0,o.mdx)("inlineCode",{parentName:"p"},"insertionParent")," property of the ",(0,o.mdx)("inlineCode",{parentName:"p"},"Editor")," class—that you use to append the ",(0,o.mdx)("inlineCode",{parentName:"p"},"hLine"),"—is a special node that always points to the current insertion point in the scenegraph. In this case, you're adding the line to the same parent container of the selected node, so ",(0,o.mdx)("inlineCode",{parentName:"p"},"hLine")," will be positioned correctly with respect to the object it measures: both the ",(0,o.mdx)("inlineCode",{parentName:"p"},"MediaContainerNode")," and the ",(0,o.mdx)("inlineCode",{parentName:"p"},"LineNode")," will be ",(0,o.mdx)("inlineCode",{parentName:"p"},"children")," of ",(0,o.mdx)("em",{parentName:"p"},"the same parent"),", therefore sharing ",(0,o.mdx)("em",{parentName:"p"},"the same relative coordinate space"),"."),(0,o.mdx)("p",null,"The line is there, but it lacks the proper endpoints. The reference helps us out again: the ",(0,o.mdx)("inlineCode",{parentName:"p"},"LineNode")," has a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/LineNode.md#startarrowheadtype"},(0,o.mdx)("inlineCode",{parentName:"a"},"startArrowHeadType"))," and ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/LineNode.md#endarrowheadtype"},(0,o.mdx)("inlineCode",{parentName:"a"},"endArrowHeadType"))," properties, whose value is an enumerable provided by the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/enumerations/ArrowHeadType.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"ArrowHeadType"))," constant.",(0,o.mdx)("sup",{parentName:"p",id:"fnref-3"},(0,o.mdx)("a",{parentName:"sup",href:"#fn-3",className:"footnote-ref"},"3"))," There are several options available: let's pick ",(0,o.mdx)("inlineCode",{parentName:"p"},"triangularFilled"),"."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nhLine.startArrowHeadType = hLine.endArrowHeadType =\n  constants.ArrowHeadType.triangularFilled;\n")),(0,o.mdx)("p",null,"As live objects, setting all the properties before or after appending the line to the scenegraph doesn't really matter; the result is the same."),(0,o.mdx)("h3",{id:"adding-the-text"},"Adding the text"),(0,o.mdx)("p",null,"Next up, you need to add the text. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"Editor")," class provides a ",(0,o.mdx)("a",{parentName:"p",href:"../../../references/document-sandbox/document-apis/classes/Editor.md#createtext"},(0,o.mdx)("inlineCode",{parentName:"a"},"createText()"))," method, which expects a string parameter and returns a ",(0,o.mdx)("a",{parentName:"p",href:"../../../references/document-sandbox/document-apis/classes/StandaloneTextNode.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"StandaloneTextNode"))," instance. Please note that passing a number as a parameter will throw an error—hence the use of ",(0,o.mdx)("inlineCode",{parentName:"p"},".toString()")," below."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nconst hText = editor.createText(`${Math.trunc(nodeWidth).toString()}px`);\neditor.context.insertionParent.children.append(hText);\n")),(0,o.mdx)("p",null,"The text appears on the top-left corner of the document, which is the default insertion point. ",(0,o.mdx)("inlineCode",{parentName:"p"},"setPositionInParent()")," would be perfect to move it to the right spot, just above the line. At the time of this writing, a ",(0,o.mdx)("inlineCode",{parentName:"p"},"TextNode")," doesn't feature ",(0,o.mdx)("inlineCode",{parentName:"p"},"width")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"height")," properties, which would be helpful to set an appropriate ",(0,o.mdx)("inlineCode",{parentName:"p"},"localRegistrationPoint"),"; hence, you'll have to do with ",(0,o.mdx)("inlineCode",{parentName:"p"},"translation"),"."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nhText.translation = {\n  x: nodeTranslation.x + nodeWidth / 2,\n  y: nodeTranslation.y - 30,\n};\n")),(0,o.mdx)("p",null,"An extra 10 pixels padding from the line has been added, but this could also be a parameter. Let's group the line and the text together to move them around as a single entity. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"Editor")," class provides a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/Editor.md#creategroup"},(0,o.mdx)("inlineCode",{parentName:"a"},"createGroup()"))," method, which returns a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/GroupNode.md"},(0,o.mdx)("inlineCode",{parentName:"a"},"GroupNode"))," instance. The ",(0,o.mdx)("inlineCode",{parentName:"p"},"GroupNode")," class provides a ",(0,o.mdx)("inlineCode",{parentName:"p"},"children")," property: you can ",(0,o.mdx)("inlineCode",{parentName:"p"},"append()")," both the line and the text to it."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nconst hGroup = editor.createGroup();\neditor.context.insertionParent.children.append(hGroup);\nhGroup.children.append(hLine, hText);\n")),(0,o.mdx)("h3",{id:"repeating-the-process"},"Repeating the process"),(0,o.mdx)("p",null,"From this point, creating the vertical line and the text is a matter of copying/pasting and changing a few parameters. The only new element may be text rotation: the ",(0,o.mdx)("inlineCode",{parentName:"p"},"TextNode")," class has a ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/classes/TextNode.md#setrotationinparent"},(0,o.mdx)("inlineCode",{parentName:"a"},"setRotationInParent()"))," method. It expects a number in degrees (-90, in our case) and a ",(0,o.mdx)("inlineCode",{parentName:"p"},"localRotationPoint")," object (implementing the ",(0,o.mdx)("a",{parentName:"p",href:"/express-add-ons-docs/references/document-sandbox/document-apis/interfaces/Point/"},(0,o.mdx)("inlineCode",{parentName:"a"},"Point"))," interface), which is the point to rotate around in the node's local coordinates. In this case, ",(0,o.mdx)("inlineCode",{parentName:"p"},"{x: 0, y: 0}")," will do."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"const vText = editor.createText(`${Math.trunc(nodeHeight).toString()}px`);\neditor.context.insertionParent.children.append(vText);\n\nvText.translation = {\n  x: nodeTranslation.x - 30,\n  y: nodeTranslation.y + nodeHeight / 2,\n};\nvText.setRotationInParent(-90, { x: 0, y: 0 }); // 👈\n")),(0,o.mdx)("h3",{id:"refactoring-and-optimizing-the-code"},"Refactoring and optimizing the code"),(0,o.mdx)("p",null,"In the final add-on code, there are three buttons: one logs the selected node, one draws the dimensions as you've just seen, and the last one is a refactored version that also draws dashed lines (red and thinner) connecting the dimensions to the object's corners."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"51.25000000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/5530d/refs-addon-refactor.webp 320w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/0c8fb/refs-addon-refactor.webp 640w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/94b1e/refs-addon-refactor.webp 1280w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/0b34d/refs-addon-refactor.webp 1920w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/d5269/refs-addon-refactor.webp 2560w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/49f40/refs-addon-refactor.webp 3456w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/dd4a7/refs-addon-refactor.png 320w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/0f09e/refs-addon-refactor.png 640w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/bbbf7/refs-addon-refactor.png 1280w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/ac7a9/refs-addon-refactor.png 1920w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/c7a69/refs-addon-refactor.png 2560w","/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/eaa1b/refs-addon-refactor.png 3456w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/296e933186cf7580e27656f89f61f958/bbbf7/refs-addon-refactor.png",alt:"refs addon refactor",title:"refs addon refactor",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"For brevity's sake, only a few relevant additions to the code will be mentioned below—please refer to the ",(0,o.mdx)("a",{parentName:"p",href:"#final-project"},"full sample")," for the complete picture."),(0,o.mdx)("p",null,"The code for drawing the dimensions is moved to a separate ",(0,o.mdx)("inlineCode",{parentName:"p"},"dimensions.js")," file. This update includes exporting ",(0,o.mdx)("inlineCode",{parentName:"p"},"drawDimensions()")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"drawDimensionsRefactored()")," alongside the implementation of a private ",(0,o.mdx)("inlineCode",{parentName:"p"},"createDimensionLine()"),". This function abstracts the creation of a line and its accompanying text by accepting ",(0,o.mdx)("inlineCode",{parentName:"p"},"width"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"height"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"translation"),", ",(0,o.mdx)("inlineCode",{parentName:"p"},"orientation"),", and ",(0,o.mdx)("inlineCode",{parentName:"p"},"margin")," within an options object."),(0,o.mdx)(c,{slots:"heading, code",repeat:"1",languages:"documentSandbox/dimensions.js",mdxType:"CodeBlock"}),(0,o.mdx)("h4",{id:"documentsandboxdimensionsjs"},"documentSandbox/dimensions.js"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},"// ...\nconst createDimensionLine = ({\n  width,\n  height,\n  translation,\n  orientation,\n  margin,\n}) => {\n  /* ... */\n};\n\n// ...\nconst drawDimensions = () => {\n  /* ... */\n};\nconst drawDimensionsRefactored = () => {\n  // ...\n  createDimensionLine({\n    /* ... */\n  }); // 👈\n  createDimensionLine({\n    /* ... */\n  }); // 👈\n  // ...\n};\n\nexport { drawDimensions, drawDimensionsRefactored };\n")),(0,o.mdx)("p",null,"A rather unorthodox warning system is implemented to alert the user when selecting an unsupported node type. Through the Communication API outlined in ",(0,o.mdx)("a",{parentName:"p",href:"../how_to/tutorials/stats-addon.md"},"this tutorial"),", a ",(0,o.mdx)("inlineCode",{parentName:"p"},"flashWrongElement()")," function, defined in the iframe UI, is available to the Document Sandbox."),(0,o.mdx)(c,{slots:"heading, code",repeat:"2",languages:"ui/index.js, documentSandbox/dimensions.js",mdxType:"CodeBlock"}),(0,o.mdx)("h4",{id:"uiindexjs"},"ui/index.js"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'addOnUISdk.ready.then(async () => {\n  // ...\n  runtime.exposeApi({\n    flashWrongElement(id) {\n      const button = document.getElementById(id);\n      const oldText = button.textContent;\n      const oldColor = button.style.backgroundColor;\n\n      button.textContent = "WRONG NODE";\n      button.style.backgroundColor = "#ff0000";\n\n      setTimeout(() => {\n        button.textContent = oldText;\n        button.style.backgroundColor = oldColor;\n      }, 1000);\n    },\n  });\n});\n')),(0,o.mdx)("h4",{id:"documentsandboxdimensionsjs-1"},"documentSandbox/dimensions.js"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'const drawDimensionsRefactored = () => {\n  if (\n    editor.context.hasSelection &&\n    editor.context.selection[0].type === constants.SceneNodeType.mediaContainer\n  ) {\n    // ...\n  } else {\n    panelUIProxy.flashWrongElement("drawDimensionsRefactored"); // 👈\n  }\n};\n')),(0,o.mdx)("p",null,"When the Document Sandbox code detects an unsupported node type, it reaches out to the iframe UI ",(0,o.mdx)("inlineCode",{parentName:"p"},"flashWrongElement()")," method (exposed via proxy), sending the button ",(0,o.mdx)("inlineCode",{parentName:"p"},"id")," as a parameter. As a result, the button blinks red for a second, as its CSS and ",(0,o.mdx)("inlineCode",{parentName:"p"},"textContent")," property are temporarily changed."),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"30.624999999999996%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/5530d/refs-addon-unsupported.webp 320w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/0c8fb/refs-addon-unsupported.webp 640w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/94b1e/refs-addon-unsupported.webp 1280w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/0b34d/refs-addon-unsupported.webp 1920w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/f3963/refs-addon-unsupported.webp 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/dd4a7/refs-addon-unsupported.png 320w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/0f09e/refs-addon-unsupported.png 640w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/bbbf7/refs-addon-unsupported.png 1280w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/ac7a9/refs-addon-unsupported.png 1920w","/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/6482f/refs-addon-unsupported.png 2500w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/express-add-ons-docs/static/735e8beb1fd5d36a6d1891aef8ea6685/bbbf7/refs-addon-unsupported.png",alt:"refs addon unsupported",title:"refs addon unsupported",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("h3",{id:"next-steps"},"Next Steps"),(0,o.mdx)("p",null,"As an exercise, you use the code sample found below and expand it to build a more complete Dimensions add-on; for example, you can:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},"support ",(0,o.mdx)("strong",{parentName:"li"},"more node types"),";"),(0,o.mdx)("li",{parentName:"ul"},"add ",(0,o.mdx)("strong",{parentName:"li"},"UI elements"),":",(0,o.mdx)("ul",{parentName:"li"},(0,o.mdx)("li",{parentName:"ul"},"a slider to control the dimensions' distance from the object;"),(0,o.mdx)("li",{parentName:"ul"},"dropdowns to choose the line's style (solid, dashed, dotted), and the arrowhead type;"),(0,o.mdx)("li",{parentName:"ul"},"a checkbox to toggle the extra dashed lines;"),(0,o.mdx)("li",{parentName:"ul"},"a color picker to change the line's color—see the ",(0,o.mdx)("a",{parentName:"li",href:"../how_to/tutorials/grids-addon.md"},"Grids add-on")," for an example.")))),(0,o.mdx)("h2",{id:"lessons-learned"},"Lessons Learned"),(0,o.mdx)("p",null,"Let's review the key concepts discussed in this article."),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"DOM Structure"),": the DOM is a hierarchical tree of nodes with parent/child relationships and well-defined inheritance."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"OOP principles"),": classes, inheritance, class extension, and interfaces are crucial Object Oriented programming notions."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Constants"),": represent a safe way to refer to internal values and check against enumerable properties."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Reference documentation"),": the Adobe Express Document API reference is a key resource: it provides comprehensive information on available classes, interfaces, and their properties and methods."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Classes and Interfaces"),": you can differentiate between live object classes, collection classes, abstract classes, static classes, object interfaces, and implementable interfaces."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"Types and IntelliSense"),": using ",(0,o.mdx)("inlineCode",{parentName:"li"},".d.ts")," and ",(0,o.mdx)("inlineCode",{parentName:"li"},"tsconfig.json")," files in your projects can enhance code completion and type checking, leading to faster and error-free coding."),(0,o.mdx)("li",{parentName:"ul"},"You've also learned how to ",(0,o.mdx)("strong",{parentName:"li"},"prototype an add-on")," by navigating the Reference documentation alone.")),(0,o.mdx)("h2",{id:"final-project"},"Final Project"),(0,o.mdx)("p",null,"The code for this project can be found below, as well as in the ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/express-add-on-samples"},(0,o.mdx)("inlineCode",{parentName:"a"},"express-add-on-samples"))," repository."),(0,o.mdx)(l,{variant:"info",slots:"text1",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"Please use the ",(0,o.mdx)("strong",{parentName:"p"},"iframe UI")," and ",(0,o.mdx)("strong",{parentName:"p"},"Document Sandbox")," tabs to switch between the two domains and find a dropdown in the top-right corner to select which file to show."),(0,o.mdx)(c,{slots:"heading, code",repeat:"4",languages:"index.html, ui/index.js, documentSandbox/code.js, documentSandbox/dimensions.js",mdxType:"CodeBlock"}),(0,o.mdx)("h4",{id:"iframe-ui"},"iframe UI"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-html"},'<body>\n  <sp-theme\n    scale="medium"\n    color="light"\n    theme="express"\n  >\n    <sp-button id="logNode">Log selected node</sp-button>\n    <sp-button id="drawDimensions">Draw Dimensions</sp-button>\n    <sp-button id="drawDimensionsRefactored"\n      >Draw Dimensions (refactored)</sp-button\n    >\n  </sp-theme>\n</body>\n')),(0,o.mdx)("h4",{id:"iframe-ui-1"},"iframe UI"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import "@spectrum-web-components/styles/typography.css";\nimport "@spectrum-web-components/theme/src/themes.js";\nimport "@spectrum-web-components/theme/theme-light.js";\nimport "@spectrum-web-components/theme/express/theme-light.js";\nimport "@spectrum-web-components/theme/express/scale-medium.js";\nimport "@spectrum-web-components/theme/sp-theme.js";\n\nimport "@spectrum-web-components/button/sp-button.js";\n\nimport addOnUISdk from "https://express.adobe.com/static/add-on-sdk/sdk.js";\n\naddOnUISdk.ready.then(async () => {\n  console.log("addOnUISdk is ready for use.");\n\n  // Get the Authoring Sandbox.\n  const { runtime } = addOnUISdk.instance;\n  const sandboxProxy = await runtime.apiProxy("documentSandbox");\n\n  const buttonIds = ["logNode", "drawDimensions", "drawDimensionsRefactored"];\n\n  buttonIds.forEach((id) => {\n    const button = document.getElementById(id);\n    button.addEventListener("click", () => {\n      sandboxProxy[id]();\n    });\n    button.disabled = false;\n  });\n\n  runtime.exposeApi({\n    flashWrongElement(id) {\n      const button = document.getElementById(id);\n      const oldText = button.textContent;\n      const oldColor = button.style.backgroundColor;\n\n      button.textContent = "WRONG NODE";\n      button.style.backgroundColor = "#ff0000";\n\n      setTimeout(() => {\n        button.textContent = oldText;\n        button.style.backgroundColor = oldColor;\n      }, 1000);\n    },\n  });\n});\n')),(0,o.mdx)("h4",{id:"document-sandbox-1"},"Document Sandbox"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnSandboxSdk from "add-on-sdk-document-sandbox";\nconst { runtime } = addOnSandboxSdk.instance;\nimport { editor } from "express-document-sdk";\nimport { drawDimensions, drawDimensionsRefactored } from "./dimensions.js";\n\nfunction start() {\n  runtime.exposeApi({\n    drawDimensions,\n    drawDimensionsRefactored,\n    logNode: () => {\n      const selectedNode = editor.context.selection[0];\n      console.log("Currently selected node", selectedNode);\n    },\n  });\n}\n\nstart();\n')),(0,o.mdx)("h4",{id:"document-sandbox-2"},"Document Sandbox"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnSandboxSdk from "add-on-sdk-document-sandbox";\nconst { runtime } = addOnSandboxSdk.instance;\nconst panelUIProxy = await runtime.apiProxy("panel");\n\nimport { editor, constants } from "express-document-sdk";\n\nconst createDimensionLine = ({\n  width,\n  height,\n  translation,\n  orientation,\n  margin,\n}) => {\n  const isVertical = orientation === "vertical";\n\n  // Adjust line start and end points based on orientation and margin\n  const lineStart = isVertical\n    ? { x: translation.x - margin, y: translation.y }\n    : { x: translation.x, y: translation.y - margin };\n  const lineEnd = isVertical\n    ? { x: translation.x - margin, y: translation.y + height }\n    : { x: translation.x + width, y: translation.y - margin };\n\n  const textValue = isVertical ? height : width;\n  const textPos = isVertical\n    ? { x: translation.x - margin - 10, y: translation.y + height / 2 }\n    : { x: translation.x + width / 2, y: translation.y - margin - 10 };\n\n  const line = editor.createLine();\n  line.setEndPoints(lineStart.x, lineStart.y, lineEnd.x, lineEnd.y);\n  line.startArrowHeadType = line.endArrowHeadType =\n    constants.ArrowHeadType.openTriangular;\n  editor.context.insertionParent.children.append(line);\n\n  const text = editor.createText(`${Math.trunc(textValue).toString()}px`);\n  editor.context.insertionParent.children.append(text);\n  text.translation = textPos;\n\n  if (isVertical) {\n    text.setRotationInParent(-90, { x: 0, y: 0 });\n  }\n\n  const group = editor.createGroup();\n  editor.context.insertionParent.children.append(group);\n  group.children.append(line, text);\n\n  // Create and append extra lines at the extremities\n  for (let i = 0; i < 2; i++) {\n    const extraLine = editor.createLine();\n    const extraLineStart = isVertical\n      ? {\n          x: translation.x,\n          y: i === 0 ? translation.y : translation.y + height,\n        }\n      : {\n          x: i === 0 ? translation.x : translation.x + width,\n          y: translation.y,\n        };\n    const extraLineEnd = isVertical\n      ? {\n          x: translation.x - margin - 10,\n          y: i === 0 ? translation.y : translation.y + height,\n        }\n      : {\n          x: i === 0 ? translation.x : translation.x + width,\n          y: translation.y - margin - 10,\n        };\n\n    extraLine.setEndPoints(\n      extraLineStart.x,\n      extraLineStart.y,\n      extraLineEnd.x,\n      extraLineEnd.y\n    );\n    extraLine.stroke = editor.makeStroke({\n      color: { red: 1, green: 0, blue: 0, alpha: 1 },\n      dashPattern: [4, 2],\n      width: 0.5,\n    });\n    group.children.append(extraLine);\n    // editor.context.insertionParent.children.append(extraLine);\n  }\n\n  return group;\n};\n\nconst drawDimensions = () => {\n  if (\n    editor.context.hasSelection &&\n    editor.context.selection[0].type === constants.SceneNodeType.mediaContainer\n  ) {\n    const selectedNode = editor.context.selection[0];\n    console.log(selectedNode);\n    const { translation: nodeTranslation } = selectedNode;\n    const { width: nodeWidth, height: nodeHeight } =\n      selectedNode.mediaRectangle;\n\n    const hLine = editor.createLine();\n    hLine.setEndPoints(\n      nodeTranslation.x,\n      nodeTranslation.y - 20,\n      nodeTranslation.x + nodeWidth,\n      nodeTranslation.y - 20\n    );\n\n    // translation is relative to the parent!!\n    editor.context.insertionParent.children.append(hLine);\n    hLine.startArrowHeadType = hLine.endArrowHeadType =\n      constants.ArrowHeadType.openTriangular;\n\n    const hText = editor.createText(`${Math.trunc(nodeWidth).toString()}px`);\n    editor.context.insertionParent.children.append(hText);\n\n    hText.translation = {\n      x: nodeTranslation.x + nodeWidth / 2,\n      y: nodeTranslation.y - 30,\n    };\n\n    const hGroup = editor.createGroup();\n    editor.context.insertionParent.children.append(hGroup);\n    hGroup.children.append(hLine, hText);\n\n    // Same for the vertical line\n    const vLine = editor.createLine();\n    vLine.setEndPoints(\n      nodeTranslation.x - 20,\n      nodeTranslation.y,\n      nodeTranslation.x - 20,\n      nodeTranslation.y + nodeHeight\n    );\n    vLine.startArrowHeadType = vLine.endArrowHeadType =\n      constants.ArrowHeadType.openTriangular;\n\n    editor.context.insertionParent.children.append(vLine);\n\n    const vText = editor.createText(`${Math.trunc(nodeHeight).toString()}px`);\n    editor.context.insertionParent.children.append(vText);\n\n    vText.translation = {\n      x: nodeTranslation.x - 30,\n      y: nodeTranslation.y + nodeHeight / 2,\n    };\n    vText.setRotationInParent(-90, { x: 0, y: 0 });\n\n    const vGroup = editor.createGroup();\n    editor.context.insertionParent.children.append(vGroup);\n    vGroup.children.append(vLine, vText);\n  } else {\n    panelUIProxy.flashWrongElement("drawDimensions");\n  }\n};\n\nconst drawDimensionsRefactored = () => {\n  if (\n    editor.context.hasSelection &&\n    editor.context.selection[0].type === constants.SceneNodeType.mediaContainer\n  ) {\n    const selectedNode = editor.context.selection[0];\n    const { translation: nodeTranslation } = selectedNode;\n    const { width: nodeWidth, height: nodeHeight } =\n      selectedNode.mediaRectangle;\n\n    // Create horizontal dimension line\n    createDimensionLine({\n      width: nodeWidth,\n      height: nodeHeight,\n      translation: nodeTranslation,\n      orientation: "horizontal",\n      margin: 60,\n    });\n\n    // Create vertical dimension line\n    createDimensionLine({\n      width: nodeWidth,\n      height: nodeHeight,\n      translation: nodeTranslation,\n      orientation: "vertical",\n      margin: 20,\n    });\n  } else {\n    panelUIProxy.flashWrongElement("drawDimensionsRefactored");\n  }\n};\n\nexport { drawDimensions, drawDimensionsRefactored };\n')),(0,o.mdx)("hr",null),(0,o.mdx)("div",{className:"footnotes"},(0,o.mdx)("hr",{parentName:"div"}),(0,o.mdx)("ol",{parentName:"div"},(0,o.mdx)("li",{parentName:"ol",id:"fn-1"},"Creating entirely novel features for desktop applications typically involves using SDKs and low-level languages such as C++. Adobe Express doesn't allow for this kind of customization.",(0,o.mdx)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"↩")),(0,o.mdx)("li",{parentName:"ol",id:"fn-2"},"Typically, not every feature available in an application is by default surfaced to Scripting—it's not uncommon for it to be a smaller subset of the UI, features-wise.",(0,o.mdx)("a",{parentName:"li",href:"#fnref-2",className:"footnote-backref"},"↩")),(0,o.mdx)("li",{parentName:"ol",id:"fn-3"},"At the time of this writing, these properties are ",(0,o.mdx)("em",{parentName:"li"},"not yet")," available for selection in the Adobe Express user interface. It's one of those rare cases where scripting is mightier than the UI!",(0,o.mdx)("a",{parentName:"li",href:"#fnref-3",className:"footnote-backref"},"↩")))))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-learn-platform-concepts-document-api-md-98fc24dd15bdb2d57352.js.map