"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[2479],{96111:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return d},default:function(){return m}});var o=n(58168),a=n(80045),s=(n(88763),n(15680)),i=n(83407);const r=["components"],d={},l=(h="InlineAlert",function(e){return console.warn("Component "+h+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.mdx)("div",e)});var h;const u={_frontmatter:d},c=i.A;function m(e){let{components:t}=e,n=(0,a.A)(e,r);return(0,s.mdx)(c,(0,o.A)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,s.mdx)("h1",{id:"use-oauth-20"},"Use OAuth 2.0"),(0,s.mdx)("p",null,"Implementing an OAuth 2.0 authorization flow, enabling users to authenticate and log in using their existing accounts from third-party services."),(0,s.mdx)("p",null,"A typical use case would be to use assets stored in different services. Here, you will find instructions on how to set it up and an implementation example. Check also the ",(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-oauth/"},"SDK Reference OAuth section")," for more options and details and the ",(0,s.mdx)("a",{parentName:"p",href:"../samples.md#import-images-using-oauth"},"import-images-using-oauth")," sample add-on for more advanced usage."),(0,s.mdx)("h3",{id:"login-and-logout-flows"},"Login and Logout flows"),(0,s.mdx)("p",null,"Both login and logout flows are equally important, and developers should ensure that the add-on's UI provides functionality for both actions."),(0,s.mdx)("p",null,"Authorization should persist across sessions so users don't have to log in with their credentials every time they use the add-on. The token's lifespan is at the discretion of the OAuth provider; the token itself can be stored remotely (e.g., mapping its UUID in the add-on's local storage) or directly in the local storage (easier but less secure)."),(0,s.mdx)("h3",{id:"setup"},"Setup"),(0,s.mdx)("p",null,'The OAuth APIs can be used to obtain the authorization "code" from any OAuth 2.0 provider supporting the Code Exchange authorization workflow. You will need to go through some setup steps with the provider you want to use OAuth with first.'),(0,s.mdx)(l,{variant:"warning",slots:"header, text1, text2",mdxType:"InlineAlert"}),(0,s.mdx)("p",null,"New OAuth redirect URI"),(0,s.mdx)("p",null,"Adobe Express has moved from ",(0,s.mdx)("inlineCode",{parentName:"p"},"new.express.adobe.com")," to ",(0,s.mdx)("inlineCode",{parentName:"p"},"express.adobe.com")," as part of the sunsetting of the legacy version. Make sure ",(0,s.mdx)("strong",{parentName:"p"},"both redirect URIs are allowed in your OAuth configuration"),":"),(0,s.mdx)("ul",null,(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"https://new.express.adobe.com/static/oauth-redirect.html")),(0,s.mdx)("li",{parentName:"ul"},(0,s.mdx)("inlineCode",{parentName:"li"},"https://express.adobe.com/static/oauth-redirect.html")," (new)")),(0,s.mdx)("p",null,"Here are the steps to get started:"),(0,s.mdx)("ol",null,(0,s.mdx)("li",{parentName:"ol"},"Log in to the OAuth provider's website and create an application (for example, Dropbox). This must be a web application, and if an option of SPA (Single Page Application) is listed, select it."),(0,s.mdx)("li",{parentName:"ol"},'As an input to the "Redirect URIs" field, add: ',(0,s.mdx)("inlineCode",{parentName:"li"},"https://express.adobe.com/static/oauth-redirect.html"),"."),(0,s.mdx)("li",{parentName:"ol"},"Fill out other details as necessary and save the form. A client Id / application Id / application key (this differs on different OAuth providers) will be generated. Make note of it as you will need it in your add-on code."),(0,s.mdx)("li",{parentName:"ol"},"Next, update your add-on ",(0,s.mdx)("inlineCode",{parentName:"li"},"manifest.json")," file with the hostname of the OAuth provider's authorization URL. ",(0,s.mdx)("strong",{parentName:"li"},"NOTE:")," When using multiple providers, all hostnames must be provided. For example, if the add-on uses two OAuth providers (",(0,s.mdx)("inlineCode",{parentName:"li"},'"login.microsoftonline.com"')," and ",(0,s.mdx)("inlineCode",{parentName:"li"},'"www.dropbox.com"'),"), the ",(0,s.mdx)("inlineCode",{parentName:"li"},"manifest.json")," should contain both of them, as shown below:")),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "<ADD_ON_ID>",\n  "name": "<ADD_ON_NAME>",\n  "version": "1.0.0",\n  "manifestVersion": 1,\n  "requirements": {\n    "apps": ["Express"]\n  },\n  "entryPoints": [\n    {\n      "type": "panel",\n      "id": "panel1",\n      "label": {\n        "default": "<ADD_ON_LABEL>"\n      },\n      "main": "index.html",\n      "permissions": {\n        "oauth": ["login.microsoftonline.com", "www.dropbox.com"]\n      }\n    }\n  ]\n}\n')),(0,s.mdx)("h3",{id:"example"},"Example"),(0,s.mdx)("p",null,"Once you complete the setup, you can use the following code snippet as an example of how to perform the OAuth exchange to retrieve an access token. The ",(0,s.mdx)("a",{parentName:"p",href:"../samples.md"},"code samples")," also include several examples of implementing OAuth 2.0 workflows, which you can refer to. Additionally, you'll find the ",(0,s.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/express-add-on-samples/blob/main/samples/import-images-using-oauth/src/utils/OAuthUtils.js"},"OAuthUtils.js")," module, referenced below, and we recommend utilizing this module to facilitate your own OAuth implementation. For further details on the OAuth workflows, be sure to explore the ",(0,s.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-oauth"},"SDK References"),"."),(0,s.mdx)("pre",null,(0,s.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://express.adobe.com/static/add-on-sdk/sdk.js";\n\nconst DROPBOX_AUTHORIZATION_URL = "https://www.dropbox.com/oauth2/authorize";\nconst DROPBOX_TOKEN_URL = "https://api.dropboxapi.com/oauth2/token";\nconst DROPBOX_CLIENT_ID = "<DROPBOX_CLIENT_ID>";\nconst DROPBOX_SCOPE = "<DROPBOX_SPACE_SEPARATED_SCOPES>";\n\nconst ONEDRIVE_AUTHORIZATION_URL = "https://login.microsoftonline.com/<AZURE_AD_TENANT_ID>/oauth2/v2.0/authorize";\nconst ONEDRIVE_TOKEN_URL = "https://login.microsoftonline.com/<AZURE_AD_TENANT_ID>/oauth2/v2.0/token";\nconst ONEDRIVE_CLIENT_ID = "<ONEDRIVE_CLIENT_ID>";\nconst ONEDRIVE_SCOPE = "<ONEDRIVE_SPACE_SEPARATED_SCOPES>";\nconst OWN_REDIRECT_URI = "<OWN_REDIRECT_URI>";\n\naddOnUISdk.ready.then(() => {\n  // \'oauthUtils\' is a helper javascript module (included with\n  // the OAuth sample) which provides utility functions to:\n\n  // 1. Generate the \'code_challenge\' and \'code_verifier\' parameters\n  // that are essential in the OAuth 2.0 workflow.\n  // generateChallenge()\n\n  // 2. Generate an \'access_token\' and a \'refresh_token\' using the\n  // \'code\' and \'redirectUri\' received on successful authorization.\n  // generateAccessToken()\n\n  // Get an always valid \'access_token\'.\n  // 3. getAccessToken()\n  const challenge = await oauthUtils.generateChallenge();\n  await authorize(challenge);\n});\n\nfunction authorize(challenge) {\n  // Trigger the OAuth 2.0 based authorization which opens up a\n  // sign-in window for the user and returns an authorization code\n  // which can be used to obtain an access_token.\n  const { id, code, redirectUri, result } = await addOnUISdk.app.oauth.authorize({\n    authorizationUrl: DROPBOX_AUTHORIZATION_URL,\n    clientId: DROPBOX_CLIENT_ID,\n    scope: DROPBOX_SCOPE,\n    codeChallenge: challenge.codeChallenge\n  });\n\n  const { status, description } = result;\n  if (status !== "SUCCESS") {\n    throw new Error(`Status: ${status} | Description: ${description}`);\n  }\n\n  // Generate the access_token which can be used to verify the identity\n  // of the user and grant them access to the requested resource.\n  await oauthUtils.generateAccessToken({\n    id,\n    clientId: DROPBOX_CLIENT_ID,\n    codeVerifier: challenge.codeVerifier,\n    code,\n    tokenUrl: DROPBOX_TOKEN_URL,\n    redirectUri\n  });\n\n  const accessToken = await oauthUtils.getAccessToken(id);\n}\n')),(0,s.mdx)("h2",{id:"use-cases"},"Use Cases"),(0,s.mdx)("p",null,"OAuth is ideal for scenarios where users need to connect their accounts to access personalized features, sync data, or enable functionalities like cloud storage. You can also use it to authenticate users and authorize them to access your add-on's premium users, after they've subscribed to a paid plan."),(0,s.mdx)("h2",{id:"faqs"},"FAQs"),(0,s.mdx)("h4",{id:"q-what-redirect-uri-should-i-use"},"Q: What redirect URI should I use?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Use ",(0,s.mdx)("inlineCode",{parentName:"p"},"https://express.adobe.com/static/oauth-redirect.html")," for OAuth provider configuration."),(0,s.mdx)("h4",{id:"q-how-do-i-add-oauth-permissions-to-manifest"},"Q: How do I add OAuth permissions to manifest?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Add hostnames to permissions.oauth array like ",(0,s.mdx)("inlineCode",{parentName:"p"},'["login.microsoftonline.com", "www.dropbox.com"]'),"."),(0,s.mdx)("h4",{id:"q-how-do-i-start-oauth-authorization"},"Q: How do I start OAuth authorization?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Call ",(0,s.mdx)("inlineCode",{parentName:"p"},"addOnUISdk.app.oauth.authorize()")," with authorizationUrl, clientId, scope, and codeChallenge."),(0,s.mdx)("h4",{id:"q-what-does-the-authorize-method-return"},"Q: What does the authorize method return?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Returns object with id, code, redirectUri, and result containing status and description."),(0,s.mdx)("h4",{id:"q-how-do-i-generate-access-tokens"},"Q: How do I generate access tokens?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Use the authorization code with token exchange endpoint and code verifier from PKCE flow."),(0,s.mdx)("h4",{id:"q-should-tokens-persist-across-sessions"},"Q: Should tokens persist across sessions?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Yes, store tokens locally or remotely so users don't re-authenticate every session."),(0,s.mdx)("h4",{id:"q-what-helper-utilities-are-available"},"Q: What helper utilities are available?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," OAuthUtils.js module provides generateChallenge(), generateAccessToken(), and getAccessToken() functions."),(0,s.mdx)("h4",{id:"q-what-are-common-oauth-use-cases"},"Q: What are common OAuth use cases?"),(0,s.mdx)("p",null,(0,s.mdx)("strong",{parentName:"p"},"A:")," Cloud storage access, user authentication, premium features, and personalized account data sync."))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-learn-how-to-oauth-2-md-6eb2f31f601a431fb9c4.js.map