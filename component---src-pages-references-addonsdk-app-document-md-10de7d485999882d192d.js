"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[1549],{51051:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return o},default:function(){return s}});var n,d=a(87462),r=a(63366),i=(a(15007),a(64983)),m=a(91515),l=["components"],o={},p=(n="InlineAlert",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.mdx)("div",e)}),x={_frontmatter:o},g=m.Z;function s(e){var t=e.components,a=(0,r.Z)(e,l);return(0,i.mdx)(g,(0,d.Z)({},x,a,{components:t,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"addonsdkappdocument"},"AddOnSdk.app.document"),(0,i.mdx)("p",null,"Provides access to the methods needed for ",(0,i.mdx)("a",{parentName:"p",href:"../../guides/develop/index.md#importing-content"},"importing content")," to the document and for ",(0,i.mdx)("a",{parentName:"p",href:"../../guides/develop/index.md#exporting-content"},"exporting content")," for export."),(0,i.mdx)("h2",{id:"import-content-methods"},"Import Content Methods"),(0,i.mdx)("h3",{id:"addimage"},"addImage()"),(0,i.mdx)("p",null,"Adds an image to the current page. "),(0,i.mdx)("h4",{id:"signature"},"Signature"),(0,i.mdx)("p",null,(0,i.mdx)("inlineCode",{parentName:"p"},"addImage(imageBlob: Blob): Promise<void>")),(0,i.mdx)("h4",{id:"parameters"},"Parameters"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"imageBlob")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Blob")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"The image to add to the page.")))),(0,i.mdx)("h4",{id:"return-value"},"Return Value"),(0,i.mdx)("p",null,"A resolved promise if the image was successfully added to the canvas, otherwise will throw an error with the rejected promise."),(0,i.mdx)(p,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,i.mdx)("p",null,"The supported file types for imported content are currently ",(0,i.mdx)("strong",{parentName:"p"},(0,i.mdx)("inlineCode",{parentName:"strong"},"png/jpg/jpeg/mp4"),",")," and the size of the imported images should not exceed ",(0,i.mdx)("strong",{parentName:"p"},"8000px")," or ",(0,i.mdx)("strong",{parentName:"p"},"40MB"),"."),(0,i.mdx)("h3",{id:"addvideo"},"addVideo()"),(0,i.mdx)("p",null,"Adds a video to the current page. "),(0,i.mdx)("h4",{id:"signature-1"},"Signature"),(0,i.mdx)("p",null,(0,i.mdx)("inlineCode",{parentName:"p"},"addVideo(blob: Blob): Promise<void>")),(0,i.mdx)("h4",{id:"parameters-1"},"Parameters"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"imageBlob")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Blob")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"The video to add to the page.")))),(0,i.mdx)("h4",{id:"return-value-1"},"Return Value"),(0,i.mdx)("p",null,"A resolved promise if the image was successfully added to the canvas, otherwise will throw an error with the rejected promise."),(0,i.mdx)(p,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,i.mdx)("p",null,"Refer to the ",(0,i.mdx)("a",{parentName:"p",href:"../../guides/develop/index.md#importing-content"},"importing content use case")," and the ",(0,i.mdx)("a",{parentName:"p",href:"../../samples/#import-images-from-local"},"import-images-from-local")," in the code samples for usage examples."),(0,i.mdx)("h3",{id:"errors"},"Errors"),(0,i.mdx)("p",null,"The table below describes the possible error messages that may occur when using the import methods, with a description of the scenario that would cause them to be returned."),(0,i.mdx)("br",null),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:"right"},"Error Message"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Error Scenario"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Invalid blob."),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Blob is invalid.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Unsupported mime type : ",(0,i.mdx)("inlineCode",{parentName:"td"},"${blob.type}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Mime type is invalid.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Import image width or height exceed the maximum limit : ",(0,i.mdx)("inlineCode",{parentName:"td"},"${maxSupportedDimension}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"The imported image dimensions exceed the maximum limit if any defined by Express.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Import image size exceed the maximum limit: ",(0,i.mdx)("inlineCode",{parentName:"td"},"${maxSupportedSize}MB")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"The imported image size exceeds the maximum limit if any defined by Express.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"No active page available."),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Current page doesn't exist.")))),(0,i.mdx)("h2",{id:"export-content-methods"},"Export Content Methods"),(0,i.mdx)("h3",{id:"createrenditions"},"createRenditions()"),(0,i.mdx)("p",null,"Create renditions of the current page or the whole document for exporting in a specified format. "),(0,i.mdx)("h4",{id:"signature-2"},"Signature"),(0,i.mdx)("p",null,(0,i.mdx)("inlineCode",{parentName:"p"},"createRenditions(renditionOptions: RenditionOptions, renditionIntent?: RenditionIntent): Promise<Rendition[]>")),(0,i.mdx)("h4",{id:"parameters-2"},"Parameters"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"renditionOptions")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Object")),(0,i.mdx)("td",{parentName:"tr",align:"right"},(0,i.mdx)("a",{parentName:"td",href:"#renditionoptions"},(0,i.mdx)("inlineCode",{parentName:"a"},"RenditionOptions"))," object.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"renditionIntent")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"string")),(0,i.mdx)("td",{parentName:"tr",align:"right"})))),(0,i.mdx)("h4",{id:"renditionoptions"},(0,i.mdx)("inlineCode",{parentName:"h4"},"RenditionOptions")),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"range")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"string")),(0,i.mdx)("td",{parentName:"tr",align:"right"},(0,i.mdx)("a",{parentName:"td",href:"./addonsdk-constants.md"},(0,i.mdx)("inlineCode",{parentName:"a"},"Range"))," constant value.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"format")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"string")),(0,i.mdx)("td",{parentName:"tr",align:"right"},(0,i.mdx)("a",{parentName:"td",href:"./addonsdk-constants.md"},(0,i.mdx)("inlineCode",{parentName:"a"},"RenditionFormat"))," constant value.")))),(0,i.mdx)("h4",{id:"jpgrenditionoptions"},"JpgRenditionOptions"),(0,i.mdx)("p",null,"The following additional options are supported for ",(0,i.mdx)("inlineCode",{parentName:"p"},"jpg")," renditions:"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"backgroundColor?")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"number")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Integer in 0xRRGGBB format of the background color you wish to sit behind any transparent areas. By default it is derived from the entity for which the rendition needs to be created.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"quality?")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"number")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"A number between 0 and 1, indicating image quality. Default is 1.0.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("a",{parentName:"td",href:"#requested-size-notes"},(0,i.mdx)("inlineCode",{parentName:"a"},"requestedSize?"))),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"{width?: number; height?: number}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Requested size (in pixels).")))),(0,i.mdx)("h4",{id:"pngrenditionoptions"},"PngRenditionOptions"),(0,i.mdx)("p",null,"The following additional options are supported for ",(0,i.mdx)("inlineCode",{parentName:"p"},"png")," renditions:"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"backgroundColor?")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"number")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Integer in 0xRRGGBB format of the background color you wish to sit behind any transparent areas. By default it is derived from the entity for which the rendition needs to be created.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("a",{parentName:"td",href:"#requested-size-notes"},(0,i.mdx)("inlineCode",{parentName:"a"},"requestedSize?"))),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"{width?: number; height?: number}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Requested size (in pixels).")))),(0,i.mdx)("h4",{id:"requested-size-notes"},"Requested Size Notes"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"The supported size is from 1 x 1 to width x height."),(0,i.mdx)("li",{parentName:"ul"},"Aspect ratio is maintained while scaling the rendition based on the requested size."),(0,i.mdx)("li",{parentName:"ul"},"Up-scaling is currently not supported."),(0,i.mdx)("li",{parentName:"ul"},"If the requested size is invalid, it will be ignored and the original size rendition will be created. "),(0,i.mdx)("li",{parentName:"ul"},"Some examples of what the actual exported sizes will be, depending on the page size and requested size are in the table below for reference.")),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Page Size"),(0,i.mdx)("th",{parentName:"tr",align:null},"Requested Size"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Exported Size"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},"400 x 600"),(0,i.mdx)("td",{parentName:"tr",align:null},"200 x 200"),(0,i.mdx)("td",{parentName:"tr",align:"right"},"134 x 200")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},"400 x 600"),(0,i.mdx)("td",{parentName:"tr",align:null},"200 x 400"),(0,i.mdx)("td",{parentName:"tr",align:"right"},"200 x 300")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},"400 x 600"),(0,i.mdx)("td",{parentName:"tr",align:null},"200 x -200"),(0,i.mdx)("td",{parentName:"tr",align:"right"},"400 x 600")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},"400 x 600"),(0,i.mdx)("td",{parentName:"tr",align:null},"800 x 1000"),(0,i.mdx)("td",{parentName:"tr",align:"right"},"400 x 600")))),(0,i.mdx)("h4",{id:"return-value-2"},"Return Value"),(0,i.mdx)("p",null,"A ",(0,i.mdx)("inlineCode",{parentName:"p"},"Promise")," with an array of page ",(0,i.mdx)("inlineCode",{parentName:"p"},"Rendition")," objects. It will contain one page if the current page was selected or all pages in the case of the document. Each rendition returned will contain the ",(0,i.mdx)("inlineCode",{parentName:"p"},"type")," and a ",(0,i.mdx)("inlineCode",{parentName:"p"},"blob")," of the rendition itself."),(0,i.mdx)("h4",{id:"rendition"},(0,i.mdx)("inlineCode",{parentName:"h4"},"Rendition")),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Name"),(0,i.mdx)("th",{parentName:"tr",align:null},"Type"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"type?")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"string")),(0,i.mdx)("td",{parentName:"tr",align:"right"},'Type of Rendition. Value is always "page"')),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"blob")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"Blob")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Blob containing the rendition")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"title")),(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("inlineCode",{parentName:"td"},"string")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"The page title of the rendition.")))),(0,i.mdx)(p,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,i.mdx)("p",null,"Refer to the ",(0,i.mdx)("a",{parentName:"p",href:"../../guides/develop/index.md#exporting-content"},"exporting content use case example")," and the ",(0,i.mdx)("a",{parentName:"p",href:"../../samples/#export-sample"},"export-sample")," in the code samples for usage examples."),(0,i.mdx)("h3",{id:"errors-1"},"Errors"),(0,i.mdx)("p",null,"The table below describes the possible error messages that may occur when using the export methods, with a description of the scenario that will return them."),(0,i.mdx)("br",null),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:"right"},"Error Message"),(0,i.mdx)("th",{parentName:"tr",align:"right"},"Error Scenario"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Invalid range: ",(0,i.mdx)("inlineCode",{parentName:"td"},"${options.range}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Range value is invalid.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"No active page available."),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Range is ",(0,i.mdx)("inlineCode",{parentName:"td"},"Range.currentPage")," and there is no active page.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Unsupported rendition format: ",(0,i.mdx)("inlineCode",{parentName:"td"},"${options.format}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Rendition format is unsupported.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Invalid background color: ",(0,i.mdx)("inlineCode",{parentName:"td"},"${options.backgroundColor}")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Background color is invalid.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"Invalid quality parameter: ",(0,i.mdx)("inlineCode",{parentName:"td"},"${options.quality} not in range [0,1]")),(0,i.mdx)("td",{parentName:"tr",align:"right"},"Quality property is invalid in jpeg.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:"right"},"No video element in the specified range."),(0,i.mdx)("td",{parentName:"tr",align:"right"},"No video is present in the range when trying to export mp4.")))))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-references-addonsdk-app-document-md-10de7d485999882d192d.js.map