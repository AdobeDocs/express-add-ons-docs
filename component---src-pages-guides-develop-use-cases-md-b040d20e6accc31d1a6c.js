"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[8842],{32710:function(e,n,t){t.r(n),t.d(n,{_frontmatter:function(){return i},default:function(){return u}});var a=t(87462),o=t(45987),d=(t(15007),t(64983)),r=t(91515);const s=["components"],i={},l=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",n)},m=l("InlineAlert"),p=l("CodeBlock"),c={_frontmatter:i},h=r.Z;function u(e){let{components:n}=e,t=(0,o.Z)(e,s);return(0,d.mdx)(h,(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,d.mdx)("h1",{id:"implementing-common-use-cases"},"Implementing Common Use Cases"),(0,d.mdx)("p",null,"This guide contains a set of common use cases and accompanying code snippets to explore the capabilities of the Adobe Express add-ons platform."),(0,d.mdx)("p",null,"If you're looking for more extensive examples for any of the use cases described below, you can also check out our ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/"},"code samples"),". The ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/"},"SDK References")," can be used to find all of the objects, methods, properties and events supported for building add-ons..",(0,d.mdx)("br",null),(0,d.mdx)("br",null)),(0,d.mdx)("div",{style:{display:"flex",justifyContent:"center"}},(0,d.mdx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/HHnX5o8CxHU?si=4w4KvQVdkl8r5BZZ",title:"Building Add-on Features",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})),(0,d.mdx)("h2",{id:"importing-content"},"Importing Content"),(0,d.mdx)("p",null,"Importing content into a design is one of the most popular use cases. For instance, to add content retrieved from a third-party service or directly from the local hard drive. The following example use cases for implementing this feature. The first function shows how to implement it by adding an image directly from a ",(0,d.mdx)("inlineCode",{parentName:"p"},"blob")," object, and the second shows how to implement it by fetching an image via a URL first. Follow the example below to implement this feature, but also be sure to refer to the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-document/#methods"},"related SDK Reference section")," and ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/"},"code samples")," for more details."),(0,d.mdx)("h3",{id:"example"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\n// Wait for the SDK to be ready\nawait addOnUISdk.ready;\n\n// Reference to the active document\nconst { document } = addOnUISdk.app;\n\n// Add image via blob to the current page\nasync function addImageFromBlob(blob) {\n  try {\n    await document.addImage(blob);\n  } catch (error) {\n    console.log("Failed to add the image to the page.");\n  }\n}\n\n// Add image via url to the current page\nasync function addImageFromURL(url) {\n  try {\n    const blob = await fetch(url).then((response) => response.blob());\n    await document.addImage(blob);\n  } catch (error) {\n    console.log("Failed to add the image to the page.");\n  }\n}\n')),(0,d.mdx)(m,{slots:"text",variant:"warning",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"The supported file types for imported images are currently ",(0,d.mdx)("strong",{parentName:"p"},(0,d.mdx)("inlineCode",{parentName:"strong"},"png/jpg/mp4"),",")," and the size of the imported images should not exceed ",(0,d.mdx)("strong",{parentName:"p"},"8000px")," or ",(0,d.mdx)("strong",{parentName:"p"},"40MB"),". See the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-document/"},"SDK References")," for additional details on importing content."),(0,d.mdx)("h3",{id:"video-and-audio-content"},"Video and Audio Content"),(0,d.mdx)("p",null,"You can also import video and audio content in a similar way as described above, via the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-document/#addvideo"},(0,d.mdx)("inlineCode",{parentName:"a"},"addVideo()"))," and ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-document#addaudio"},(0,d.mdx)("inlineCode",{parentName:"a"},"addAudio()"))," methods accordingly. ",(0,d.mdx)("strong",{parentName:"p"},"Please note:")," the ",(0,d.mdx)("inlineCode",{parentName:"p"},"addAudio()")," method requires an additional ",(0,d.mdx)("inlineCode",{parentName:"p"},"MediaAttributes")," object parameter containing the ",(0,d.mdx)("inlineCode",{parentName:"p"},"title")," of the audio object you're importing. See the associated ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-document/#methods"},"SDK Reference")," for more details and example usage."),(0,d.mdx)("h2",{id:"exporting-content"},"Exporting Content"),(0,d.mdx)("p",null,"Another popular feature available for use in your add-on is the ability to export content. For instance, if you want to allow the user to save/download the current design, (or range of a design), with certain export configurations to their local hard drive. Some examples for exporting content are provided below, but also check out the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-document/#createrenditions"},(0,d.mdx)("inlineCode",{parentName:"a"},"createRenditions")," section in the SDK Reference")," for more specific options and details, as well as the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#export-sample"},"export-sample add-on"),"."),(0,d.mdx)("p",null,"The steps to export content:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},"Call ",(0,d.mdx)("inlineCode",{parentName:"li"},"createRenditions()")," to get the renditions based on your export configuration options."),(0,d.mdx)("li",{parentName:"ul"},"Convert the ",(0,d.mdx)("inlineCode",{parentName:"li"},"blob")," object returned in the response to a ",(0,d.mdx)("inlineCode",{parentName:"li"},"string")," with the ",(0,d.mdx)("inlineCode",{parentName:"li"},"URL.createObjectURL(blob)")," method."),(0,d.mdx)("li",{parentName:"ul"},"Create or update an anchor ",(0,d.mdx)("inlineCode",{parentName:"li"},"<a>")," element's ",(0,d.mdx)("inlineCode",{parentName:"li"},"href")," value with the URL string from the above step.")),(0,d.mdx)("h3",{id:"basic-example"},"Basic Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nconst response = await addOnUISdk.app.document.createRenditions({\n    range: "currentPage",\n    format: "image/jpeg",\n});\n\nconst downloadUrl = URL.createObjectURL(response[0].blob);\ndocument.getElementById("anchor").href = downloadUrl; \n\n<a href="#" download="download" id="anchor" style="text-decoration: none">\n  <sp-button id="download-button" style="display: none">Download</sp-button>\n</a>\n')),(0,d.mdx)("h3",{id:"premium-content"},"Premium Content"),(0,d.mdx)("p",null,"While the above is a very basic example, add-ons that call ",(0,d.mdx)("inlineCode",{parentName:"p"},"createRenditions")," to export content should ensure proper handling in the case of premium content. There are two options that can be considered for handling it."),(0,d.mdx)("h4",{id:"option-1-show-premium-content-error-with-upgrade-option"},'Option 1: Show premium content error with "Upgrade" option'),(0,d.mdx)("p",null,"Display an error message when export/download fails due to the user not being entitled for premium content, and include a button to allow them to upgrade. ",(0,d.mdx)("em",{parentName:"p"},"Be sure to update your ",(0,d.mdx)("inlineCode",{parentName:"em"},"manifest.json")," as outlined in the warning below the code snippet examples to allow the pricing page to properly load.")),(0,d.mdx)("h4",{id:"example-1"},"Example:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'const showPremiumContentError = async () => {\n  const { ButtonType } = addOnUISdk.constants;\n  const {buttonType} = await window.addOnUISdk.app.showModalDialog({\n    variant: "error",\n    title: "Export failed",\n    description: "Sorry, we were not able to export your design. Some assets are only included in the Premium plan. Try replacing with something else or upgrading Adobe Express to a Premium plan.", \n    buttonLabels: { secondary: "Upgrade" }\n  });\n  if (buttonType === ButtonType.cancel) return;\n  if (buttonType === ButtonType.secondary) {\n    window.open("https://www.adobe.com/go/express_addons_pricing", "_blank")\n  }\n}\n\ndocument.querySelector("#export").onclick = async () => {\n  const { app, constants } = addOnUISdk;\n  const { Range, RenditionFormat, RenditionType, RenditionIntent } = constants;\n  /* THE FOLLOWING FLAG CAN BE USED FOR TESTING PURPOSES ONLY -- REMOVE BEFORE RELEASE */\n  app.devFlags.simulateFreeUser = true; \n  const renditionOptions = {range: Range.currentPage, format: RenditionFormat.png};\n  try {\n    const renditions = await app.document.createRenditions(renditionOptions);\n    renditions.forEach(rendition => { /* do your thing w/ the renditions */ });\n  } catch (err) {\n    if (err.message?.includes("USER_NOT_ENTITLED_TO_PREMIUM_CONTENT")) {\n      showPremiumContentError();\n    }\n  }\n}\n')),(0,d.mdx)("h4",{id:"option-2---allow-preview-of-premium-content"},"OPTION 2 - Allow preview of premium content"),(0,d.mdx)("p",null,"Set a ",(0,d.mdx)("inlineCode",{parentName:"p"},"renditionPreview")," intent in the ",(0,d.mdx)("a",{parentName:"p",href:"../../references/manifest/index.md#requirements"},"manifest requirements"),", and add an extra argument to the ",(0,d.mdx)("a",{parentName:"p",href:"../../references/addonsdk/app-document.md#createrenditions"},(0,d.mdx)("inlineCode",{parentName:"a"},"createRenditions")," method")," (ie: ",(0,d.mdx)("inlineCode",{parentName:"p"},"RenditionIntent.preview"),") to generate previews that can still use premium content."),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"IMPORTANT"),": Your add-on must not allow these previewed images to be downloaded or persisted on a backend (for any longer than necessary to serve the result back to the user). To that end, be sure that users cannot:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"right-click -> save as"),": To prevent this, reject the ",(0,d.mdx)("inlineCode",{parentName:"li"},"contextmenu")," event"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"drag the image off the panel"),": To prevent this, you can reject the ",(0,d.mdx)("inlineCode",{parentName:"li"},"dragstart")," event")),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"Note:")," These behaviors are enabled by default if you use an ",(0,d.mdx)("inlineCode",{parentName:"p"},"<img>")," tag. If you apply the image using ",(0,d.mdx)("inlineCode",{parentName:"p"},"background-image")," CSS, these behaviors aren't added."),(0,d.mdx)("h4",{id:"example-2"},"Example:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'document.querySelector("#export").onclick = async () => {\n  const { app, constants } = addOnUISdk;\n  const { Range, RenditionFormat, RenditionType, RenditionIntent } = constants;  \n  /* THE FOLLOWING FLAG CAN BE USED FOR TESTING PURPOSES ONLY */\n  app.devFlags.simulateFreeUser = true; \n  const renditionOptions = {range: Range.currentPage, format: RenditionFormat.png};\n  try {\n    const renditions = await app.document.createRenditions(renditionOptions,RenditionIntent.preview);\n    renditions.forEach(rendition => { /* do your thing w/ the renditions */ });\n  } catch (err) {\n    console.log("Error " + err);\n  }\n}\n')),(0,d.mdx)(m,{slots:"text",variant:"warning",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"IMPORTANT:")," When implementing the premium content flows where you present a dialog or option to allow the user to upgrade, you must be sure to also include the following permissions in the ",(0,d.mdx)("a",{parentName:"p",href:"../../references/manifest/index.md#entrypointspermissionssandbox"},(0,d.mdx)("inlineCode",{parentName:"a"},"sandbox"))," attribute of your ",(0,d.mdx)("inlineCode",{parentName:"p"},"manifest.json")," to allow the Adobe Express pricing page to properly load: ",(0,d.mdx)("inlineCode",{parentName:"p"},'"permissions": { "sandbox": ["allow-popups-to-escape-sandbox", "allow-popups", "allow-downloads"]\n}')),(0,d.mdx)("h2",{id:"authorization-with-oauth-20"},"Authorization with OAuth 2.0"),(0,d.mdx)("p",null,"This use case focuses on providing an authorization feature that allows a user to login to one of their existing services with OAuth 2.0. A typical use case would be to use assets you have stored in another service. Here you will find instructions of how to set it up, and an example of how to implement it. But also check out the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-oauth/"},"SDK Reference OAuth section")," for more options and details, as well as the  ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#import-images-using-oauth"},"import-images-using-oauth")," sample add-ons for more advanced usage."),(0,d.mdx)("h3",{id:"setup"},"Setup"),(0,d.mdx)("p",null,'The OAuth APIs can be used to obtain the authorization "code" from any OAuth 2.0 provider supporting the Code Exchange authorization workflow. You will need to go through some setup steps with the provider you want to use OAuth with first. Here are the steps to get started:'),(0,d.mdx)("ol",null,(0,d.mdx)("li",{parentName:"ol"},"Log in to the OAuth provider's website and create an application (for example, Dropbox). This must be a web application, and if an option of SPA (Single Page Application) is listed, select it."),(0,d.mdx)("li",{parentName:"ol"},'As an input to the "Redirect URIs" field, add: ',(0,d.mdx)("a",{parentName:"li",href:"https://new.express.adobe.com/static/oauth-redirect.html"},"https://new.express.adobe.com/static/oauth-redirect.html"),"."),(0,d.mdx)("li",{parentName:"ol"},"Fill out other details as necessary and save the form. A client Id / application Id / application key (this differs on different OAuth providers) will be generated. Make note of it as you will need it in your add-on code."),(0,d.mdx)("li",{parentName:"ol"},"Next, update your add-on ",(0,d.mdx)("inlineCode",{parentName:"li"},"manifest.json")," file with the hostname of the OAuth provider's authorization URL. ",(0,d.mdx)("strong",{parentName:"li"},"NOTE:")," When using multiple providers, all hostnames must be provided. For example, if the add-on uses two OAuth providers (",(0,d.mdx)("inlineCode",{parentName:"li"},'"login.microsoftonline.com"')," and ",(0,d.mdx)("inlineCode",{parentName:"li"},'"www.dropbox.com"'),"), the ",(0,d.mdx)("inlineCode",{parentName:"li"},"manifest.json")," should contain both of them, as shown below:")),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "<ADD_ON_ID>",\n    "name": "<ADD_ON_NAME>",\n    "version": "1.0.0",\n    "manifestVersion": 1,\n    "requirements": {\n        "apps": ["Express"]\n    },\n    "entryPoints": [\n        {\n            "type": "panel",\n            "id": "panel1",\n            "label": {\n                "default": "<ADD_ON_LABEL>"\n            },\n            "main": "index.html",\n            "permissions": {\n                "oauth": ["login.microsoftonline.com", "www.dropbox.com"]\n            }\n        }\n    ]\n}\n')),(0,d.mdx)("h3",{id:"example-3"},"Example"),(0,d.mdx)("p",null,"Once you complete the set up, you can use the following code snippet as an example of how to perform the OAuth exchange to retrieve an access token. The ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/"},"code samples")," also contain a few different examples of using OAuth 2.0 workflows that you can use for a reference. You will also find the ",(0,d.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/express-add-on-samples/blob/main/samples/import-images-using-oauth/src/utils/OAuthUtils.js"},"OAuthUtils.js")," module there, which is referenced below, and we recommend using to help with your own OAuth implementation. Also be sure to check out the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-oauth"},"SDK References")," for additional details on the OAuth workflows."),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \nconst DROPBOX_AUTHORIZATION_URL = "https://www.dropbox.com/oauth2/authorize";\nconst DROPBOX_TOKEN_URL = "https://api.dropboxapi.com/oauth2/token";\nconst DROPBOX_CLIENT_ID = "<DROPBOX_CLIENT_ID>";\nconst DROPBOX_SCOPE = "<DROPBOX_SPACE_SEPARATED_SCOPES>";\n \nconst ONEDRIVE_AUTHORIZATION_URL = "https://login.microsoftonline.com/<AZURE_AD_TENANT_ID>/oauth2/v2.0/authorize";\nconst ONEDRIVE_TOKEN_URL = "https://login.microsoftonline.com/<AZURE_AD_TENANT_ID>/oauth2/v2.0/token";\nconst ONEDRIVE_CLIENT_ID = "<ONEDRIVE_CLIENT_ID>";\nconst ONEDRIVE_SCOPE = "<ONEDRIVE_SPACE_SEPARATED_SCOPES>";\nconst OWN_REDIRECT_URI = "<OWN_REDIRECT_URI>";\n \naddOnUISdk.ready.then(() => {\n    // \'oauthUtils\' is a helper javascript module (included with the OAuth template) which provides utility functions to:\n    // 1. generateChallenge()     Generate the \'code_challenge\' and \'code_verifier\' parameters that are essential in the OAuth 2.0 workflow.\n    // 2. generateAccessToken()   Generate an \'access_token\' and a \'refresh_token\' using the \'code\' and \'redirectUri\' received on successful authorization.\n    // 3. getAccessToken()        Get an always valid \'access_token\'.\n     \n    const challenge = await oauthUtils.generateChallenge();     \n    await authorize(challenge);         \n});\n \nfunction authorize(challenge) {\n    // Trigger the OAuth 2.0 based authorization which opens up a sign-in window for the user\n    // and returns an authorization code which can be used to obtain an access_token.\n    const { id, code, redirectUri, result } = await oauth.authorize({\n        authorizationUrl: DROPBOX_AUTHORIZATION_URL,\n        clientId: DROPBOX_CLIENT_ID,\n        scope: DROPBOX_SCOPE,\n        codeChallenge: challenge.codeChallenge\n    });\n \n    const { status, description } = result;\n    if (status !== "SUCCESS") {\n        throw new Error(`Status: ${status} | Description: ${description}`);\n    }\n \n    // Generate the access_token which can be used to verify the identity of the user and\n    // grant them access to the requested resource.\n    await oauthUtils.generateAccessToken({\n        id,\n        clientId: DROPBOX_CLIENT_ID,\n        codeVerifier: challenge.codeVerifier,\n        code,\n        tokenUrl: DROPBOX_TOKEN_URL,\n        redirectUri\n    });\n \n    const accessToken = await oauthUtils.getAccessToken(id);\n}\n')),(0,d.mdx)("h2",{id:"storing-and-retrieving-client-side-data"},"Storing and Retrieving Client-Side Data"),(0,d.mdx)("p",null,"If you want to be able to store and retrieve data on the client side rather to and from a server for certain instances (ie: caching images that were fetched to decrease load times etc), you can do so using the add-on ",(0,d.mdx)("inlineCode",{parentName:"p"},"clientStorage")," API. An example of using it is shown below, but also refer to the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/instance-clientStorage/"},"SDK Reference section for clientStorage")," and the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#use-client-storage"},"use-client-storage sample add-on")," for more details."),(0,d.mdx)("h3",{id:"example-4"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nlet store;\n\naddOnUISdk.ready.then(async () => {\n    store = addOnUISdk.instance.clientStorage;\n}\n/**\n * Store item \n */\nasync function setItem(item: string, isComplete: boolean) {\n    await store.setItem(item, isComplete);\n    todoItemInput.value = "";\n}\n/**\n * Log all storage item values\n */\nasync function displayAllItems() {\n    const todoItems = await store.keys();\n    todoItems.forEach(async (item: string) => {\n        const itemValue = await store.getItem(item);\n        console.log("Key: " + item + " value: " + itemValue);\n    });\n}\n\n')),(0,d.mdx)("h2",{id:"drag-and-drop"},"Drag and Drop"),(0,d.mdx)("p",null,"If you want to allow a user to drag and drop items from your add-on to the document, you can use the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/addonsdk-app/#enabledragtodocument"},"methods provided in the add-on SDK"),". There are also several ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples"},"code samples")," that implement drag and drop, including the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#import-images-using-oauth"},"import-images-using-oauth")," and ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#pix"},"pix")," samples you can reference. Some example use cases are shown below. ",(0,d.mdx)("strong",{parentName:"p"},"Note:")," for dragging audio content, you will need to specify an additional ",(0,d.mdx)("inlineCode",{parentName:"p"},"attributes")," object that includes a ",(0,d.mdx)("inlineCode",{parentName:"p"},"title")," property. A note on how to include it specifically is below in the ",(0,d.mdx)("a",{parentName:"p",href:"#example-using-an-image-url"},"second example below"),"."),(0,d.mdx)("h3",{id:"example-using-local-images"},"Example using local images"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nconst IMAGES = new Map([\n    ["image1.jpg", "./images/image1.jpg"],    \n    ["image2.jpg", "./images/image2.jpg"],\n    ["image3.jpg", "./images/image3.jpg"]\n]);\n\nlet gallery;\n\n// Wait for the SDK to be ready before rendering elements in the DOM.\naddOnUISdk.ready.then(async () => {\n    // Create elements in the DOM.\n    gallery = document.createElement("div");\n    gallery.className = "gallery";\n\n    IMAGES.forEach((url, id) => {\n        const image = document.createElement("img");\n        image.id = id;\n        image.src = url;\n        image.addEventListener("click", addToDocument);\n\n        // Enable drag to document for the image.\n        addOnUISdk.app.enableDragToDocument(image, {\n            previewCallback: element => {\n                return new URL(element.src);\n            },\n            completionCallback: async (element) => {\n                return [{ blob: await getBlob(element.src) }];\n            }\n        });\n\n        gallery.appendChild(image);\n    });\n\n    // Register event handler for "dragstart" event\n    addOnUISdk.app.on("dragstart", startDrag);\n     // Register event handler for \'dragend\' event\n    addOnUISdk.app.on("dragend", endDrag);\n\n    document.body.appendChild(gallery);\n});\n\n/**\n * Add image to the document.\n */\nasync function addToDocument(event) {\n    const url = event.currentTarget.src;\n    const blob = await getBlob(url);\n    addOnUISdk.app.document.addImage(blob);\n}\n\n/**\n * Handle "dragstart" event\n */\nfunction startDrag(eventData) {\n    console.log("The drag event has started for", eventData.element.id);\n}\n\n/**\n * Handle "dragend" event\n */\nfunction endDrag(eventData) {\n    if (!eventData.dropCancelled) {\n        console.log("The drag event has ended for", eventData.element.id);\n    } else {\n        console.log("The drag event was cancelled for", eventData.element.id);\n    }\n}\n\n/**\n * Get the binary object for the image.\n */\nasync function getBlob(url) {\n    return await fetch(url).then(response => response.blob());\n}\n\n')),(0,d.mdx)("h3",{id:"example-using-an-image-url"},"Example using an image URL"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\n// Enable drag support for an element\nfunction makeDraggableUsingUrl(elementId: string, previewUrl: string) {\n  const image = document.getElementById(elementId);\n\n  const dragCallbacks = {\n    previewCallback: (image: HTMLElement) => {\n      return new URL(previewUrl);\n    },\n    completionCallback: async (image: HTMLElement) => {\n      const imageBlob = await fetch(image.src).then((response) =>\n        response.blob()\n      );\n      return [{ blob: imageBlob }];\n      // Note: for audio content, an attributes object with the title is mandatory. \n      // For instance, replace the above return with the following:\n      // return [{blob: audioBlob, attributes: { title: "Jazzy beats" }}];\n    },\n  };\n\n  try {\n    addOnUISdk.app.enableDragToDocument(image, dragCallbacks);\n  } catch (error) {\n    console.log("Failed to enable DragToDocument:", error);\n  }\n}\n\naddOnUISdk.app.on("dragstart", (eventData: DragStartEventData) => {\n  console.log("The drag event has started for", eventData.element);\n});\n\naddOnUISdk.app.on("dragend", (eventData: DragEndEventData) => {\n  if (!eventData.dropCancelled) {\n    console.log("The drag event has ended for", eventData.element);\n    disableDragToDocument();\n  } else {\n    console.log("The drag event was cancelled for", eventData.element);\n    console.log("Cancel Reason: ", eventData.dropCancelReason);\n  }\n});\n')),(0,d.mdx)("p",null,(0,d.mdx)("strong",{parentName:"p"},"Important Notes:")),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},"Since the Add-on SDK uses pointer event handlers to perform drag operations, you should ensure that you don't attach any pointer event handlers that prevent default or stop propagation. Adding those types of handlers will kill the built-in handlers and cause the events not to work."),(0,d.mdx)("li",{parentName:"ul"},"You should not attach ",(0,d.mdx)("inlineCode",{parentName:"li"},"click")," event listeners to drag-enabled elements in the capture phase, as the Add-on SDK attaches a ",(0,d.mdx)("inlineCode",{parentName:"li"},"cancelClickEvent")," handler to drag-enabled elements to ensure that the automatic click (pointer down + pointer up automatically fires a click event) doesn't fire. Adding other handlers to this same element will cause them to be triggered on drag & drop completion."),(0,d.mdx)("li",{parentName:"ul"},"TIP: Use Chrome devTools to check the handlers attached to the element and its ancestors to identify any which may be causing conflicts with drag and drop handlers.")),(0,d.mdx)("h2",{id:"modal-dialogs"},"Modal Dialogs"),(0,d.mdx)("p",null,"When you need to pop up a dialog to show a certain message such as an informational, warning or error message, you can use a modal dialog to do so. Below are some examples of the different types of modal dialogs supported. Also check out the SDK references for details on how to ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/addonsdk-app/#showmodaldialog"},"show")," or ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/runtime-dialog/#close"},"programmatically close a dialog"),", as well as the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#dialog-add-on"},"dialog add-on sample")," for more details."),(0,d.mdx)("h3",{id:"simple-modal-dialog-example"},"Simple Modal Dialog Example"),(0,d.mdx)("p",null,"The following example shows how to display a simple confirmation dialog."),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \n// Wait for the SDK to be ready\nawait addOnUISdk.ready;\n\nasync function showConfirmDialog() {\n    try {\n        // Confirmation Dialog Example\n        let dialogOptions = {\n            variant: "confirmation",\n            title: "Enable smart Filters",\n            description: "Smart filters are nondestructive and will preserve your original images.",\n            buttonLabels: { primary: "Enable", cancel: "Cancel" },\n        };    \n        const result = await addOnUISdk.app.showModalDialog(dialogOptions);\n        console.log("Button type clicked " + result.buttonType); \n    } catch (error) {\n        console.log("Error showing modal dialog:", error);\n    }\n}\n')),(0,d.mdx)("h3",{id:"input-modal-dialog-example"},"Input Modal Dialog Example"),(0,d.mdx)("p",null,"Below is an example of using an ",(0,d.mdx)("inlineCode",{parentName:"p"},"input")," dialog that accepts input you can retrieve:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \n// Wait for the SDK to be ready\nawait addOnUISdk.ready;\n\nasync function showInputDialog() {\n    try {\n        // Input Dialog Example\n        let inputDialogOptions = {\n            variant: "input",\n            title: "Please enter your key",\n            description: "Your API key",\n            buttonLabels: { cancel: "Cancel" },           \n            field: {\n                label: "API Key",\n                placeholder: "Enter API key", \n                fieldType: "text",\n            },\n        }\n\n        const inputDialogResult = await addOnUISdk.app.showModalDialog(inputDialogOptions);\n        if (inputDialogResult.buttonType === "primary") {\n            console.log("Field value " + inputDialogResult.fieldValue); // returns the input the user entered if they didn\'t cancel\n        }\n    } catch (error) {\n        console.log("Error showing modal dialog:", error);\n    }\n}\n')),(0,d.mdx)("h3",{id:"custom-dialog-example"},"Custom Dialog Example"),(0,d.mdx)("p",null,"This example shows how you can define custom content for yuour dialog in a separate source file, (",(0,d.mdx)("inlineCode",{parentName:"p"},"dialog.html")," in this case), and with a custom height and title."),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \n// Wait for the SDK to be ready\nawait addOnUISdk.ready;\n \nfunction useCustomDialogResult(data: unknown) {\n  // Use the dialog data\n}\n\n// Custom Dialog\nasync function showCustomDialog() {\n  try {\n    const dialogResult = await addOnUISdk.app.showModalDialog({\n        variant: "custom",\n        title: "Custom Modal",\n        src: "dialog.html", // use content from this html file\n        size: { width: 600, height: 400 }\n    });\n \n    // Use data received from the custom dialog\n    useCustomDialogResult(dialogResult.result);\n \n  } catch (error) {\n    console.log("Error showing modal dialog:", error);\n  }\n}\n')),(0,d.mdx)(m,{slots:"text",variant:"success",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"Check out the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/"},"add-on SDK")," for more specific details on using modal dialogs, including ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/runtime-dialog/#close"},"programmatically closing a dialog with an optional custom result"),"."),(0,d.mdx)("h2",{id:"detecting-theme"},"Detecting Theme"),(0,d.mdx)("p",null,"When you want to detect the theme of the environment where your add-on is running, or if you want to be notified if it changes, you can use the following example. This is useful for knowing what theme is currently set in Adobe Express, so you can use the same in your add-on UI, or to apply a change to your UI when the user changes their Adobe Express theme. ",(0,d.mdx)("strong",{parentName:"p"},"Note:"),' currently Adobe Express only supports a "light" theme, though this will be changing to include support for a "dark" theme in the future. See the snippet below for an example of how to use and detect the theme, as well as the ',(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-ui/#theme"},"related SDK Reference section"),"."),(0,d.mdx)("h3",{id:"example-5"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nfunction applyTheme(theme) {\n    document.querySelector("sp-theme").setAttribute("color", theme);\n}\napplyTheme(addOnUISdk.app.ui.theme);\naddOnUISdk.app.on("themechange", (data) => { applyTheme(data.theme); });\n\naddOnUISdk.app.on("themechange", (data) => {\n    applyTheme(data.theme == "dark" ? darkTheme : lightTheme);\n});\n')),(0,d.mdx)("h2",{id:"detecting-locale-and-supported-locales"},"Detecting Locale and Supported Locales"),(0,d.mdx)("p",null,"If you want to find out the users current locale, the list of supported locales, or detect when the locale changes (ie: to set the language in your add-on), you can do so with the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-ui/#locale"},(0,d.mdx)("inlineCode",{parentName:"a"},"addOnUISdk.app.ui")," object")," in the add-on SDK. A simple example is shown below."),(0,d.mdx)("h3",{id:"example-6"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nfunction setLanguage(language) { \n  /* Set the language in your UI strings based on the change detected */ \n}\n\naddOnUISdk.ready.then(() => {\n  console.log(addOnUISdk.app.ui.locales);\n  setLanguage(addOnUISdk.app.ui.locale);\n});\n\naddOnUISdk.app.on("localechange", data => {\n  setLanguage(data.locale));\n});\n')),(0,d.mdx)("h2",{id:"current-user-for-monetization-flows"},"Current User (for monetization flows)"),(0,d.mdx)("p",null,"You can leverage the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-currentUser"},(0,d.mdx)("inlineCode",{parentName:"a"},"currentUser"))," API to obtain the information for the currently logged in user, for instance if you want to use their ",(0,d.mdx)("inlineCode",{parentName:"p"},"userId")," to validate in a monetization flow."),(0,d.mdx)("p",null,"Use the example below to try this feature, but also be sure to refer to the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/references/addonsdk/app-currentUser"},"related SDK Reference section"),". Also, refer to the ",(0,d.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/express/add-ons/docs/samples/#licensed-addon"},"licensed-addon code sample"),", which shows an example of how you can utilize the hash of the user ID to integrate your add-on with licensing and payment services."),(0,d.mdx)(p,{slots:"heading, code",repeat:"2",languages:"JavaScript",mdxType:"CodeBlock"}),(0,d.mdx)("h3",{id:"example-7"},"Example"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n \naddOnUISdk.ready.then(async () => {\n  validateUser(await addOnUISdk.app.currentUser.userId());\n});\n\nvalidateUser(userId: string) {\n  ...\n}\n')),(0,d.mdx)("h3",{id:"output"},"Output"),(0,d.mdx)("p",null,(0,d.mdx)("inlineCode",{parentName:"p"},"Current Userid: 3cda976828a4a90d13b0f38b1f8a59b1d6845cccfc48037fb30bb75d3ef67d36")),(0,d.mdx)("h2",{id:"authoring-content"},"Authoring Content"),(0,d.mdx)("p",null,"We provide a set of ",(0,d.mdx)("a",{parentName:"p",href:"../../references/document-sandbox/document-apis/"},"Document APIs")," that can be used for interacting with the document for common use cases like creating shapes, adding pages, clearing the artboard and more."),(0,d.mdx)(m,{slots:"text",variant:"warning",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"The Editor API's are currently ",(0,d.mdx)("strong",{parentName:"p"},"experimental only"),". Please do not use them in any add-ons you plan to distribute or submit with updates until they have been deemed stable."),(0,d.mdx)("p",null,"The following code snippet illustrates how to use the ",(0,d.mdx)("a",{parentName:"p",href:"../../references/document-sandbox/document-apis/"},"Document APIs")," from the script running in your ",(0,d.mdx)("a",{parentName:"p",href:"../../references/document-sandbox/index.md#getting-started-with-the-apis"},(0,d.mdx)("inlineCode",{parentName:"a"},"code.js"))," for instance, to access the current document, create a rectangle, set some properties and a fill for the rectangle, and finally, add it to the document:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import { editor, utils } from "express";\n\nconst insertionParent = editor.context.insertionParent; // get node to insert content into\n\nconst rectangle = editor.createRectangle();\nrectangle.width = 200;\nrectangle.height = 150;\nrectangle.translateX = 100;\nrectangle.translateY = 20;\nconsole.log(rectangle); // for debugging purpose\n\nconst [red, green, blue, alpha] = [0.8, 0.6, 0.2, 0.7];\nconst rectangleFill = editor.createColorFill(utils.createColor(red, green, blue, alpha));\nrectangle.fills.append(rectangleFill);\n\ninsertionParent.children.append(rectangle);\n')),(0,d.mdx)(m,{slots:"text",variant:"info",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"Refer to ",(0,d.mdx)("a",{parentName:"p",href:"../../references/document-sandbox/index.md#getting-started-with-the-apis"},"getting started with the Document Sandbox")," for more details on how to set up your add-on to use the script-based APIs, which include the Document APIs for authoring content."),(0,d.mdx)("h2",{id:"document-metadata"},"Document Metadata"),(0,d.mdx)("p",null,"You can retrieve some information about the current document using the ",(0,d.mdx)("a",{parentName:"p",href:"../../references/addonsdk/app-document.md"},"Add-on UI SDK Document object"),". Currently there are methods that allow you to retrieve the ID of the document and the title (ie: name). There are also associated events that allow you to listen for when the document is available (via the ",(0,d.mdx)("inlineCode",{parentName:"p"},"documentAvailable")," event) and when the title has changed (via the ",(0,d.mdx)("inlineCode",{parentName:"p"},"documentTitleChange")," event). The examples below illustrates the use of these new methods and events for reference."),(0,d.mdx)("h3",{id:"retrieving-the-document-id"},"Retrieving the document id"),(0,d.mdx)("p",null,"The example below listens for the ",(0,d.mdx)("inlineCode",{parentName:"p"},"documentAvailable")," event and then sets the id."),(0,d.mdx)("h4",{id:"example-8"},"Example"),(0,d.mdx)(p,{slots:"heading, code",repeat:"1",languages:"JavaScript",mdxType:"CodeBlock"}),(0,d.mdx)("h4",{id:"usage"},"Usage"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nfunction setId(id) { /* ... */ } \n  \naddOnUISdk.ready.then(() => setId(await addOnUISdk.app.document.id()));\n  \naddOnUISdk.app.on("documentAvailable", data => {\n  setId(data.documentId);\n});\n')),(0,d.mdx)("h3",{id:"retrieving-the-document-title"},"Retrieving the document title"),(0,d.mdx)("p",null,"The example below listens for the ",(0,d.mdx)("inlineCode",{parentName:"p"},"documentTitleChange")," event and then sets the id."),(0,d.mdx)("h4",{id:"example-9"},"Example"),(0,d.mdx)(p,{slots:"heading, code",repeat:"1",languages:"JavaScript",mdxType:"CodeBlock"}),(0,d.mdx)("h4",{id:"usage-1"},"Usage"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-js"},'import addOnUISdk from "https://new.express.adobe.com/static/add-on-sdk/sdk.js";\n\nfunction setTitle(title) { /* ... */ } \n  \naddOnUISdk.ready.then(() => setTitle(await addOnUISdk.app.document.title()));\n  \naddOnUISdk.app.on("documentTitleChange", data => {\n  setTitle(data.documentTitle);\n});\n')))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-develop-use-cases-md-b040d20e6accc31d1a6c.js.map